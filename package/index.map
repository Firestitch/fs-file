{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 9fd4e3417ff1b1fd2626","webpack:///../node_modules/@firestitch/common/common.umd.js","webpack:///./components/fs-file-picker/fs-file-picker.component.scss","webpack:///./components/fs-file-preview/fs-file-preview.component.scss","webpack:///./components/fs-file-previews/fs-file-previews.component.scss","webpack:///../node_modules/css-loader/lib/css-base.js","webpack:///../node_modules/fileapi/dist/FileAPI.js","webpack:///./components/fs-file-drag-base/fs-file-drag-base.ts","webpack:///./components/fs-file-drag-base/index.ts","webpack:///./components/fs-file-picker/fs-file-picker.component.html","webpack:///./components/fs-file-picker/fs-file-picker.component.scss?db05","webpack:///./components/fs-file-picker/fs-file-picker.component.ts","webpack:///./components/fs-file-picker/index.ts","webpack:///./components/fs-file-preview-base/fs-file-preview-base.ts","webpack:///./components/fs-file-preview-base/index.ts","webpack:///./components/fs-file-preview/fs-file-preview.component.html","webpack:///./components/fs-file-preview/fs-file-preview.component.scss?8b43","webpack:///./components/fs-file-preview/fs-file-preview.component.ts","webpack:///./components/fs-file-preview/index.ts","webpack:///./components/fs-file-previews/fs-file-previews.component.html","webpack:///./components/fs-file-previews/fs-file-previews.component.scss?70bd","webpack:///./components/fs-file-previews/fs-file-previews.component.ts","webpack:///./components/fs-file-previews/index.ts","webpack:///./components/fs-file/fs-file.component.html","webpack:///./components/fs-file/fs-file.component.ts","webpack:///./components/fs-file/index.ts","webpack:///./components/index.ts","webpack:///./directives/fs-file-preview-action.directive.ts","webpack:///./directives/index.ts","webpack:///./fs-component.module.ts","webpack:///./index.ts","webpack:///./models/fs-file.ts","webpack:///./services/fs-file.service.ts","webpack:///./services/index.ts","webpack:///external \"@angular/common\"","webpack:///external \"@angular/core\"","webpack:///external \"@angular/material\""],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;AACA;AACA;AACA,6BAA6B;AAC7B,CAAC,wCAAwC;;AAEzC;AACA;AACA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA,2BAA2B,EAAE,oEAAoE,mBAAmB;AACpH,2BAA2B,EAAE,uEAAuE,oBAAoB;AACxH;AACA,2BAA2B,+CAA+C;AAC1E,aAAa;AACb;AACA;AACA;AACA,2BAA2B,2BAA2B;AACtD,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA,2BAA2B,EAAE;AAC7B;AACA;AACA;AACA;AACA,4BAA4B,EAAE,sBAAsB,EAAE,uBAAuB,SAAS;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB,4BAA4B,EAAE;AAC9B;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA,2BAA2B,EAAE;AAC7B;AACA;AACA;AACA;AACA,uBAAuB,EAAE;AACzB,uBAAuB,EAAE;AACzB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,iCAAiC,iBAAiB;AAClD;AACA,2BAA2B,EAAE;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,+BAA+B,cAAc;AAC7C,uBAAuB,EAAE,qBAAqB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,qCAAqC,oBAAoB;AACzD,wCAAwC,0BAA0B;AAClE,uBAAuB,EAAE;AACzB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,4BAA4B,EAAE,sBAAsB,EAAE,wBAAwB,SAAS;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA,2BAA2B,EAAE;AAC7B;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS,wBAAwB;AACjC;AACA;AACA,0CAA0C,WAAW;AACrD;AACA,CAAC;;AAED;AACA;AACA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA,uBAAuB,EAAE;AACzB,uBAAuB,EAAE;AACzB,uBAAuB,EAAE;AACzB;AACA;AACA;AACA,SAAS,wBAAwB;AACjC;AACA;AACA,yCAAyC,WAAW;AACpD;AACA,CAAC;;AAED;AACA;AACA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA;AACA;AACA,2BAA2B,EAAE,2CAA2C,EAAE;AAC1E;AACA,SAAS;AACT;AACA;AACA,gBAAgB;AAChB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,kCAAkC,eAAe;AACjD,uBAAuB,EAAE;AACzB;AACA;AACA,0DAA0D,gCAAgC,EAAE;AAC5F;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,GAAG;AAClB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE,oBAAoB;AAC7C;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,+BAA+B;AAC/B;AACA;AACA,oCAAoC;AACpC,iBAAiB;AACjB;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE;AACzB;AACA,2BAA2B,EAAE,+BAA+B,EAAE;AAC9D,2BAA2B,EAAE;AAC7B;AACA;AACA;AACA;AACA,2BAA2B,EAAE;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,SAAS,wBAAwB;AACjC;AACA;AACA,yCAAyC,WAAW;AACpD;AACA,CAAC;;AAED;AACA;AACA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,uBAAuB,EAAE,6BAA6B,EAAE,kBAAkB,EAAE,cAAc,IAAI;AAC9F;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,oEAAoE,yBAAyB,6BAA6B,IAAI,QAAQ,IAAI,QAAQ,IAAI,QAAQ,IAAI,gCAAgC,GAAG;AACrM;AACA;AACA,SAAS,wBAAwB;AACjC;AACA;AACA,6CAA6C;AAC7C,SAAS,gBAAgB;AACzB,MAAM;AACN;AACA,CAAC;;AAED;AACA;AACA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA,eAAe,EAAE;AACjB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,sDAAsD;AACtD,SAAS,gBAAgB;AACzB,MAAM;AACN;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,iBAAiB,IAAI;AACrB;AACA;AACA,iDAAiD;AACjD,SAAS,gBAAgB;AACzB,MAAM;AACN;AACA,CAAC;;AAED;AACA;AACA,cAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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Cb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA;AACA,yEAAyE;AACzE;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAsB;;AAEtB;AACA,kCAAkC;AAClC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB;AAChB;AACA;;;AAGA;;AAEA;AACA;AACA,4BAA4B,8BAA8B;AAC1D;AACA,GAAG;;AAEH,gBAAgB;AAChB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,2DAA2D,gBAAgB;AAC3E,SAAS,iBAAiB;AAC1B;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA,gCAAgC,sCAAsC;AACtE,gCAAgC,+BAA+B;AAC/D,YAAY,oBAAoB;AAChC;AACA,KAAK;AACL;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC,yCAAyC;AACzE,gCAAgC,+BAA+B;AAC/D,YAAY,sBAAsB;AAClC;AACA,KAAK;AACL;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH;AACA,qBAAqB,kEAAkE;AACvF,mCAAmC,oCAAoC;AACvE;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,8BAA8B;;AAE9B;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,gBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA,IAAI;;AAEJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,IAAI;;;AAGJ,mBAAmB;;;AAGnB;AACA;AACA;AACA;AACA;AACA;AACA,yEAAyE;AACzE;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,aAAa;AAC3B,cAAc,SAAS;AACvB,cAAc,EAAE;AAChB;AACA;;;AAGA;AACA;AACA,cAAc,MAAM;AACpB,cAAc,SAAS;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,OAAO;AACrB,eAAe;AACf;AACA;;;AAGA;AACA;AACA,eAAe,KAAK;AACpB,eAAe;AACf;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA,gBAAgB,KAAK;AACrB,gBAAgB;AAChB;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,YAAY;AAC1B,eAAe;AACf;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,IAAI;;;;AAIJ;AACA;AACA;AACA,cAAc,aAAa;AAC3B,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,KAAK;AACnB,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,KAAK;AACnB,cAAc,SAAS;AACvB;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,KAAK;AACnB,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB,gBAAgB,OAAO;AACvB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B,gBAAgB;AAChB;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,YAAY;AAC1B,cAAc,SAAS;AACvB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,uCAAuC;AAC3E;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,sBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,OAAO;AACrB,eAAe;AACf;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,MAAM;AACpB,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,sBAAsB,EAAE;AAC7D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,uBAAuB;AACrC,cAAc,gBAAgB;AAC9B,cAAc,SAAS;AACvB,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA6C,0CAA0C,EAAE;AACzF,IAAI;;;AAGJ;AACA;AACA,cAAc,MAAM;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,KAAK;AACnB,cAAc,SAAS;AACvB;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB;AACA;AACA,8BAA8B,wBAAwB;AACtD;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,MAAM;AACpB,cAAc,SAAS;AACvB,eAAe;AACf;AACA;AACA;;AAEA,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,cAAc,MAAM;AACpB,cAAc,SAAS;AACvB,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA,+BAA+B;AAC/B;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,uCAAuC;;AAEvC;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;;AAET;AACA;AACA;AACA,UAAU;;AAEV;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,gCAAgC;AAChC;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iCAAiC,uBAAuB;AACxD;AACA,QAAQ,GAAG;;;AAGX;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;;AAEN;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;;;AAGJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA,iBAAiB,QAAQ,oBAAoB,EAAE;AAC/C;;AAEA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,UAAU,EAAE;AACjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,sBAAsB;AACtB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;;AAEA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,IAAI;;;AAGJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;;AAEA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,gBAAgB,SAAS;AACzB,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;AACA,WAAW,uDAAuD;AAClE;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,YAAY,6BAA6B;AACzC;AACA;AACA,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;AACA,KAAK;AACL,SAAS,gBAAgB;AACzB;;AAEA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8CAA8C,uCAAuC;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,wBAAwB;AAC7D;AACA;AACA;AACA,oCAAoC,2CAA2C;AAC/E;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,wBAAwB,2BAA2B;AACnD,mCAAmC,iCAAiC;AACpE;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,IAAI;AACJ;;AAEA;AACA,EAAE;;;AAGF;AACA;AACA;AACA,YAAY,YAAY;AACxB,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,wBAAwB;;AAExB;AACA;AACA;;AAEA;AACA;;AAEA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;;;AAGJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,YAAY,YAAY;AACxB,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,EAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB,qDAAqD;AAC1E,0BAA0B,gEAAgE;AAC1F,2BAA2B,kEAAkE;AAC7F,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,yCAAyC,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kCAAkC;AACtD,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,sCAAsC;AAC1D,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA,oBAAoB,WAAW;AAC/B,GAAG;;AAEH;AACA,oBAAoB,iBAAiB;AACrC,GAAG;;AAEH;AACA,oBAAoB,kBAAkB;AACtC,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,2BAA2B,mBAAmB,EAAE;AACpF;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;;AAGH;AACA;AACA;;AAEA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oBAAoB,wEAAwE;;AAE5F;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;;AAGF;AACA;AACA;AACA,eAAe,uBAAuB;AACtC,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,aAAa,aAAa;AAC1B,aAAa,gBAAgB;AAC7B,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,IAAI;AACJ;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;AACA,SAAS,OAAO;AAChB;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,gHAAgH,kBAAkB,EAAE;;AAEpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA,GAAG;;;AAGH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA,gEAAgE,yCAAyC;AACzG;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,cAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,yBAAyB;AACzB;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAU,mCAAmC,EAAE;AAC/C,UAAU,0BAA0B,EAAE;AACtC;AACA,KAAK;AACL;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,kBAAkB;AAC7C,8CAA8C,gCAAgC;AAC9E,YAAY,sDAAsD;AAClE;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA,uIAAuI,cAAc,kBAAkB,YAAY,aAAa;AAChM,yDAAyD,gEAAgE;AACzH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,yBAAyB;AACzB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV,SAAS;AACT;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA,8DAA8D;AAC9D;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAU;AACV,SAAS;AACT;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,gEAAgE;AAChE;;AAEA;AACA;AACA;AACA;AACA;AACA,iEAAiE,+BAA+B,EAAE;AAClG;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6BAA6B,cAAc;AAC3C;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,MAAM;AACN;;AAEA;AACA,IAAI;AACJ;AACA;AACA,GAAG;;;AAGH;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YAAY,YAAY;AACxB,aAAa;AACb;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YAAY,YAAY;AACxB,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,IAAI;AACJ;;AAEA,EAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YAAY,EAAE;AACd,aAAa;AACb;AACA;AACA;AACA;;;AAGA;AACA;AACA,YAAY,iBAAiB;AAC7B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW;;;AAGX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA,eAAe,YAAY;AAC3B,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;;;AAGL;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,2BAA2B,uCAAuC;AAClE;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,6BAA6B,uBAAuB,EAAE;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,KAAK;;;AAGL;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;;AAEN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,8BAA8B,iCAAiC,EAAE;AACjE;AACA;AACA,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA,kDAAkD,+BAA+B,EAAE;AACnF;;AAEA;AACA,OAAO;;;AAGP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,UAAU;AACV;;AAEA;AACA;AACA;AACA,MAAM;;;AAGN;AACA;AACA;AACA;AACA,iBAAiB,oCAAoC,EAAE;AACvD;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;;AAEA,8CAA8C;AAC9C;AACA,UAAU;AACV,SAAS;AACT;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;;;AAGN;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;;AAEA,aAAa,KAAK;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;;;AAGN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB;AACnB,2BAA2B,8BAA8B,aAAa,EAAE,EAAE;AAC1E,2CAA2C,2BAA2B,EAAE;AACxE,2CAA2C,qBAAqB;AAChE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,SAAS;AACT,QAAQ;;;AAGR;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA,MAAM;AACN;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,mBAAmB,EAAE;AAChF;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,qBAAqB,EAAE;AACjC;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA,+BAA+B;AAC/B;AACA;AACA,GAAG;AACH,EAAE;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,yBAAyB;AACzB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;;AAGA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B,yBAAyB;;AAEzB;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;;AAEA,2EAA2E;AAC3E;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA,aAAa;;AAEb;AACA;AA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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@angular/core\"), require(\"@angular/common\"), require(\"@angular/material\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@firestitch/file\", [\"@angular/core\", \"@angular/common\", \"@angular/material\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@firestitch/file\"] = factory(require(\"@angular/core\"), require(\"@angular/common\"), require(\"@angular/material\"));\n\telse\n\t\troot[\"@firestitch/file\"] = factory(root[\"@angular/core\"], root[\"@angular/common\"], root[\"@angular/material\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE__angular_core__, __WEBPACK_EXTERNAL_MODULE__angular_common__, __WEBPACK_EXTERNAL_MODULE__angular_material__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.ts\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9fd4e3417ff1b1fd2626","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/common')) :\n\ttypeof define === 'function' && define.amd ? define(['exports', '@angular/core', '@angular/common'], factory) :\n\t(factory((global.common = {}),global.core,global.common));\n}(this, (function (exports,core,common) { 'use strict';\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes} checked by tsc\r\n */\r\nvar FsArray = (function () {\r\n    function FsArray() {\r\n    }\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} name\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.nameValue = /**\r\n     * @param {?} array\r\n     * @param {?} name\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (array, name, value) {\r\n        var /** @type {?} */ list = [];\r\n        if (name || value) {\r\n            var /** @type {?} */ nameFn_1 = typeof name === 'function' ? name : function (item) { return item[name]; };\r\n            var /** @type {?} */ valueFn_1 = typeof value === 'function' ? value : function (item) { return item[value]; };\r\n            array.forEach(function (item) {\r\n                list.push({ name: nameFn_1(item), value: valueFn_1(item) });\r\n            });\r\n        }\r\n        else {\r\n            array.forEach(function (name, value) {\r\n                list.push({ name: name, value: value });\r\n            });\r\n        }\r\n        return list;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.remove = /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    function (array, query) {\r\n        var /** @type {?} */ idx = this.indexOf(array, query);\r\n        if (idx >= 0) {\r\n            return array.splice(idx, 1);\r\n        }\r\n        return idx;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.indexOf = /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    function (array, query) {\r\n        var _this = this;\r\n        if (typeof query !== 'function') {\r\n            var /** @type {?} */ queryObj_1 = query;\r\n            query = function (item) {\r\n                return _this.compare(queryObj_1, item);\r\n            };\r\n        }\r\n        for (var /** @type {?} */ i = 0, /** @type {?} */ len = array.length; i < len; i++) {\r\n            if (query(array[i])) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    /**\r\n     * @param {?} query\r\n     * @param {?} item\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.compare = /**\r\n     * @param {?} query\r\n     * @param {?} item\r\n     * @return {?}\r\n     */\r\n    function (query, item) {\r\n        var /** @type {?} */ value = true;\r\n        for (var /** @type {?} */ key in query) {\r\n            value = value && item[key] == query[key];\r\n        }\r\n        return value;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.filter = /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    function (array, query) {\r\n        var _this = this;\r\n        if (typeof query !== 'function') {\r\n            var /** @type {?} */ queryObj_2 = query;\r\n            query = function (item) {\r\n                return _this.compare(queryObj_2, item);\r\n            };\r\n        }\r\n        var /** @type {?} */ isarray = Array.isArray(array);\r\n        var /** @type {?} */ list = isarray ? [] : {};\r\n        if (isarray)\r\n            array.forEach(function (item, idx) {\r\n                if (query(item)) {\r\n                    list.push(item);\r\n                }\r\n            });\r\n        else\r\n            Object.keys(array).forEach(function (key) {\r\n                if (query(array[key])) {\r\n                    list[key] = array[key];\r\n                }\r\n            });\r\n        return list;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} property\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.index = /**\r\n     * @param {?} array\r\n     * @param {?} property\r\n     * @return {?}\r\n     */\r\n    function (array, property) {\r\n        var /** @type {?} */ list = {};\r\n        array.forEach(function (item, idx) {\r\n            list[item[property]] = item;\r\n        });\r\n        return list;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @param {?=} reverse\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.sort = /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @param {?=} reverse\r\n     * @return {?}\r\n     */\r\n    function (array, query, reverse) {\r\n        if (reverse === void 0) { reverse = false; }\r\n        if (typeof query !== 'function') {\r\n            var /** @type {?} */ queryStr_1 = query;\r\n            query = function (a, b) {\r\n                if (reverse) {\r\n                    if (a[queryStr_1] < b[queryStr_1]) {\r\n                        return 1;\r\n                    }\r\n                    else if (a[queryStr_1] > b[queryStr_1]) {\r\n                        return -1;\r\n                    }\r\n                }\r\n                else {\r\n                    if (a[queryStr_1] > b[queryStr_1]) {\r\n                        return 1;\r\n                    }\r\n                    else if (a[queryStr_1] < b[queryStr_1]) {\r\n                        return -1;\r\n                    }\r\n                }\r\n                return 0;\r\n            };\r\n        }\r\n        array.sort(query);\r\n        return array;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.rsort = /**\r\n     * @param {?} array\r\n     * @param {?} query\r\n     * @return {?}\r\n     */\r\n    function (array, query) {\r\n        return this.sort(array, query, true);\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} property\r\n     * @param {?=} index\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.list = /**\r\n     * @param {?} array\r\n     * @param {?} property\r\n     * @param {?=} index\r\n     * @return {?}\r\n     */\r\n    function (array, property, index) {\r\n        if (index === void 0) { index = null; }\r\n        var /** @type {?} */ list = index ? {} : [];\r\n        array.forEach(function (item, idx) {\r\n            if (index) {\r\n                list[item[index]] = item[property];\r\n            }\r\n            else {\r\n                list.push(item[property]);\r\n            }\r\n        });\r\n        return list;\r\n    };\r\n    /**\r\n     * @param {?} objects\r\n     * @param {?} parent_property\r\n     * @param {?=} id_property\r\n     * @param {?=} depth_property\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.applyDepth = /**\r\n     * @param {?} objects\r\n     * @param {?} parent_property\r\n     * @param {?=} id_property\r\n     * @param {?=} depth_property\r\n     * @return {?}\r\n     */\r\n    function (objects, parent_property, id_property, depth_property) {\r\n        if (id_property === void 0) { id_property = 'id'; }\r\n        if (depth_property === void 0) { depth_property = 'depth'; }\r\n        var /** @type {?} */ keyed = {};\r\n        objects.forEach(function (object) {\r\n            if (!object[parent_property])\r\n                object[depth_property] = 0;\r\n            keyed[object[id_property]] = object;\r\n        });\r\n        Object.keys(keyed).forEach(function (key) {\r\n            Object.keys(keyed).forEach(function (key) {\r\n                if (!keyed[key][depth_property]) {\r\n                    if (keyed[key][parent_property]) {\r\n                        keyed[key][depth_property] = keyed[keyed[key][parent_property]][depth_property] + 1;\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        return keyed;\r\n    };\r\n    /**\r\n     * @param {?} values\r\n     * @param {?} array\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.inArray = /**\r\n     * @param {?} values\r\n     * @param {?} array\r\n     * @return {?}\r\n     */\r\n    function (values, array) {\r\n        if (!Array.isArray(values)) {\r\n            values = [values];\r\n        }\r\n        for (var /** @type {?} */ i = 0, /** @type {?} */ len = values.length; i < len; i++) {\r\n            if (array.indexOf(values[i]) >= 0) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @param {?} key\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.keyExists = /**\r\n     * @param {?} array\r\n     * @param {?} key\r\n     * @return {?}\r\n     */\r\n    function (array, key) {\r\n        return array.hasOwnProperty(key);\r\n    };\r\n    /**\r\n     * @param {?} array\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.length = /**\r\n     * @param {?} array\r\n     * @return {?}\r\n     */\r\n    function (array) {\r\n        return array.length;\r\n    };\r\n    /**\r\n     * @param {?} unordered\r\n     * @return {?}\r\n     */\r\n    FsArray.prototype.ksort = /**\r\n     * @param {?} unordered\r\n     * @return {?}\r\n     */\r\n    function (unordered) {\r\n        Object.keys(unordered).sort().forEach(function (key) {\r\n            var /** @type {?} */ value = unordered[key];\r\n            delete unordered[key];\r\n            unordered[key] = value;\r\n        });\r\n    };\r\n    FsArray.decorators = [\r\n        { type: core.Injectable },\r\n    ];\r\n    /** @nocollapse */\r\n    FsArray.ctorParameters = function () { return []; };\r\n    return FsArray;\r\n}());\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes} checked by tsc\r\n */\r\nvar FsMath = (function () {\r\n    function FsMath() {\r\n    }\r\n    /**\r\n     * @param {?} number\r\n     * @param {?} precision\r\n     * @return {?}\r\n     */\r\n    FsMath.prototype.round = /**\r\n     * @param {?} number\r\n     * @param {?} precision\r\n     * @return {?}\r\n     */\r\n    function (number, precision) {\r\n        precision = precision || 0;\r\n        var /** @type {?} */ factor = Math.pow(10, precision);\r\n        var /** @type {?} */ tempNumber = number * factor;\r\n        var /** @type {?} */ roundedTempNumber = Math.round(tempNumber);\r\n        return roundedTempNumber / factor;\r\n    };\r\n    FsMath.decorators = [\r\n        { type: core.Injectable },\r\n    ];\r\n    /** @nocollapse */\r\n    FsMath.ctorParameters = function () { return []; };\r\n    return FsMath;\r\n}());\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes} checked by tsc\r\n */\r\nvar KEY_CANCEL = 3;\nvar KEY_HELP = 6;\nvar KEY_BACKSPACE = 8;\nvar KEY_TAB = 9;\nvar KEY_CLEAR = 12;\nvar KEY_RETURN = 13;\nvar KEY_ENTER = 14;\nvar KEY_SHIFT = 16;\nvar KEY_CONTROL = 17;\nvar KEY_ALT = 18;\nvar KEY_PAUSE = 19;\nvar KEY_CAPS_LOCK = 20;\nvar KEY_ESCAPE = 27;\nvar KEY_SPACE = 32;\nvar KEY_PAGE_UP = 33;\nvar KEY_PAGE_DOWN = 34;\nvar KEY_END = 35;\nvar KEY_HOME = 36;\nvar KEY_LEFT = 37;\nvar KEY_UP = 38;\nvar KEY_RIGHT = 39;\nvar KEY_DOWN = 40;\nvar KEY_PRINTSCREEN = 44;\nvar KEY_INSERT = 45;\nvar KEY_DELETE = 46;\nvar KEY_0 = 48;\nvar KEY_1 = 49;\nvar KEY_2 = 50;\nvar KEY_3 = 51;\nvar KEY_4 = 52;\nvar KEY_5 = 53;\nvar KEY_6 = 54;\nvar KEY_7 = 55;\nvar KEY_8 = 56;\nvar KEY_9 = 57;\nvar KEY_SEMICOLON = 59;\nvar KEY_EQUALS = 61;\r\nvar FsUtil = (function () {\r\n    function FsUtil() {\r\n        this.intervals = {};\r\n    }\r\n    /**\r\n     * @param {?=} pattern\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.guid = /**\r\n     * @param {?=} pattern\r\n     * @return {?}\r\n     */\r\n    function (pattern) {\r\n        pattern = pattern || 'xxxxxx';\r\n        return pattern.replace(/[xy]/g, function (c) {\r\n            var /** @type {?} */ r = Math.random() * 16 | 0, /** @type {?} */ v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n            return v.toString(16);\r\n        });\r\n    };\r\n    /**\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.uuid = /**\r\n     * @return {?}\r\n     */\r\n    function () {\r\n        return this.guid('xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx');\r\n    };\r\n    /**\r\n     * @param {?} promise\r\n     * @param {?=} defaults\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.resolve = /**\r\n     * @param {?} promise\r\n     * @param {?=} defaults\r\n     * @return {?}\r\n     */\r\n    function (promise, defaults) {\r\n        if (defaults === void 0) { defaults = []; }\r\n        var /** @type {?} */ result = defaults;\r\n        return new Promise(function (resolve) {\r\n            promise.then(function (data) {\r\n                Object.keys(data).forEach(function (key) { return result[key] = data[key]; });\r\n                resolve(result);\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.int = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        value = parseInt(value);\r\n        if (isNaN(value)) {\r\n            value = 0;\r\n        }\r\n        return value;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.float = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        value = parseFloat(value);\r\n        if (isNaN(value)) {\r\n            value = 0;\r\n        }\r\n        return value;\r\n    };\r\n    /**\r\n     * @param {?} string\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.string = /**\r\n     * @param {?} string\r\n     * @return {?}\r\n     */\r\n    function (string) {\r\n        if (string === null || string === undefined) {\r\n            string = '';\r\n        }\r\n        return (string).toString();\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @param {?=} options\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isEmpty = /**\r\n     * @param {?} value\r\n     * @param {?=} options\r\n     * @return {?}\r\n     */\r\n    function (value, options) {\r\n        options = options || {};\r\n        return value === undefined ||\r\n            value === null ||\r\n            value === false ||\r\n            value === '' ||\r\n            !this.string(value).length ||\r\n            (this.isObject(value) &&\r\n                (value.constructor.name === 'Object' && !Object.keys(value).length)) ||\r\n            (!options.zero && (value === 0 || value === '0'));\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @param {?=} type\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isInt = /**\r\n     * @param {?} value\r\n     * @param {?=} type\r\n     * @return {?}\r\n     */\r\n    function (value, type) {\r\n        var /** @type {?} */ int = !!this.string(value).match(/^\\d+$/);\r\n        if (!int) {\r\n            return false;\r\n        }\r\n        if (type) {\r\n            return Number.isInteger(value);\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * @param {?} object\r\n     * @param {?} func\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.each = /**\r\n     * @param {?} object\r\n     * @param {?} func\r\n     * @return {?}\r\n     */\r\n    function (object, func) {\r\n        if (!this.isArray(object) && !this.isObject(object)) {\r\n            return;\r\n        }\r\n        Object.keys(object).forEach(function (key) {\r\n            func(object[key], key);\r\n        });\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isObject = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return value !== null && typeof value === 'object' && !this.isArray(value);\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isString = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return typeof value === 'string' || value instanceof String;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isArray = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return value instanceof Array;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isNumeric = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return this.string(value).length && !!this.string(value).match(/^-?\\d*\\.?\\d*$/);\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @param {?} cls\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isClass = /**\r\n     * @param {?} value\r\n     * @param {?} cls\r\n     * @return {?}\r\n     */\r\n    function (value, cls) {\r\n        if (this.isObject(value)) {\r\n            if (this.isString(cls)) {\r\n                if (value.constructor) {\r\n                    if (value.constructor.name === cls) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (value instanceof cls) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.isBoolean = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return value === true || value === false;\r\n    };\r\n    /**\r\n     * @param {?} object\r\n     * @param {?} key\r\n     * @param {?} def\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.value = /**\r\n     * @param {?} object\r\n     * @param {?} key\r\n     * @param {?} def\r\n     * @return {?}\r\n     */\r\n    function (object, key, def) {\r\n        if (this.isObject(object) || this.isArray(object)) {\r\n            if (object.hasOwnProperty(key)) {\r\n                return object[key];\r\n            }\r\n        }\r\n        return def;\r\n    };\r\n    /**\r\n     * @param {?} fn\r\n     * @param {?} delay\r\n     * @param {?} name\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.interval = /**\r\n     * @param {?} fn\r\n     * @param {?} delay\r\n     * @param {?} name\r\n     * @return {?}\r\n     */\r\n    function (fn, delay, name) {\r\n        var /** @type {?} */ instance = setInterval(fn, delay);\r\n        if (name) {\r\n            this.intervals[name] = instance;\r\n        }\r\n        return function () {\r\n            window.clearInterval(instance);\r\n        };\r\n    };\r\n    /**\r\n     * @param {?} name\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.clearInterval = /**\r\n     * @param {?} name\r\n     * @return {?}\r\n     */\r\n    function (name) {\r\n        var /** @type {?} */ instance = this.intervals[name];\r\n        if (instance) {\r\n            window.clearInterval(instance);\r\n        }\r\n    };\r\n    /**\r\n     * @param {?} func\r\n     * @param {?} wait\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.throttle = /**\r\n     * @param {?} func\r\n     * @param {?} wait\r\n     * @return {?}\r\n     */\r\n    function (func, wait) {\r\n        var /** @type {?} */ waiting = false; // Initially, we're not waiting\r\n        return function () {\r\n            // We return a throttled function\r\n            if (!waiting) {\r\n                // If we're not waiting\r\n                func.apply(null, arguments); // Execute users function\r\n                waiting = true; // Prevent future invocations\r\n                setTimeout(function () {\r\n                    // After a period of time\r\n                    waiting = false; // And allow future invocations\r\n                }, wait);\r\n            }\r\n        };\r\n    };\r\n    /**\r\n     * @param {?} func\r\n     * @param {?} wait\r\n     * @param {?} immediate\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.debounce = /**\r\n     * @param {?} func\r\n     * @param {?} wait\r\n     * @param {?} immediate\r\n     * @return {?}\r\n     */\r\n    function (func, wait, immediate) {\r\n        var /** @type {?} */ timeout;\r\n        return function () {\r\n            var /** @type {?} */ context = this, /** @type {?} */ args = arguments;\r\n            var /** @type {?} */ later = function () {\r\n                timeout = null;\r\n                if (!immediate)\r\n                    func.apply(context, args);\r\n            };\r\n            var /** @type {?} */ callNow = immediate && !timeout;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(later, wait);\r\n            if (callNow)\r\n                func.apply(context, args);\r\n        };\r\n    };\r\n    /**\r\n     * @param {?} object\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.length = /**\r\n     * @param {?} object\r\n     * @return {?}\r\n     */\r\n    function (object) {\r\n        if (this.isObject(object)) {\r\n            return Object.keys(object).length;\r\n        }\r\n        if (this.isArray(object)) {\r\n            return object.length;\r\n        }\r\n        return 0;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.boolean = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return this.string(value).toLowerCase() !== 'false' && !!value;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtil.prototype.stringify = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return JSON.stringify(value);\r\n    };\r\n    FsUtil.decorators = [\r\n        { type: core.Injectable },\r\n    ];\r\n    /** @nocollapse */\r\n    FsUtil.ctorParameters = function () { return []; };\r\n    return FsUtil;\r\n}());\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes} checked by tsc\r\n */\r\nvar FsValidate = (function () {\r\n    function FsValidate(fsUtil) {\r\n        this.fsUtil = fsUtil;\r\n    }\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsValidate.prototype.phone = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        var /** @type {?} */ valid = /^[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}$/.test(value);\r\n        return valid || !String(value).length;\r\n    };\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsValidate.prototype.email = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return !!this.fsUtil.string(value).match(/^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/);\r\n    };\r\n    FsValidate.decorators = [\r\n        { type: core.Injectable },\r\n    ];\r\n    /** @nocollapse */\r\n    FsValidate.ctorParameters = function () { return [\r\n        { type: FsUtil, },\r\n    ]; };\r\n    return FsValidate;\r\n}());\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes} checked by tsc\r\n */\r\nvar FsUtilStringifyPipe = (function () {\r\n    function FsUtilStringifyPipe(FsUtil$$1) {\r\n        this.FsUtil = FsUtil$$1;\r\n    }\r\n    /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    FsUtilStringifyPipe.prototype.transform = /**\r\n     * @param {?} value\r\n     * @return {?}\r\n     */\r\n    function (value) {\r\n        return this.FsUtil.stringify(value);\r\n    };\r\n    FsUtilStringifyPipe.decorators = [\r\n        { type: core.Pipe, args: [{\r\n                    name: 'fsUtilStringify'\r\n                },] },\r\n    ];\r\n    /** @nocollapse */\r\n    FsUtilStringifyPipe.ctorParameters = function () { return [\r\n        { type: FsUtil, },\r\n    ]; };\r\n    return FsUtilStringifyPipe;\r\n}());\r\nvar FsUtilGuidPipe = (function () {\r\n    function FsUtilGuidPipe(FsUtil$$1) {\r\n        this.FsUtil = FsUtil$$1;\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    FsUtilGuidPipe.prototype.transform = /**\r\n     * @return {?}\r\n     */\r\n    function () {\r\n        return this.FsUtil.guid();\r\n    };\r\n    FsUtilGuidPipe.decorators = [\r\n        { type: core.Pipe, args: [{\r\n                    name: 'fsUtilGuid'\r\n                },] },\r\n    ];\r\n    /** @nocollapse */\r\n    FsUtilGuidPipe.ctorParameters = function () { return [\r\n        { type: FsUtil, },\r\n    ]; };\r\n    return FsUtilGuidPipe;\r\n}());\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes} checked by tsc\r\n */\r\nvar FsCommonModule = (function () {\r\n    function FsCommonModule() {\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    FsCommonModule.forRoot = /**\r\n     * @return {?}\r\n     */\r\n    function () {\r\n        return {\r\n            ngModule: FsCommonModule,\r\n            providers: [\r\n                FsArray,\r\n                FsUtil,\r\n                FsMath,\r\n                FsValidate\r\n            ]\r\n        };\r\n    };\r\n    FsCommonModule.decorators = [\r\n        { type: core.NgModule, args: [{\r\n                    imports: [\r\n                        common.CommonModule\r\n                    ],\r\n                    declarations: [\r\n                        FsUtilStringifyPipe,\r\n                        FsUtilGuidPipe\r\n                    ],\r\n                    providers: [\r\n                        FsArray,\r\n                        FsUtil,\r\n                        FsMath,\r\n                        FsValidate\r\n                    ],\r\n                    exports: [\r\n                        FsUtilStringifyPipe,\r\n                        FsUtilGuidPipe\r\n                    ]\r\n                },] },\r\n    ];\r\n    /** @nocollapse */\r\n    FsCommonModule.ctorParameters = function () { return []; };\r\n    return FsCommonModule;\r\n}());\n\nexports.FsCommonModule = FsCommonModule;\nexports.FsUtilStringifyPipe = FsUtilStringifyPipe;\nexports.FsUtilGuidPipe = FsUtilGuidPipe;\nexports.KEY_CANCEL = KEY_CANCEL;\nexports.KEY_HELP = KEY_HELP;\nexports.KEY_BACKSPACE = KEY_BACKSPACE;\nexports.KEY_TAB = KEY_TAB;\nexports.KEY_CLEAR = KEY_CLEAR;\nexports.KEY_RETURN = KEY_RETURN;\nexports.KEY_ENTER = KEY_ENTER;\nexports.KEY_SHIFT = KEY_SHIFT;\nexports.KEY_CONTROL = KEY_CONTROL;\nexports.KEY_ALT = KEY_ALT;\nexports.KEY_PAUSE = KEY_PAUSE;\nexports.KEY_CAPS_LOCK = KEY_CAPS_LOCK;\nexports.KEY_ESCAPE = KEY_ESCAPE;\nexports.KEY_SPACE = KEY_SPACE;\nexports.KEY_PAGE_UP = KEY_PAGE_UP;\nexports.KEY_PAGE_DOWN = KEY_PAGE_DOWN;\nexports.KEY_END = KEY_END;\nexports.KEY_HOME = KEY_HOME;\nexports.KEY_LEFT = KEY_LEFT;\nexports.KEY_UP = KEY_UP;\nexports.KEY_RIGHT = KEY_RIGHT;\nexports.KEY_DOWN = KEY_DOWN;\nexports.KEY_PRINTSCREEN = KEY_PRINTSCREEN;\nexports.KEY_INSERT = KEY_INSERT;\nexports.KEY_DELETE = KEY_DELETE;\nexports.KEY_0 = KEY_0;\nexports.KEY_1 = KEY_1;\nexports.KEY_2 = KEY_2;\nexports.KEY_3 = KEY_3;\nexports.KEY_4 = KEY_4;\nexports.KEY_5 = KEY_5;\nexports.KEY_6 = KEY_6;\nexports.KEY_7 = KEY_7;\nexports.KEY_8 = KEY_8;\nexports.KEY_9 = KEY_9;\nexports.KEY_SEMICOLON = KEY_SEMICOLON;\nexports.KEY_EQUALS = KEY_EQUALS;\nexports.FsUtil = FsUtil;\nexports.FsArray = FsArray;\nexports.FsMath = FsMath;\nexports.FsValidate = FsValidate;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/@firestitch/common/common.umd.js\n// module id = ../node_modules/@firestitch/common/common.umd.js\n// module chunks = 0","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \":host.dragover .select {\\n  border: 2px #07a8e6 dashed;\\n  color: #07a8e6;\\n}\\n\\n:host.dragover .select button {\\n  display: none;\\n}\\n\\n:host.dragover .select .mat-icon {\\n  color: #07a8e6;\\n}\\n\\n:host.dragover ::ng-deep .preview-container:after {\\n  content: \\\"\\\";\\n  width: 98%;\\n  display: block;\\n  height: 98%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  border: 2px #07a8e6 dashed;\\n  background: #07a8e6;\\n  opacity: 0.4;\\n}\\n\\n.select {\\n  text-align: center;\\n  border: 1px solid #ddd;\\n  border-radius: 3px;\\n  width: 150px;\\n  height: 150px;\\n  display: table-cell;\\n  vertical-align: middle;\\n  padding: 10px;\\n  -webkit-box-pack: center;\\n      -ms-flex-pack: center;\\n          justify-content: center;\\n  -webkit-box-orient: vertical;\\n  -webkit-box-direction: normal;\\n      -ms-flex-direction: column;\\n          flex-direction: column;\\n  -webkit-box-sizing: border-box;\\n          box-sizing: border-box;\\n}\\n\\n.select mat-icon {\\n  -webkit-transform: scale(1.8);\\n          transform: scale(1.8);\\n  color: #ddd;\\n}\\n\\n.instruction {\\n  font-size: 12px;\\n  padding: 8px 0;\\n}\\n\\n.label {\\n  -webkit-transform: scale(0.75) translateZ(0.001px);\\n          transform: scale(0.75) translateZ(0.001px);\\n  -webkit-transform-origin: 0 0;\\n          transform-origin: 0 0;\\n}\\n\\n\", \"\", {\"version\":3,\"sources\":[\"/Users/Basters/dev/firestitch/fs-file/src/components/fs-file-picker/src/components/fs-file-picker/fs-file-picker.component.scss\",\"/Users/Basters/dev/firestitch/fs-file/fs-file-picker.component.scss\"],\"names\":[],\"mappings\":\"AAAA;EAGM,2BAAA;EACA,eAAA;CCDL;;ADHD;EAOQ,cAAA;CCAP;;ADPD;EAWQ,eAAA;CCAP;;ADXD;EAiBU,YAAA;EACA,WAAA;EACA,eAAA;EACA,YAAA;EACA,mBAAA;EACA,QAAA;EACA,OAAA;EACA,2BAAA;EACA,oBAAA;EACA,aAAA;CCFT;;ADSD;EACE,mBAAA;EACA,uBAAA;EACA,mBAAA;EACA,aAAA;EACA,cAAA;EACA,oBAAA;EACA,uBAAA;EACA,cAAA;EACA,yBAAA;MAAA,sBAAA;UAAA,wBAAA;EACA,6BAAA;EAAA,8BAAA;MAAA,2BAAA;UAAA,uBAAA;EACA,+BAAA;UAAA,uBAAA;CCND;;ADLD;EAeI,8BAAA;UAAA,sBAAA;EACA,YAAA;CCNH;;ADUD;EACE,gBAAA;EACA,eAAA;CCPD;;ADUD;EACE,mDAAA;UAAA,2CAAA;EACA,8BAAA;UAAA,sBAAA;CCPD\",\"file\":\"fs-file-picker.component.scss\",\"sourcesContent\":[\":host {\\n  &.dragover {\\n    .select {\\n      border: 2px #07a8e6 dashed;\\n      color: #07a8e6;\\n\\n      button {\\n        display: none;\\n      }\\n\\n      .mat-icon {\\n        color: #07a8e6;\\n      }\\n    }\\n    ::ng-deep {\\n      .preview-container {\\n        &:after {\\n          content: \\\"\\\";\\n          width: 98%;\\n          display: block;\\n          height: 98%;\\n          position: absolute;\\n          left: 0;\\n          top: 0;\\n          border: 2px #07a8e6 dashed;\\n          background: #07a8e6;\\n          opacity: 0.4;\\n        }\\n      }\\n    }\\n  }\\n}\\n\\n.select {\\n  text-align: center;\\n  border: 1px solid #ddd;\\n  border-radius: 3px;\\n  width: 150px;\\n  height: 150px;\\n  display: table-cell;\\n  vertical-align: middle;\\n  padding: 10px;\\n  justify-content: center;\\n  flex-direction: column;\\n  box-sizing: border-box;\\n\\n\\n  mat-icon {\\n    transform: scale(1.8);\\n    color: #ddd;\\n  }\\n}\\n\\n.instruction {\\n  font-size: 12px;\\n  padding: 8px 0;\\n}\\n\\n.label {\\n  transform: scale(.75) translateZ(.001px);\\n  transform-origin: 0 0;\\n}\\n\",\":host.dragover .select {\\n  border: 2px #07a8e6 dashed;\\n  color: #07a8e6;\\n}\\n\\n:host.dragover .select button {\\n  display: none;\\n}\\n\\n:host.dragover .select .mat-icon {\\n  color: #07a8e6;\\n}\\n\\n:host.dragover ::ng-deep .preview-container:after {\\n  content: \\\"\\\";\\n  width: 98%;\\n  display: block;\\n  height: 98%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  border: 2px #07a8e6 dashed;\\n  background: #07a8e6;\\n  opacity: 0.4;\\n}\\n\\n.select {\\n  text-align: center;\\n  border: 1px solid #ddd;\\n  border-radius: 3px;\\n  width: 150px;\\n  height: 150px;\\n  display: table-cell;\\n  vertical-align: middle;\\n  padding: 10px;\\n  justify-content: center;\\n  flex-direction: column;\\n  box-sizing: border-box;\\n}\\n\\n.select mat-icon {\\n  transform: scale(1.8);\\n  color: #ddd;\\n}\\n\\n.instruction {\\n  font-size: 12px;\\n  padding: 8px 0;\\n}\\n\\n.label {\\n  transform: scale(0.75) translateZ(0.001px);\\n  transform-origin: 0 0;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?{\"sourceMap\":true}!../node_modules/postcss-loader/lib?{\"sourceMap\":true}!../node_modules/resolve-url-loader?{\"sourceMap\":true}!../node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./components/fs-file-picker/fs-file-picker.component.scss\n// module id = ../node_modules/css-loader/index.js?{\"sourceMap\":true}!../node_modules/postcss-loader/lib/index.js?{\"sourceMap\":true}!../node_modules/resolve-url-loader/index.js?{\"sourceMap\":true}!../node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./components/fs-file-picker/fs-file-picker.component.scss\n// module chunks = 0","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".file-ext {\\n  font-weight: bold;\\n  text-align: center;\\n  text-transform: uppercase;\\n  padding: 15px 0;\\n  font-size: 25px;\\n}\\n\\n.file-name {\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  padding: 0 5px;\\n  font-size: 12px;\\n  text-align: center;\\n}\\n\\n.actions {\\n  position: absolute;\\n  display: none;\\n  width: 100%;\\n  height: 100%;\\n  top: 0;\\n  left: 0;\\n  background: rgba(0, 0, 0, .5);\\n}\\n\\n.actions .action {\\n  position: absolute;\\n  cursor: pointer;\\n}\\n\\n.actions .action.top-left {\\n  top: 5%;\\n  right: 5%;\\n}\\n\\n.actions .action.top-right {\\n  top: 5%;\\n  right: 5%;\\n}\\n\\n.actions .action.bottom-left {\\n  bottom: 5%;\\n  left: 5%;\\n}\\n\\n.actions .action.bottom-right {\\n  bottom: 5%;\\n  right: 5%;\\n}\\n\\n.actions .action.mat-mini-fab {\\n  width: 22%;\\n  height: 22%;\\n  min-width: 30px;\\n  min-height: 30px;\\n  max-width: 42px;\\n  max-height: 42px;\\n  line-height: 15px !important;\\n}\\n\\n.actions .action.mat-mini-fab .mat-button-wrapper {\\n  padding: 4px 0;\\n  line-height: 15px !important;\\n}\\n\\n:host:hover .file-name {\\n  overflow: visible;\\n  white-space: normal;\\n  word-wrap: break-word;\\n}\\n\\n:host.preview {\\n  display: inline-block;\\n  position: relative;\\n  margin-right: 10px;\\n  border: 1px #DDD solid;\\n  vertical-align: top;\\n  border-radius: 3px;\\n}\\n\\n:host.preview:last-child {\\n  margin-right: 0;\\n}\\n\\n:host.preview:hover .actions {\\n  display: block;\\n}\\n\\n:host.preview img {\\n  display: block;\\n  border-radius: 3px;\\n}\\n\\n:host ::ng-deep .mat-button-wrapper {\\n  padding: 0;\\n  line-height: 15px !important;\\n}\\n\\n:host ::ng-deep .spinner {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  margin-left: -25%;\\n  margin-top: -25%;\\n}\\n\\n@media only screen and (max-width: 550px) {\\n  .actions {\\n    display: block;\\n    background: none;\\n  }\\n}\\n\\n\", \"\", {\"version\":3,\"sources\":[\"/Users/Basters/dev/firestitch/fs-file/src/components/fs-file-preview/src/components/fs-file-preview/fs-file-preview.component.scss\",\"/Users/Basters/dev/firestitch/fs-file/fs-file-preview.component.scss\"],\"names\":[],\"mappings\":\"AAAA;EACE,kBAAA;EACA,mBAAA;EACA,0BAAA;EACA,gBAAA;EACA,gBAAA;CCCD;;ADED;EACE,oBAAA;EACA,iBAAA;EACA,wBAAA;EACA,eAAA;EACA,gBAAA;EACA,mBAAA;CCCD;;ADED;EACE,mBAAA;EACA,cAAA;EACA,YAAA;EACA,aAAA;EACA,OAAA;EACA,QAAA;EACA,8BAAA;CCCD;;ADRD;EAWI,mBAAA;EACA,gBAAA;CCCH;;ADbD;EAeM,QAAA;EACA,UAAA;CCEL;;ADTC;EAWI,QAAA;EACA,UAAA;CCEL;;ADvBD;EAyBM,WAAA;EACA,SAAA;CCEL;;ADnBC;EAqBI,WAAA;EACA,UAAA;CCEL;;ADjCD;EAmCM,WAAA;EACA,YAAA;EACA,gBAAA;EACA,iBAAA;EACA,gBAAA;EACA,iBAAA;EACA,6BAAA;CCEL;;AD3CD;EA4CQ,eAAA;EACA,6BAAA;CCGP;;ADIS;EACN,kBAAA;EACA,oBAAA;EACA,sBAAA;CCDH;;ADHD;EAQI,sBAAA;EACA,mBAAA;EACA,mBAAA;EACA,uBAAA;EACA,oBAAA;EACA,mBAAA;CCDH;;ADGG;EACE,gBAAA;CCAL;;ADIK;EACE,eAAA;CCDP;;ADKG;EACE,eAAA;EACA,mBAAA;CCFL;;ADQD;EAEI,WAAA;EACA,6BAAA;CCNH;;ADSC;EACE,mBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,iBAAA;CCNH;;ADUD;EACE;IACI,eAAA;IACA,iBAAA;GCPH;CACF\",\"file\":\"fs-file-preview.component.scss\",\"sourcesContent\":[\".file-ext {\\n  font-weight: bold;\\n  text-align: center;\\n  text-transform: uppercase;\\n  padding: 15px 0;\\n  font-size: 25px;\\n}\\n\\n.file-name {\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  padding: 0 5px;\\n  font-size: 12px;\\n  text-align: center;\\n}\\n\\n.actions {\\n  position: absolute;\\n  display: none;\\n  width: 100%;\\n  height: 100%;\\n  top: 0;\\n  left: 0;\\n  background: rgba(0, 0, 0, 0.5);\\n\\n  .action {\\n\\n    position: absolute;\\n    cursor: pointer;\\n\\n    &.top-left {\\n      top: 5%;\\n      right: 5%;\\n    }\\n\\n    &.top-right {\\n      top: 5%;\\n      right: 5%;\\n    }\\n\\n    &.bottom-left {\\n      bottom: 5%;\\n      left: 5%;\\n    }\\n\\n    &.bottom-right {\\n      bottom: 5%;\\n      right: 5%;\\n    }\\n\\n    &.mat-mini-fab {\\n      width: 22%;\\n      height: 22%;\\n      min-width: 30px;\\n      min-height: 30px;\\n      max-width: 42px;\\n      max-height: 42px;\\n      line-height: 15px !important;\\n\\n      .mat-button-wrapper {\\n        padding: 4px 0;\\n        line-height: 15px !important;\\n      }\\n    }\\n  }\\n}\\n\\n:host {\\n  &:hover .file-name {\\n    overflow: visible;\\n    white-space: normal;\\n    word-wrap: break-word;\\n  }\\n\\n  &.preview {\\n    display: inline-block;\\n    position: relative;\\n    margin-right: 10px;\\n    border: 1px #DDD solid;\\n    vertical-align: top;\\n    border-radius: 3px;\\n\\n    &:last-child {\\n      margin-right: 0;\\n    }\\n\\n    &:hover {\\n      .actions {\\n        display: block;\\n      }\\n    }\\n\\n    img {\\n      display: block;\\n      border-radius: 3px;\\n    }\\n  }\\n\\n}\\n\\n:host ::ng-deep {\\n  .mat-button-wrapper {\\n    padding: 0;\\n    line-height: 15px !important;\\n  }\\n\\n  .spinner {\\n    position: absolute;\\n    top: 50%;\\n    left: 50%;\\n    margin-left: -25%;\\n    margin-top: -25%;\\n  }\\n}\\n\\n@media only screen and (max-width: 550px) {\\n  .actions {\\n      display: block;\\n      background: none;\\n  }\\n}\\n\",\".file-ext {\\n  font-weight: bold;\\n  text-align: center;\\n  text-transform: uppercase;\\n  padding: 15px 0;\\n  font-size: 25px;\\n}\\n\\n.file-name {\\n  white-space: nowrap;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  padding: 0 5px;\\n  font-size: 12px;\\n  text-align: center;\\n}\\n\\n.actions {\\n  position: absolute;\\n  display: none;\\n  width: 100%;\\n  height: 100%;\\n  top: 0;\\n  left: 0;\\n  background: rgba(0, 0, 0, 0.5);\\n}\\n\\n.actions .action {\\n  position: absolute;\\n  cursor: pointer;\\n}\\n\\n.actions .action.top-left {\\n  top: 5%;\\n  right: 5%;\\n}\\n\\n.actions .action.top-right {\\n  top: 5%;\\n  right: 5%;\\n}\\n\\n.actions .action.bottom-left {\\n  bottom: 5%;\\n  left: 5%;\\n}\\n\\n.actions .action.bottom-right {\\n  bottom: 5%;\\n  right: 5%;\\n}\\n\\n.actions .action.mat-mini-fab {\\n  width: 22%;\\n  height: 22%;\\n  min-width: 30px;\\n  min-height: 30px;\\n  max-width: 42px;\\n  max-height: 42px;\\n  line-height: 15px !important;\\n}\\n\\n.actions .action.mat-mini-fab .mat-button-wrapper {\\n  padding: 4px 0;\\n  line-height: 15px !important;\\n}\\n\\n:host:hover .file-name {\\n  overflow: visible;\\n  white-space: normal;\\n  word-wrap: break-word;\\n}\\n\\n:host.preview {\\n  display: inline-block;\\n  position: relative;\\n  margin-right: 10px;\\n  border: 1px #DDD solid;\\n  vertical-align: top;\\n  border-radius: 3px;\\n}\\n\\n:host.preview:last-child {\\n  margin-right: 0;\\n}\\n\\n:host.preview:hover .actions {\\n  display: block;\\n}\\n\\n:host.preview img {\\n  display: block;\\n  border-radius: 3px;\\n}\\n\\n:host ::ng-deep .mat-button-wrapper {\\n  padding: 0;\\n  line-height: 15px !important;\\n}\\n\\n:host ::ng-deep .spinner {\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  margin-left: -25%;\\n  margin-top: -25%;\\n}\\n\\n@media only screen and (max-width: 550px) {\\n  .actions {\\n    display: block;\\n    background: none;\\n  }\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?{\"sourceMap\":true}!../node_modules/postcss-loader/lib?{\"sourceMap\":true}!../node_modules/resolve-url-loader?{\"sourceMap\":true}!../node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./components/fs-file-preview/fs-file-preview.component.scss\n// module id = ../node_modules/css-loader/index.js?{\"sourceMap\":true}!../node_modules/postcss-loader/lib/index.js?{\"sourceMap\":true}!../node_modules/resolve-url-loader/index.js?{\"sourceMap\":true}!../node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./components/fs-file-preview/fs-file-preview.component.scss\n// module chunks = 0","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".queue {\\n  position: relative;\\n  display: block;\\n}\\n\\n\", \"\", {\"version\":3,\"sources\":[\"/Users/Basters/dev/firestitch/fs-file/src/components/fs-file-previews/src/components/fs-file-previews/fs-file-previews.component.scss\",\"/Users/Basters/dev/firestitch/fs-file/fs-file-previews.component.scss\"],\"names\":[],\"mappings\":\"AAAA;EACE,mBAAA;EACA,eAAA;CCCD\",\"file\":\"fs-file-previews.component.scss\",\"sourcesContent\":[\".queue {\\n  position: relative;\\n  display: block;\\n}\\n\",\".queue {\\n  position: relative;\\n  display: block;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader?{\"sourceMap\":true}!../node_modules/postcss-loader/lib?{\"sourceMap\":true}!../node_modules/resolve-url-loader?{\"sourceMap\":true}!../node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./components/fs-file-previews/fs-file-previews.component.scss\n// module id = ../node_modules/css-loader/index.js?{\"sourceMap\":true}!../node_modules/postcss-loader/lib/index.js?{\"sourceMap\":true}!../node_modules/resolve-url-loader/index.js?{\"sourceMap\":true}!../node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./components/fs-file-previews/fs-file-previews.component.scss\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/css-loader/lib/css-base.js\n// module id = ../node_modules/css-loader/lib/css-base.js\n// module chunks = 0","/*! FileAPI 2.0.25 - BSD | git://github.com/mailru/FileAPI.git\n * FileAPI — a set of  javascript tools for working with files. Multiupload, drag'n'drop and chunked file upload. Images: crop, resize and auto orientation by EXIF.\n */\n\n/*\n * JavaScript Canvas to Blob 2.0.5\n * https://github.com/blueimp/JavaScript-Canvas-to-Blob\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n *\n * Based on stackoverflow user Stoive's code snippet:\n * http://stackoverflow.com/q/4998908\n */\n\n/*jslint nomen: true, regexp: true */\n/*global window, atob, Blob, ArrayBuffer, Uint8Array */\n\n(function (window) {\n    'use strict';\n    var CanvasPrototype = window.HTMLCanvasElement &&\n            window.HTMLCanvasElement.prototype,\n        hasBlobConstructor = window.Blob && (function () {\n            try {\n                return Boolean(new Blob());\n            } catch (e) {\n                return false;\n            }\n        }()),\n        hasArrayBufferViewSupport = hasBlobConstructor && window.Uint8Array &&\n            (function () {\n                try {\n                    return new Blob([new Uint8Array(100)]).size === 100;\n                } catch (e) {\n                    return false;\n                }\n            }()),\n        BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder ||\n            window.MozBlobBuilder || window.MSBlobBuilder,\n        dataURLtoBlob = (hasBlobConstructor || BlobBuilder) && window.atob &&\n            window.ArrayBuffer && window.Uint8Array && function (dataURI) {\n                var byteString,\n                    arrayBuffer,\n                    intArray,\n                    i,\n                    mimeString,\n                    bb;\n                if (dataURI.split(',')[0].indexOf('base64') >= 0) {\n                    // Convert base64 to raw binary data held in a string:\n                    byteString = atob(dataURI.split(',')[1]);\n                } else {\n                    // Convert base64/URLEncoded data component to raw binary data:\n                    byteString = decodeURIComponent(dataURI.split(',')[1]);\n                }\n                // Write the bytes of the string to an ArrayBuffer:\n                arrayBuffer = new ArrayBuffer(byteString.length);\n                intArray = new Uint8Array(arrayBuffer);\n                for (i = 0; i < byteString.length; i += 1) {\n                    intArray[i] = byteString.charCodeAt(i);\n                }\n                // Separate out the mime component:\n                mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n                // Write the ArrayBuffer (or ArrayBufferView) to a blob:\n                if (hasBlobConstructor) {\n                    return new Blob(\n                        [hasArrayBufferViewSupport ? intArray : arrayBuffer],\n                        {type: mimeString}\n                    );\n                }\n                bb = new BlobBuilder();\n                bb.append(arrayBuffer);\n                return bb.getBlob(mimeString);\n            };\n    if (window.HTMLCanvasElement && !CanvasPrototype.toBlob) {\n        if (CanvasPrototype.mozGetAsFile) {\n            CanvasPrototype.toBlob = function (callback, type, quality) {\n                if (quality && CanvasPrototype.toDataURL && dataURLtoBlob) {\n                    callback(dataURLtoBlob(this.toDataURL(type, quality)));\n                } else {\n                    callback(this.mozGetAsFile('blob', type));\n                }\n            };\n        } else if (CanvasPrototype.toDataURL && dataURLtoBlob) {\n            CanvasPrototype.toBlob = function (callback, type, quality) {\n                callback(dataURLtoBlob(this.toDataURL(type, quality)));\n            };\n        }\n    }\n    window.dataURLtoBlob = dataURLtoBlob;\n})(window);\n\n/*jslint evil: true */\n/*global window, URL, webkitURL, ActiveXObject */\n\n(function (window, undef){\n\t'use strict';\n\n\tvar\n\t\tgid = 1,\n\t\tnoop = function (){},\n\n\t\tdocument = window.document,\n\t\tdoctype = document.doctype || {},\n\t\tuserAgent = window.navigator.userAgent,\n\t\tsafari = /safari\\//i.test(userAgent) && !/chrome\\//i.test(userAgent),\n\t\tiemobile = /iemobile\\//i.test(userAgent),\n\t\tinsecureChrome = !safari && /chrome\\//i.test(userAgent) && window.location.protocol === 'http:',\n\n\t\t// https://github.com/blueimp/JavaScript-Load-Image/blob/master/load-image.js#L48\n\t\tapiURL = (window.createObjectURL && window) || (window.URL && URL.revokeObjectURL && URL) || (window.webkitURL && webkitURL),\n\n\t\tBlob = window.Blob,\n\t\tFile = window.File,\n\t\tFileReader = window.FileReader,\n\t\tFormData = window.FormData,\n\n\n\t\tXMLHttpRequest = window.XMLHttpRequest,\n\t\tjQuery = window.jQuery,\n\n\t\thtml5 =    !!(File && (FileReader && (window.Uint8Array || FormData || XMLHttpRequest.prototype.sendAsBinary)))\n\t\t\t\t&& !(safari && /windows/i.test(userAgent) && !iemobile), // BugFix: https://github.com/mailru/FileAPI/issues/25\n\n\t\tcors = html5 && ('withCredentials' in (new XMLHttpRequest)),\n\n\t\tchunked = html5 && !!Blob && !!(Blob.prototype.webkitSlice || Blob.prototype.mozSlice || Blob.prototype.slice),\n\n\t\tnormalize = ('' + ''.normalize).indexOf('[native code]') > 0,\n\n\t\t// https://github.com/blueimp/JavaScript-Canvas-to-Blob\n\t\tdataURLtoBlob = window.dataURLtoBlob,\n\n\n\t\t_rimg = /img/i,\n\t\t_rcanvas = /canvas/i,\n\t\t_rimgcanvas = /img|canvas/i,\n\t\t_rinput = /input/i,\n\t\t_rdata = /^data:[^,]+,/,\n\n\t\t_toString = {}.toString,\n\t\t_supportConsoleLog,\n\t\t_supportConsoleLogApply,\n\n\n\t\tMath = window.Math,\n\n\t\t_SIZE_CONST = function (pow){\n\t\t\tpow = new window.Number(Math.pow(1024, pow));\n\t\t\tpow.from = function (sz){ return Math.round(sz * this); };\n\t\t\treturn\tpow;\n\t\t},\n\n\t\t_elEvents = {}, // element event listeners\n\t\t_infoReader = [], // list of file info processors\n\n\t\t_readerEvents = 'abort progress error load loadend',\n\t\t_xhrPropsExport = 'status statusText readyState response responseXML responseText responseBody'.split(' '),\n\n\t\tcurrentTarget = 'currentTarget', // for minimize\n\t\tpreventDefault = 'preventDefault', // and this too\n\n\t\t_isArray = function (ar) {\n\t\t\treturn\tar && ('length' in ar);\n\t\t},\n\n\t\t/**\n\t\t * Iterate over a object or array\n\t\t */\n\t\t_each = function (obj, fn, ctx){\n\t\t\tif( obj ){\n\t\t\t\tif( _isArray(obj) ){\n\t\t\t\t\tfor( var i = 0, n = obj.length; i < n; i++ ){\n\t\t\t\t\t\tif( i in obj ){\n\t\t\t\t\t\t\tfn.call(ctx, obj[i], i, obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor( var key in obj ){\n\t\t\t\t\t\tif( obj.hasOwnProperty(key) ){\n\t\t\t\t\t\t\tfn.call(ctx, obj[key], key, obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Merge the contents of two or more objects together into the first object\n\t\t */\n\t\t_extend = function (dst){\n\t\t\tvar args = arguments, i = 1, _ext = function (val, key){ dst[key] = val; };\n\t\t\tfor( ; i < args.length; i++ ){\n\t\t\t\t_each(args[i], _ext);\n\t\t\t}\n\t\t\treturn  dst;\n\t\t},\n\n\t\t/**\n\t\t * Add event listener\n\t\t */\n\t\t_on = function (el, type, fn){\n\t\t\tif( el ){\n\t\t\t\tvar uid = api.uid(el);\n\n\t\t\t\tif( !_elEvents[uid] ){\n\t\t\t\t\t_elEvents[uid] = {};\n\t\t\t\t}\n\n\t\t\t\tvar isFileReader = (FileReader && el) && (el instanceof FileReader);\n\t\t\t\t_each(type.split(/\\s+/), function (type){\n\t\t\t\t\tif( jQuery && !isFileReader){\n\t\t\t\t\t\tjQuery.event.add(el, type, fn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( !_elEvents[uid][type] ){\n\t\t\t\t\t\t\t_elEvents[uid][type] = [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_elEvents[uid][type].push(fn);\n\n\t\t\t\t\t\tif( el.addEventListener ){ el.addEventListener(type, fn, false); }\n\t\t\t\t\t\telse if( el.attachEvent ){ el.attachEvent('on'+type, fn); }\n\t\t\t\t\t\telse { el['on'+type] = fn; }\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Remove event listener\n\t\t */\n\t\t_off = function (el, type, fn){\n\t\t\tif( el ){\n\t\t\t\tvar uid = api.uid(el), events = _elEvents[uid] || {};\n\n\t\t\t\tvar isFileReader = (FileReader && el) && (el instanceof FileReader);\n\t\t\t\t_each(type.split(/\\s+/), function (type){\n\t\t\t\t\tif( jQuery && !isFileReader){\n\t\t\t\t\t\tjQuery.event.remove(el, type, fn);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar fns = events[type] || [], i = fns.length;\n\n\t\t\t\t\t\twhile( i-- ){\n\t\t\t\t\t\t\tif( fns[i] === fn ){\n\t\t\t\t\t\t\t\tfns.splice(i, 1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( el.addEventListener ){ el.removeEventListener(type, fn, false); }\n\t\t\t\t\t\telse if( el.detachEvent ){ el.detachEvent('on'+type, fn); }\n\t\t\t\t\t\telse { el['on'+type] = null; }\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\n\t\t_one = function(el, type, fn){\n\t\t\t_on(el, type, function _(evt){\n\t\t\t\t_off(el, type, _);\n\t\t\t\tfn(evt);\n\t\t\t});\n\t\t},\n\n\n\t\t_fixEvent = function (evt){\n\t\t\tif( !evt.target ){ evt.target = window.event && window.event.srcElement || document; }\n\t\t\tif( evt.target.nodeType === 3 ){ evt.target = evt.target.parentNode; }\n\t\t\treturn  evt;\n\t\t},\n\n\n\t\t_supportInputAttr = function (attr){\n\t\t\tvar input = document.createElement('input');\n\t\t\tinput.setAttribute('type', \"file\");\n\t\t\treturn attr in input;\n\t\t},\n\n\n\t\t/**\n\t\t * FileAPI (core object)\n\t\t */\n\t\tapi = {\n\t\t\tversion: '2.0.25',\n\n\t\t\tcors: false,\n\t\t\thtml5: true,\n\t\t\tmedia: false,\n\t\t\tformData: true,\n\t\t\tmultiPassResize: true,\n\t\t\tinsecureChrome: insecureChrome,\n\n\t\t\tdebug: false,\n\t\t\tpingUrl: false,\n\t\t\tmultiFlash: false,\n\t\t\tflashAbortTimeout: 0,\n\t\t\twithCredentials: true,\n\n\t\t\tstaticPath: './dist/',\n\n\t\t\tflashUrl: 0, // @default: './FileAPI.flash.swf'\n\t\t\tflashImageUrl: 0, // @default: './FileAPI.flash.image.swf'\n\n\t\t\tpostNameConcat: function (name, idx){\n\t\t\t\treturn\tname + (idx != null ? '['+ idx +']' : '');\n\t\t\t},\n\n\t\t\text2mime: {\n\t\t\t\t  jpg:\t'image/jpeg'\n\t\t\t\t, tif:\t'image/tiff'\n\t\t\t\t, txt:\t'text/plain'\n\t\t\t},\n\n\t\t\t// Fallback for flash\n\t\t\taccept: {\n\t\t\t\t  'image/*': 'art bm bmp dwg dxf cbr cbz fif fpx gif ico iefs jfif jpe jpeg jpg jps jut mcf nap nif pbm pcx pgm pict pm png pnm qif qtif ras rast rf rp svf tga tif tiff xbm xbm xpm xwd'\n\t\t\t\t, 'audio/*': 'm4a flac aac rm mpa wav wma ogg mp3 mp2 m3u mod amf dmf dsm far gdm imf it m15 med okt s3m stm sfx ult uni xm sid ac3 dts cue aif aiff wpl ape mac mpc mpp shn wv nsf spc gym adplug adx dsp adp ymf ast afc hps xs'\n\t\t\t\t, 'video/*': 'm4v 3gp nsv ts ty strm rm rmvb m3u ifo mov qt divx xvid bivx vob nrg img iso pva wmv asf asx ogm m2v avi bin dat dvr-ms mpg mpeg mp4 mkv avc vp3 svq3 nuv viv dv fli flv wpl'\n\t\t\t},\n\n\t\t\tuploadRetry : 0,\n\t\t\tnetworkDownRetryTimeout : 5000, // milliseconds, don't flood when network is down\n\n\t\t\tchunkSize : 0,\n\t\t\tchunkUploadRetry : 0,\n\t\t\tchunkNetworkDownRetryTimeout : 2000, // milliseconds, don't flood when network is down\n\n\t\t\tKB: _SIZE_CONST(1),\n\t\t\tMB: _SIZE_CONST(2),\n\t\t\tGB: _SIZE_CONST(3),\n\t\t\tTB: _SIZE_CONST(4),\n\n\t\t\tEMPTY_PNG: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2NkAAIAAAoAAggA9GkAAAAASUVORK5CYII=',\n\n\t\t\texpando: 'fileapi' + (new Date).getTime(),\n\n\t\t\tuid: function (obj){\n\t\t\t\treturn\tobj\n\t\t\t\t\t? (obj[api.expando] = obj[api.expando] || api.uid())\n\t\t\t\t\t: (++gid, api.expando + gid)\n\t\t\t\t;\n\t\t\t},\n\n\t\t\tlog: function (){\n\t\t\t\tif( api.debug && _supportConsoleLog ){\n\t\t\t\t\tif( _supportConsoleLogApply ){\n\t\t\t\t\t\tconsole.log.apply(console, arguments);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tconsole.log([].join.call(arguments, ' '));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Create new image\n\t\t\t *\n\t\t\t * @param {String} [src]\n\t\t\t * @param {Function} [fn]   1. error -- boolean, 2. img -- Image element\n\t\t\t * @returns {HTMLElement}\n\t\t\t */\n\t\t\tnewImage: function (src, fn){\n\t\t\t\tvar img = document.createElement('img');\n\t\t\t\tif( fn ){\n\t\t\t\t\tapi.event.one(img, 'error load', function (evt){\n\t\t\t\t\t\tfn(evt.type == 'error', img);\n\t\t\t\t\t\timg = null;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\timg.src = src;\n\t\t\t\treturn\timg;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Get XHR\n\t\t\t * @returns {XMLHttpRequest}\n\t\t\t */\n\t\t\tgetXHR: function (){\n\t\t\t\tvar xhr;\n\n\t\t\t\tif( XMLHttpRequest ){\n\t\t\t\t\txhr = new XMLHttpRequest;\n\t\t\t\t}\n\t\t\t\telse if( window.ActiveXObject ){\n\t\t\t\t\ttry {\n\t\t\t\t\t\txhr = new ActiveXObject('MSXML2.XMLHttp.3.0');\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\txhr = new ActiveXObject('Microsoft.XMLHTTP');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn  xhr;\n\t\t\t},\n\n\t\t\tisArray: _isArray,\n\n\t\t\tsupport: {\n\t\t\t\tdnd:     cors && ('ondrop' in document.createElement('div')),\n\t\t\t\tcors:    cors,\n\t\t\t\thtml5:   html5,\n\t\t\t\tchunked: chunked,\n\t\t\t\tdataURI: true,\n\t\t\t\taccept:   _supportInputAttr('accept'),\n\t\t\t\tmultiple: _supportInputAttr('multiple')\n\t\t\t},\n\n\t\t\tevent: {\n\t\t\t\t  on: _on\n\t\t\t\t, off: _off\n\t\t\t\t, one: _one\n\t\t\t\t, fix: _fixEvent\n\t\t\t},\n\n\n\t\t\tthrottle: function(fn, delay) {\n\t\t\t\tvar id, args;\n\n\t\t\t\treturn function _throttle(){\n\t\t\t\t\targs = arguments;\n\n\t\t\t\t\tif( !id ){\n\t\t\t\t\t\tfn.apply(window, args);\n\t\t\t\t\t\tid = setTimeout(function (){\n\t\t\t\t\t\t\tid = 0;\n\t\t\t\t\t\t\tfn.apply(window, args);\n\t\t\t\t\t\t}, delay);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\n\n\t\t\tF: function (){},\n\n\n\t\t\tparseJSON: function (str){\n\t\t\t\tvar json;\n\t\t\t\tif( window.JSON && JSON.parse ){\n\t\t\t\t\tjson = JSON.parse(str);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjson = (new Function('return ('+str.replace(/([\\r\\n])/g, '\\\\$1')+');'))();\n\t\t\t\t}\n\t\t\t\treturn json;\n\t\t\t},\n\n\n\t\t\ttrim: function (str){\n\t\t\t\tstr = String(str);\n\t\t\t\treturn\tstr.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Simple Defer\n\t\t\t * @return\t{Object}\n\t\t\t */\n\t\t\tdefer: function (){\n\t\t\t\tvar\n\t\t\t\t\t  list = []\n\t\t\t\t\t, result\n\t\t\t\t\t, error\n\t\t\t\t\t, defer = {\n\t\t\t\t\t\tresolve: function (err, res){\n\t\t\t\t\t\t\tdefer.resolve = noop;\n\t\t\t\t\t\t\terror\t= err || false;\n\t\t\t\t\t\t\tresult\t= res;\n\n\t\t\t\t\t\t\twhile( res = list.shift() ){\n\t\t\t\t\t\t\t\tres(error, result);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tthen: function (fn){\n\t\t\t\t\t\t\tif( error !== undef ){\n\t\t\t\t\t\t\t\tfn(error, result);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlist.push(fn);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn\tdefer;\n\t\t\t},\n\n\t\t\tqueue: function (fn){\n\t\t\t\tvar\n\t\t\t\t\t  _idx = 0\n\t\t\t\t\t, _length = 0\n\t\t\t\t\t, _fail = false\n\t\t\t\t\t, _end = false\n\t\t\t\t\t, queue = {\n\t\t\t\t\t\tinc: function (){\n\t\t\t\t\t\t\t_length++;\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tnext: function (){\n\t\t\t\t\t\t\t_idx++;\n\t\t\t\t\t\t\tsetTimeout(queue.check, 0);\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tcheck: function (){\n\t\t\t\t\t\t\t(_idx >= _length) && !_fail && queue.end();\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tisFail: function (){\n\t\t\t\t\t\t\treturn _fail;\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tfail: function (){\n\t\t\t\t\t\t\t!_fail && fn(_fail = true);\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tend: function (){\n\t\t\t\t\t\t\tif( !_end ){\n\t\t\t\t\t\t\t\t_end = true;\n\t\t\t\t\t\t\t\tfn();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t;\n\t\t\t\treturn queue;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * For each object\n\t\t\t *\n\t\t\t * @param\t{Object|Array}\tobj\n\t\t\t * @param\t{Function}\t\tfn\n\t\t\t * @param\t{*}\t\t\t\t[ctx]\n\t\t\t */\n\t\t\teach: _each,\n\n\n\t\t\t/**\n\t\t\t * Async for\n\t\t\t * @param {Array} array\n\t\t\t * @param {Function} callback\n\t\t\t */\n\t\t\tafor: function (array, callback){\n\t\t\t\tvar i = 0, n = array.length;\n\n\t\t\t\tif( _isArray(array) && n-- ){\n\t\t\t\t\t(function _next(){\n\t\t\t\t\t\tcallback(n != i && _next, array[i], i++);\n\t\t\t\t\t})();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcallback(false);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Merge the contents of two or more objects together into the first object\n\t\t\t *\n\t\t\t * @param\t{Object}\tdst\n\t\t\t * @return\t{Object}\n\t\t\t */\n\t\t\textend: _extend,\n\n\n\t\t\t/**\n\t\t\t * Is file?\n\t\t\t * @param  {File}  file\n\t\t\t * @return {Boolean}\n\t\t\t */\n\t\t\tisFile: function (file){\n\t\t\t\treturn _toString.call(file) === '[object File]';\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Is blob?\n\t\t\t * @param   {Blob}  blob\n\t\t\t * @returns {Boolean}\n\t\t\t */\n\t\t\tisBlob: function (blob) {\n\t\t\t\treturn this.isFile(blob) || (_toString.call(blob) === '[object Blob]');\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Is canvas element\n\t\t\t *\n\t\t\t * @param\t{HTMLElement}\tel\n\t\t\t * @return\t{Boolean}\n\t\t\t */\n\t\t\tisCanvas: function (el){\n\t\t\t\treturn\tel && _rcanvas.test(el.nodeName);\n\t\t\t},\n\n\n\t\t\tgetFilesFilter: function (filter){\n\t\t\t\tfilter = typeof filter == 'string' ? filter : (filter.getAttribute && filter.getAttribute('accept') || '');\n\t\t\t\treturn\tfilter ? new RegExp('('+ filter.replace(/\\./g, '\\\\.').replace(/,/g, '|') +')$', 'i') : /./;\n\t\t\t},\n\n\n\n\t\t\t/**\n\t\t\t * Read as DataURL\n\t\t\t *\n\t\t\t * @param {File|Element} file\n\t\t\t * @param {Function} fn\n\t\t\t */\n\t\t\treadAsDataURL: function (file, fn){\n\t\t\t\tif( api.isCanvas(file) ){\n\t\t\t\t\t_emit(file, fn, 'load', api.toDataURL(file));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_readAs(file, fn, 'DataURL');\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Read as Binary string\n\t\t\t *\n\t\t\t * @param {File} file\n\t\t\t * @param {Function} fn\n\t\t\t */\n\t\t\treadAsBinaryString: function (file, fn){\n\t\t\t\tif( _hasSupportReadAs('BinaryString') ){\n\t\t\t\t\t_readAs(file, fn, 'BinaryString');\n\t\t\t\t} else {\n\t\t\t\t\t// Hello IE10!\n\t\t\t\t\t_readAs(file, function (evt){\n\t\t\t\t\t\tif( evt.type == 'load' ){\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t// dataURL -> binaryString\n\t\t\t\t\t\t\t\tevt.result = api.toBinaryString(evt.result);\n\t\t\t\t\t\t\t} catch (e){\n\t\t\t\t\t\t\t\tevt.type = 'error';\n\t\t\t\t\t\t\t\tevt.message = e.toString();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfn(evt);\n\t\t\t\t\t}, 'DataURL');\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Read as ArrayBuffer\n\t\t\t *\n\t\t\t * @param {File} file\n\t\t\t * @param {Function} fn\n\t\t\t */\n\t\t\treadAsArrayBuffer: function(file, fn){\n\t\t\t\t_readAs(file, fn, 'ArrayBuffer');\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Read as text\n\t\t\t *\n\t\t\t * @param {File} file\n\t\t\t * @param {String} encoding\n\t\t\t * @param {Function} [fn]\n\t\t\t */\n\t\t\treadAsText: function(file, encoding, fn){\n\t\t\t\tif( !fn ){\n\t\t\t\t\tfn\t= encoding;\n\t\t\t\t\tencoding = 'utf-8';\n\t\t\t\t}\n\n\t\t\t\t_readAs(file, fn, 'Text', encoding);\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Convert image or canvas to DataURL\n\t\t\t *\n\t\t\t * @param   {Element}  el      Image or Canvas element\n\t\t\t * @param   {String}   [type]  mime-type\n\t\t\t * @return  {String}\n\t\t\t */\n\t\t\ttoDataURL: function (el, type){\n\t\t\t\tif( typeof el == 'string' ){\n\t\t\t\t\treturn  el;\n\t\t\t\t}\n\t\t\t\telse if( el.toDataURL ){\n\t\t\t\t\treturn  el.toDataURL(type || 'image/png');\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Canvert string, image or canvas to binary string\n\t\t\t *\n\t\t\t * @param   {String|Element} val\n\t\t\t * @return  {String}\n\t\t\t */\n\t\t\ttoBinaryString: function (val){\n\t\t\t\treturn  window.atob(api.toDataURL(val).replace(_rdata, ''));\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Read file or DataURL as ImageElement\n\t\t\t *\n\t\t\t * @param\t{File|String}\tfile\n\t\t\t * @param\t{Function}\t\tfn\n\t\t\t * @param\t{Boolean}\t\t[progress]\n\t\t\t */\n\t\t\treadAsImage: function (file, fn, progress){\n\t\t\t\tif( api.isBlob(file) ){\n\t\t\t\t\tif( apiURL ){\n\t\t\t\t\t\t/** @namespace apiURL.createObjectURL */\n\t\t\t\t\t\tvar data = apiURL.createObjectURL(file);\n\t\t\t\t\t\tif( data === undef ){\n\t\t\t\t\t\t\t_emit(file, fn, 'error');\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tapi.readAsImage(data, fn, progress);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tapi.readAsDataURL(file, function (evt){\n\t\t\t\t\t\t\tif( evt.type == 'load' ){\n\t\t\t\t\t\t\t\tapi.readAsImage(evt.result, fn, progress);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if( progress || evt.type == 'error' ){\n\t\t\t\t\t\t\t\t_emit(file, fn, evt, null, { loaded: evt.loaded, total: evt.total });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( api.isCanvas(file) ){\n\t\t\t\t\t_emit(file, fn, 'load', file);\n\t\t\t\t}\n\t\t\t\telse if( _rimg.test(file.nodeName) ){\n\t\t\t\t\tif( file.complete ){\n\t\t\t\t\t\t_emit(file, fn, 'load', file);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar events = 'error abort load';\n\t\t\t\t\t\t_one(file, events, function _fn(evt){\n\t\t\t\t\t\t\tif( evt.type == 'load' && apiURL ){\n\t\t\t\t\t\t\t\t/** @namespace apiURL.revokeObjectURL */\n\t\t\t\t\t\t\t\tapiURL.revokeObjectURL(file.src);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t_off(file, events, _fn);\n\t\t\t\t\t\t\t_emit(file, fn, evt, file);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( file.iframe ){\n\t\t\t\t\t_emit(file, fn, { type: 'error' });\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Created image\n\t\t\t\t\tvar img = api.newImage(file.dataURL || file);\n\t\t\t\t\tapi.readAsImage(img, fn, progress);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Make file by name\n\t\t\t *\n\t\t\t * @param\t{String}\tname\n\t\t\t * @return\t{Array}\n\t\t\t */\n\t\t\tcheckFileObj: function (name){\n\t\t\t\tvar file = {}, accept = api.accept;\n\n\t\t\t\tif( typeof name == 'object' ){\n\t\t\t\t\tfile = name;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfile.name = (name + '').split(/\\\\|\\//g).pop();\n\t\t\t\t}\n\n\t\t\t\tif( file.type == null ){\n\t\t\t\t\tfile.type = file.name.split('.').pop();\n\t\t\t\t}\n\n\t\t\t\t_each(accept, function (ext, type){\n\t\t\t\t\text = new RegExp(ext.replace(/\\s/g, '|'), 'i');\n\t\t\t\t\tif( ext.test(file.type) || api.ext2mime[file.type] ){\n\t\t\t\t\t\tfile.type = api.ext2mime[file.type] || (type.split('/')[0] +'/'+ file.type);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn\tfile;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Get drop files\n\t\t\t *\n\t\t\t * @param\t{Event}\tevt\n\t\t\t * @param\t{Function} callback\n\t\t\t */\n\t\t\tgetDropFiles: function (evt, callback){\n\t\t\t\tvar\n\t\t\t\t\t  files = []\n\t\t\t\t\t, all = []\n\t\t\t\t\t, items\n\t\t\t\t\t, dataTransfer = _getDataTransfer(evt)\n\t\t\t\t\t, transFiles = dataTransfer.files\n\t\t\t\t\t, transItems = dataTransfer.items\n\t\t\t\t\t, entrySupport = _isArray(transItems) && transItems[0] && _getAsEntry(transItems[0])\n\t\t\t\t\t, queue = api.queue(function (){ callback(files, all); })\n\t\t\t\t;\n\n\t\t\t\tif( entrySupport ){\n\t\t\t\t\tif( normalize && transFiles ){\n\t\t\t\t\t\tvar\n\t\t\t\t\t\t\ti = transFiles.length\n\t\t\t\t\t\t\t, file\n\t\t\t\t\t\t\t, entry\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\titems = new Array(i);\n\t\t\t\t\t\twhile( i-- ){\n\t\t\t\t\t\t\tfile = transFiles[i];\n\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tentry = _getAsEntry(transItems[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch( err ){\n\t\t\t\t\t\t\t\tapi.log('[err] getDropFiles: ', err);\n\t\t\t\t\t\t\t\tentry = null;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif( _isEntry(entry) ){\n\t\t\t\t\t\t\t\t// OSX filesystems use Unicode Normalization Form D (NFD),\n\t\t\t\t\t\t\t\t// and entry.file(…) can't read the files with the same names\n\t\t\t\t\t\t\t\tif( entry.isDirectory || (entry.isFile && file.name == file.name.normalize('NFC')) ){\n\t\t\t\t\t\t\t\t\titems[i] = entry;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\titems[i] = file;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\titems[i] = file;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\titems = transItems;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\titems = transFiles;\n\t\t\t\t}\n\n\t\t\t\t_each(items || [], function (item){\n\t\t\t\t\tqueue.inc();\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif( entrySupport && _isEntry(item) ){\n\t\t\t\t\t\t\t_readEntryAsFiles(item, function (err, entryFiles, allEntries){\n\t\t\t\t\t\t\t\tif( err ){\n\t\t\t\t\t\t\t\t\tapi.log('[err] getDropFiles:', err);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfiles.push.apply(files, entryFiles);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tall.push.apply(all, allEntries);\n\n\t\t\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t_isRegularFile(item, function (yes, err){\n\t\t\t\t\t\t\t\tif( yes ){\n\t\t\t\t\t\t\t\t\tfiles.push(item);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\titem.error = err;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tall.push(item);\n\n\t\t\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch( err ){\n\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t\tapi.log('[err] getDropFiles: ', err);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tqueue.check();\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Get file list\n\t\t\t *\n\t\t\t * @param\t{HTMLInputElement|Event}\tinput\n\t\t\t * @param\t{String|Function}\t[filter]\n\t\t\t * @param\t{Function}\t\t\t[callback]\n\t\t\t * @return\t{Array|Null}\n\t\t\t */\n\t\t\tgetFiles: function (input, filter, callback){\n\t\t\t\tvar files = [];\n\n\t\t\t\tif( callback ){\n\t\t\t\t\tapi.filterFiles(api.getFiles(input), filter, callback);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif( input.jquery ){\n\t\t\t\t\t// jQuery object\n\t\t\t\t\tinput.each(function (){\n\t\t\t\t\t\tfiles = files.concat(api.getFiles(this));\n\t\t\t\t\t});\n\t\t\t\t\tinput\t= files;\n\t\t\t\t\tfiles\t= [];\n\t\t\t\t}\n\n\t\t\t\tif( typeof filter == 'string' ){\n\t\t\t\t\tfilter\t= api.getFilesFilter(filter);\n\t\t\t\t}\n\n\t\t\t\tif( input.originalEvent ){\n\t\t\t\t\t// jQuery event\n\t\t\t\t\tinput = _fixEvent(input.originalEvent);\n\t\t\t\t}\n\t\t\t\telse if( input.srcElement ){\n\t\t\t\t\t// IE Event\n\t\t\t\t\tinput = _fixEvent(input);\n\t\t\t\t}\n\n\n\t\t\t\tif( input.dataTransfer ){\n\t\t\t\t\t// Drag'n'Drop\n\t\t\t\t\tinput = input.dataTransfer;\n\t\t\t\t}\n\t\t\t\telse if( input.target ){\n\t\t\t\t\t// Event\n\t\t\t\t\tinput = input.target;\n\t\t\t\t}\n\n\t\t\t\tif( input.files ){\n\t\t\t\t\t// Input[type=\"file\"]\n\t\t\t\t\tfiles = input.files;\n\n\t\t\t\t\tif( !html5 ){\n\t\t\t\t\t\t// Partial support for file api\n\t\t\t\t\t\tfiles[0].blob\t= input;\n\t\t\t\t\t\tfiles[0].iframe\t= true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( !html5 && isInputFile(input) ){\n\t\t\t\t\tif( api.trim(input.value) ){\n\t\t\t\t\t\tfiles = [api.checkFileObj(input.value)];\n\t\t\t\t\t\tfiles[0].blob   = input;\n\t\t\t\t\t\tfiles[0].iframe = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( _isArray(input) ){\n\t\t\t\t\tfiles\t= input;\n\t\t\t\t}\n\n\t\t\t\treturn\tapi.filter(files, function (file){ return !filter || filter.test(file.name); });\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Get total file size\n\t\t\t * @param\t{Array}\tfiles\n\t\t\t * @return\t{Number}\n\t\t\t */\n\t\t\tgetTotalSize: function (files){\n\t\t\t\tvar size = 0, i = files && files.length;\n\t\t\t\twhile( i-- ){\n\t\t\t\t\tsize += files[i].size;\n\t\t\t\t}\n\t\t\t\treturn\tsize;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Get image information\n\t\t\t *\n\t\t\t * @param\t{File}\t\tfile\n\t\t\t * @param\t{Function}\tfn\n\t\t\t */\n\t\t\tgetInfo: function (file, fn){\n\t\t\t\tvar info = {}, readers = _infoReader.concat();\n\n\t\t\t\tif( api.isBlob(file) ){\n\t\t\t\t\t(function _next(){\n\t\t\t\t\t\tvar reader = readers.shift();\n\t\t\t\t\t\tif( reader ){\n\t\t\t\t\t\t\tif( reader.test(file.type) ){\n\t\t\t\t\t\t\t\treader(file, function (err, res){\n\t\t\t\t\t\t\t\t\tif( err ){\n\t\t\t\t\t\t\t\t\t\tfn(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t_extend(info, res);\n\t\t\t\t\t\t\t\t\t\t_next();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t_next();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tfn(false, info);\n\t\t\t\t\t\t}\n\t\t\t\t\t})();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfn('not_support_info', info);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Add information reader\n\t\t\t *\n\t\t\t * @param {RegExp} mime\n\t\t\t * @param {Function} fn\n\t\t\t */\n\t\t\taddInfoReader: function (mime, fn){\n\t\t\t\tfn.test = function (type){ return mime.test(type); };\n\t\t\t\t_infoReader.push(fn);\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Filter of array\n\t\t\t *\n\t\t\t * @param\t{Array}\t\tinput\n\t\t\t * @param\t{Function}\tfn\n\t\t\t * @return\t{Array}\n\t\t\t */\n\t\t\tfilter: function (input, fn){\n\t\t\t\tvar result = [], i = 0, n = input.length, val;\n\n\t\t\t\tfor( ; i < n; i++ ){\n\t\t\t\t\tif( i in input ){\n\t\t\t\t\t\tval = input[i];\n\t\t\t\t\t\tif( fn.call(val, val, i, input) ){\n\t\t\t\t\t\t\tresult.push(val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn\tresult;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Filter files\n\t\t\t *\n\t\t\t * @param\t{Array}\t\tfiles\n\t\t\t * @param\t{Function}\teachFn\n\t\t\t * @param\t{Function}\tresultFn\n\t\t\t */\n\t\t\tfilterFiles: function (files, eachFn, resultFn){\n\t\t\t\tif( files.length ){\n\t\t\t\t\t// HTML5 or Flash\n\t\t\t\t\tvar queue = files.concat(), file, result = [], deleted = [];\n\n\t\t\t\t\t(function _next(){\n\t\t\t\t\t\tif( queue.length ){\n\t\t\t\t\t\t\tfile = queue.shift();\n\t\t\t\t\t\t\tapi.getInfo(file, function (err, info){\n\t\t\t\t\t\t\t\t(eachFn(file, err ? false : info) ? result : deleted).push(file);\n\t\t\t\t\t\t\t\t_next();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tresultFn(result, deleted);\n\t\t\t\t\t\t}\n\t\t\t\t\t})();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresultFn([], files);\n\t\t\t\t}\n\t\t\t},\n\n\n\t\t\tupload: function (options){\n\t\t\t\toptions = _extend({\n\t\t\t\t\t  jsonp: 'callback'\n\t\t\t\t\t, prepare: api.F\n\t\t\t\t\t, beforeupload: api.F\n\t\t\t\t\t, upload: api.F\n\t\t\t\t\t, fileupload: api.F\n\t\t\t\t\t, fileprogress: api.F\n\t\t\t\t\t, filecomplete: api.F\n\t\t\t\t\t, progress: api.F\n\t\t\t\t\t, complete: api.F\n\t\t\t\t\t, pause: api.F\n\t\t\t\t\t, imageOriginal: true\n\t\t\t\t\t, chunkSize: api.chunkSize\n\t\t\t\t\t, chunkUploadRetry: api.chunkUploadRetry\n\t\t\t\t\t, uploadRetry: api.uploadRetry\n\t\t\t\t}, options);\n\n\n\t\t\t\tif( options.imageAutoOrientation && !options.imageTransform ){\n\t\t\t\t\toptions.imageTransform = { rotate: 'auto' };\n\t\t\t\t}\n\n\n\t\t\t\tvar\n\t\t\t\t\t  proxyXHR = new api.XHR(options)\n\t\t\t\t\t, dataArray = this._getFilesDataArray(options.files)\n\t\t\t\t\t, _this = this\n\t\t\t\t\t, _total = 0\n\t\t\t\t\t, _loaded = 0\n\t\t\t\t\t, _nextFile\n\t\t\t\t\t, _complete = false\n\t\t\t\t;\n\n\n\t\t\t\t// calc total size\n\t\t\t\t_each(dataArray, function (data){\n\t\t\t\t\t_total += data.size;\n\t\t\t\t});\n\n\t\t\t\t// Array of files\n\t\t\t\tproxyXHR.files = [];\n\t\t\t\t_each(dataArray, function (data){\n\t\t\t\t\tproxyXHR.files.push(data.file);\n\t\t\t\t});\n\n\t\t\t\t// Set upload status props\n\t\t\t\tproxyXHR.total\t= _total;\n\t\t\t\tproxyXHR.loaded\t= 0;\n\t\t\t\tproxyXHR.filesLeft = dataArray.length;\n\n\t\t\t\t// emit \"beforeupload\"  event\n\t\t\t\toptions.beforeupload(proxyXHR, options);\n\n\t\t\t\t// Upload by file\n\t\t\t\t_nextFile = function (){\n\t\t\t\t\tvar\n\t\t\t\t\t\t  data = dataArray.shift()\n\t\t\t\t\t\t, _file = data && data.file\n\t\t\t\t\t\t, _fileLoaded = false\n\t\t\t\t\t\t, _fileOptions = _simpleClone(options)\n\t\t\t\t\t;\n\n\t\t\t\t\tproxyXHR.filesLeft = dataArray.length;\n\n\t\t\t\t\tif( _file && _file.name === api.expando ){\n\t\t\t\t\t\t_file = null;\n\t\t\t\t\t\tapi.log('[warn] FileAPI.upload() — called without files');\n\t\t\t\t\t}\n\n\t\t\t\t\tif( ( proxyXHR.statusText != 'abort' || proxyXHR.current ) && data ){\n\t\t\t\t\t\t// Mark active job\n\t\t\t\t\t\t_complete = false;\n\n\t\t\t\t\t\t// Set current upload file\n\t\t\t\t\t\tproxyXHR.currentFile = _file;\n\n\t\t\t\t\t\t// Prepare file options\n\t\t\t\t\t\tif (_file && options.prepare(_file, _fileOptions) === false) {\n\t\t\t\t\t\t\t_nextFile.call(_this);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_fileOptions.file = _file;\n\n\t\t\t\t\t\t_this._getFormData(_fileOptions, data, function (form){\n\t\t\t\t\t\t\tif( !_loaded ){\n\t\t\t\t\t\t\t\t// emit \"upload\" event\n\t\t\t\t\t\t\t\toptions.upload(proxyXHR, options);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar xhr = new api.XHR(_extend({}, _fileOptions, {\n\n\t\t\t\t\t\t\t\tupload: _file ? function (){\n\t\t\t\t\t\t\t\t\t// emit \"fileupload\" event\n\t\t\t\t\t\t\t\t\toptions.fileupload(_file, xhr, _fileOptions);\n\t\t\t\t\t\t\t\t} : noop,\n\n\t\t\t\t\t\t\t\tprogress: _file ? function (evt){\n\t\t\t\t\t\t\t\t\tif( !_fileLoaded ){\n\t\t\t\t\t\t\t\t\t\t// For ignore the double calls.\n\t\t\t\t\t\t\t\t\t\t_fileLoaded = (evt.loaded === evt.total);\n\n\t\t\t\t\t\t\t\t\t\t// emit \"fileprogress\" event\n\t\t\t\t\t\t\t\t\t\toptions.fileprogress({\n\t\t\t\t\t\t\t\t\t\t\t  type:   'progress'\n\t\t\t\t\t\t\t\t\t\t\t, total:  data.total = evt.total\n\t\t\t\t\t\t\t\t\t\t\t, loaded: data.loaded = evt.loaded\n\t\t\t\t\t\t\t\t\t\t}, _file, xhr, _fileOptions);\n\n\t\t\t\t\t\t\t\t\t\t// emit \"progress\" event\n\t\t\t\t\t\t\t\t\t\toptions.progress({\n\t\t\t\t\t\t\t\t\t\t\t  type:   'progress'\n\t\t\t\t\t\t\t\t\t\t\t, total:  _total\n\t\t\t\t\t\t\t\t\t\t\t, loaded: proxyXHR.loaded = (_loaded + data.size * (evt.loaded/evt.total)) || 0\n\t\t\t\t\t\t\t\t\t\t}, _file, xhr, _fileOptions);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} : noop,\n\n\t\t\t\t\t\t\t\tcomplete: function (err){\n\t\t\t\t\t\t\t\t\t_each(_xhrPropsExport, function (name){\n\t\t\t\t\t\t\t\t\t\tproxyXHR[name] = xhr[name];\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tif( _file ){\n\t\t\t\t\t\t\t\t\t\tdata.total = (data.total || data.size);\n\t\t\t\t\t\t\t\t\t\tdata.loaded\t= data.total;\n\n\t\t\t\t\t\t\t\t\t\tif( !err ) {\n\t\t\t\t\t\t\t\t\t\t\t// emulate 100% \"progress\"\n\t\t\t\t\t\t\t\t\t\t\tthis.progress(data);\n\n\t\t\t\t\t\t\t\t\t\t\t// fixed throttle event\n\t\t\t\t\t\t\t\t\t\t\t_fileLoaded = true;\n\n\t\t\t\t\t\t\t\t\t\t\t// bytes loaded\n\t\t\t\t\t\t\t\t\t\t\t_loaded += data.size; // data.size != data.total, it's desirable fix this\n\t\t\t\t\t\t\t\t\t\t\tproxyXHR.loaded = _loaded;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// emit \"filecomplete\" event\n\t\t\t\t\t\t\t\t\t\toptions.filecomplete(err, xhr, _file, _fileOptions);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// upload next file\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {_nextFile.call(_this);}, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})); // xhr\n\n\n\t\t\t\t\t\t\t// ...\n\t\t\t\t\t\t\tproxyXHR.abort = function (current){\n\t\t\t\t\t\t\t\tif (!current) { dataArray.length = 0; }\n\t\t\t\t\t\t\t\tthis.current = current;\n\t\t\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Start upload\n\t\t\t\t\t\t\txhr.send(form);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar successful = proxyXHR.status == 200 || proxyXHR.status == 201 || proxyXHR.status == 204;\n\t\t\t\t\t\toptions.complete(successful ? false : (proxyXHR.statusText || 'error'), proxyXHR, options);\n\t\t\t\t\t\t// Mark done state\n\t\t\t\t\t\t_complete = true;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\n\t\t\t\t// Next tick\n\t\t\t\tsetTimeout(_nextFile, 0);\n\n\n\t\t\t\t// Append more files to the existing request\n\t\t\t\t// first - add them to the queue head/tail\n\t\t\t\tproxyXHR.append = function (files, first) {\n\t\t\t\t\tfiles = api._getFilesDataArray([].concat(files));\n\n\t\t\t\t\t_each(files, function (data) {\n\t\t\t\t\t\t_total += data.size;\n\t\t\t\t\t\tproxyXHR.files.push(data.file);\n\t\t\t\t\t\tif (first) {\n\t\t\t\t\t\t\tdataArray.unshift(data);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdataArray.push(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tproxyXHR.statusText = \"\";\n\n\t\t\t\t\tif( _complete ){\n\t\t\t\t\t\t_nextFile.call(_this);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\n\t\t\t\t// Removes file from queue by file reference and returns it\n\t\t\t\tproxyXHR.remove = function (file) {\n\t\t\t\t    var i = dataArray.length, _file;\n\t\t\t\t    while( i-- ){\n\t\t\t\t\t\tif( dataArray[i].file == file ){\n\t\t\t\t\t\t\t_file = dataArray.splice(i, 1);\n\t\t\t\t\t\t\t_total -= _file.size;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn\t_file;\n\t\t\t\t};\n\n\t\t\t\treturn proxyXHR;\n\t\t\t},\n\n\n\t\t\t_getFilesDataArray: function (data){\n\t\t\t\tvar files = [], oFiles = {};\n\n\t\t\t\tif( isInputFile(data) ){\n\t\t\t\t\tvar tmp = api.getFiles(data);\n\t\t\t\t\toFiles[data.name || 'file'] = data.getAttribute('multiple') !== null ? tmp : tmp[0];\n\t\t\t\t}\n\t\t\t\telse if( _isArray(data) && isInputFile(data[0]) ){\n\t\t\t\t\t_each(data, function (input){\n\t\t\t\t\t\toFiles[input.name || 'file'] = api.getFiles(input);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\toFiles = data;\n\t\t\t\t}\n\n\t\t\t\t_each(oFiles, function add(file, name){\n\t\t\t\t\tif( _isArray(file) ){\n\t\t\t\t\t\t_each(file, function (file){\n\t\t\t\t\t\t\tadd(file, name);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if( file && (file.name || file.image) ){\n\t\t\t\t\t\tfiles.push({\n\t\t\t\t\t\t\t  name: name\n\t\t\t\t\t\t\t, file: file\n\t\t\t\t\t\t\t, size: file.size\n\t\t\t\t\t\t\t, total: file.size\n\t\t\t\t\t\t\t, loaded: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif( !files.length ){\n\t\t\t\t\t// Create fake `file` object\n\t\t\t\t\tfiles.push({ file: { name: api.expando } });\n\t\t\t\t}\n\n\t\t\t\treturn\tfiles;\n\t\t\t},\n\n\n\t\t\t_getFormData: function (options, data, fn){\n\t\t\t\tvar\n\t\t\t\t\t  file = data.file\n\t\t\t\t\t, name = data.name\n\t\t\t\t\t, filename = file.name\n\t\t\t\t\t, filetype = file.type\n\t\t\t\t\t, trans = api.support.transform && options.imageTransform\n\t\t\t\t\t, Form = new api.Form\n\t\t\t\t\t, queue = api.queue(function (){ fn(Form); })\n\t\t\t\t\t, isOrignTrans = trans && _isOriginTransform(trans)\n\t\t\t\t\t, postNameConcat = api.postNameConcat\n\t\t\t\t;\n\n\t\t\t\t// Append data\n\t\t\t\t_each(options.data, function add(val, name){\n\t\t\t\t\tif( typeof val == 'object' ){\n\t\t\t\t\t\t_each(val, function (v, i){\n\t\t\t\t\t\t\tadd(v, postNameConcat(name, i));\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tForm.append(name, val);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t(function _addFile(file/**Object*/){\n\t\t\t\t\tif( file.image ){ // This is a FileAPI.Image\n\t\t\t\t\t\tqueue.inc();\n\n\t\t\t\t\t\tfile.toData(function (err, image){\n\t\t\t\t\t\t\t// @todo: требует рефакторинга и обработки ошибки\n\t\t\t\t\t\t\tif (file.file) {\n\t\t\t\t\t\t\t\timage.type = file.file.type;\n\t\t\t\t\t\t\t\timage.quality = file.matrix.quality;\n\t\t\t\t\t\t\t\tfilename = file.file && file.file.name;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfilename = filename || (new Date).getTime()+'.png';\n\n\t\t\t\t\t\t\t_addFile(image);\n\t\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if( api.Image && trans && (/^image/.test(file.type) || _rimgcanvas.test(file.nodeName)) ){\n\t\t\t\t\t\tqueue.inc();\n\n\t\t\t\t\t\tif( isOrignTrans ){\n\t\t\t\t\t\t\t// Convert to array for transform function\n\t\t\t\t\t\t\ttrans = [trans];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tapi.Image.transform(file, trans, options.imageAutoOrientation, function (err, images){\n\t\t\t\t\t\t\tif( isOrignTrans && !err ){\n\t\t\t\t\t\t\t\tif( !dataURLtoBlob && !api.flashEngine ){\n\t\t\t\t\t\t\t\t\t// Canvas.toBlob or Flash not supported, use multipart\n\t\t\t\t\t\t\t\t\tForm.multipart = true;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tForm.append(name, images[0], filename,  trans[0].type || filetype);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar addOrigin = 0;\n\n\t\t\t\t\t\t\t\tif( !err ){\n\t\t\t\t\t\t\t\t\t_each(images, function (image, idx){\n\t\t\t\t\t\t\t\t\t\tif( !dataURLtoBlob && !api.flashEngine ){\n\t\t\t\t\t\t\t\t\t\t\tForm.multipart = true;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif( !trans[idx].postName ){\n\t\t\t\t\t\t\t\t\t\t\taddOrigin = 1;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tForm.append(trans[idx].postName || postNameConcat(name, idx), image, filename, trans[idx].type || filetype);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif( err || options.imageOriginal ){\n\t\t\t\t\t\t\t\t\tForm.append(postNameConcat(name, (addOrigin ? 'original' : null)), file, filename, filetype);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse if( filename !== api.expando ){\n\t\t\t\t\t\tForm.append(name, file, filename);\n\t\t\t\t\t}\n\t\t\t\t})(file);\n\n\t\t\t\tqueue.check();\n\t\t\t},\n\n\n\t\t\treset: function (inp, notRemove){\n\t\t\t\tvar parent, clone;\n\n\t\t\t\tif( jQuery ){\n\t\t\t\t\tclone = jQuery(inp).clone(true).insertBefore(inp).val('')[0];\n\t\t\t\t\tif( !notRemove ){\n\t\t\t\t\t\tjQuery(inp).remove();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tparent  = inp.parentNode;\n\t\t\t\t\tclone   = parent.insertBefore(inp.cloneNode(true), inp);\n\t\t\t\t\tclone.value = '';\n\n\t\t\t\t\tif( !notRemove ){\n\t\t\t\t\t\tparent.removeChild(inp);\n\t\t\t\t\t}\n\n\t\t\t\t\t_each(_elEvents[api.uid(inp)], function (fns, type){\n\t\t\t\t\t\t_each(fns, function (fn){\n\t\t\t\t\t\t\t_off(inp, type, fn);\n\t\t\t\t\t\t\t_on(clone, type, fn);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn  clone;\n\t\t\t},\n\n\n\t\t\t/**\n\t\t\t * Load remote file\n\t\t\t *\n\t\t\t * @param   {String}    url\n\t\t\t * @param   {Function}  fn\n\t\t\t * @return  {XMLHttpRequest}\n\t\t\t */\n\t\t\tload: function (url, fn){\n\t\t\t\tvar xhr = api.getXHR();\n\t\t\t\tif( xhr ){\n\t\t\t\t\txhr.open('GET', url, true);\n\n\t\t\t\t\tif( xhr.overrideMimeType ){\n\t\t\t\t        xhr.overrideMimeType('text/plain; charset=x-user-defined');\n\t\t\t\t\t}\n\n\t\t\t\t\t_on(xhr, 'progress', function (/**Event*/evt){\n\t\t\t\t\t\t/** @namespace evt.lengthComputable */\n\t\t\t\t\t\tif( evt.lengthComputable ){\n\t\t\t\t\t\t\tfn({ type: evt.type, loaded: evt.loaded, total: evt.total }, xhr);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\txhr.onreadystatechange = function(){\n\t\t\t\t\t\tif( xhr.readyState == 4 ){\n\t\t\t\t\t\t\txhr.onreadystatechange = null;\n\t\t\t\t\t\t\tif( xhr.status == 200 ){\n\t\t\t\t\t\t\t\turl = url.split('/');\n\t\t\t\t\t\t\t\t/** @namespace xhr.responseBody */\n\t\t\t\t\t\t\t\tvar file = {\n\t\t\t\t\t\t\t\t      name: url[url.length-1]\n\t\t\t\t\t\t\t\t\t, size: xhr.getResponseHeader('Content-Length')\n\t\t\t\t\t\t\t\t\t, type: xhr.getResponseHeader('Content-Type')\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tfile.dataURL = 'data:'+file.type+';base64,' + api.encode64(xhr.responseBody || xhr.responseText);\n\t\t\t\t\t\t\t\tfn({ type: 'load', result: file }, xhr);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tfn({ type: 'error' }, xhr);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t    }\n\t\t\t\t\t};\n\t\t\t\t    xhr.send(null);\n\t\t\t\t} else {\n\t\t\t\t\tfn({ type: 'error' });\n\t\t\t\t}\n\n\t\t\t\treturn  xhr;\n\t\t\t},\n\n\t\t\tencode64: function (str){\n\t\t\t\tvar b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=', outStr = '', i = 0;\n\n\t\t\t\tif( typeof str !== 'string' ){\n\t\t\t\t\tstr\t= String(str);\n\t\t\t\t}\n\n\t\t\t\twhile( i < str.length ){\n\t\t\t\t\t//all three \"& 0xff\" added below are there to fix a known bug\n\t\t\t\t\t//with bytes returned by xhr.responseText\n\t\t\t\t\tvar\n\t\t\t\t\t\t  byte1 = str.charCodeAt(i++) & 0xff\n\t\t\t\t\t\t, byte2 = str.charCodeAt(i++) & 0xff\n\t\t\t\t\t\t, byte3 = str.charCodeAt(i++) & 0xff\n\t\t\t\t\t\t, enc1 = byte1 >> 2\n\t\t\t\t\t\t, enc2 = ((byte1 & 3) << 4) | (byte2 >> 4)\n\t\t\t\t\t\t, enc3, enc4\n\t\t\t\t\t;\n\n\t\t\t\t\tif( isNaN(byte2) ){\n\t\t\t\t\t\tenc3 = enc4 = 64;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tenc3 = ((byte2 & 15) << 2) | (byte3 >> 6);\n\t\t\t\t\t\tenc4 = isNaN(byte3) ? 64 : byte3 & 63;\n\t\t\t\t\t}\n\n\t\t\t\t\toutStr += b64.charAt(enc1) + b64.charAt(enc2) + b64.charAt(enc3) + b64.charAt(enc4);\n\t\t\t\t}\n\n\t\t\t\treturn  outStr;\n\t\t\t}\n\n\t\t} // api\n\t;\n\n\n\tfunction _emit(target, fn, name, res, ext){\n\t\tvar evt = {\n\t\t\t  type:\t\tname.type || name\n\t\t\t, target:\ttarget\n\t\t\t, result:\tres\n\t\t};\n\t\t_extend(evt, ext);\n\t\tfn(evt);\n\t}\n\n\n\tfunction _hasSupportReadAs(method){\n\t\treturn\tFileReader && !!FileReader.prototype['readAs' + method];\n\t}\n\n\n\tfunction _readAs(file, fn, method, encoding){\n\t\tif( api.isBlob(file) && _hasSupportReadAs(method) ){\n\t\t\tvar Reader = new FileReader;\n\n\t\t\t// Add event listener\n\t\t\t_on(Reader, _readerEvents, function _fn(evt){\n\t\t\t\tvar type = evt.type;\n\t\t\t\tif( type == 'progress' ){\n\t\t\t\t\t_emit(file, fn, evt, evt.target.result, { loaded: evt.loaded, total: evt.total });\n\t\t\t\t}\n\t\t\t\telse if( type == 'loadend' ){\n\t\t\t\t\t_off(Reader, _readerEvents, _fn);\n\t\t\t\t\tReader = null;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_emit(file, fn, evt, evt.target.result);\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\ttry {\n\t\t\t\t// ReadAs ...\n\t\t\t\tif( encoding ){\n\t\t\t\t\tReader['readAs' + method](file, encoding);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tReader['readAs' + method](file);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (err){\n\t\t\t\t_emit(file, fn, 'error', undef, { error: err.toString() });\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t_emit(file, fn, 'error', undef, { error: 'filreader_not_support_' + method });\n\t\t}\n\t}\n\n\n\tfunction _isRegularFile(file, callback){\n\t\t// http://stackoverflow.com/questions/8856628/detecting-folders-directories-in-javascript-filelist-objects\n\t\tif( !file.type && (safari || ((file.size % 4096) === 0 && (file.size <= 102400))) ){\n\t\t\tif( FileReader ){\n\t\t\t\ttry {\n\t\t\t\t\tvar reader = new FileReader();\n\n\t\t\t\t\t_one(reader, _readerEvents, function (evt){\n\t\t\t\t\t\tvar isFile = evt.type != 'error';\n\t\t\t\t\t\tif( isFile ){\n\t\t\t\t\t\t\tif ( reader.readyState == null || reader.readyState === reader.LOADING ) {\n\t\t\t\t\t\t\t\treader.abort();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcallback(isFile);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcallback(false, reader.error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\treader.readAsDataURL(file);\n\t\t\t\t} catch( err ){\n\t\t\t\t\tcallback(false, err);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcallback(null, new Error('FileReader is not supported'));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tcallback(true);\n\t\t}\n\t}\n\n\n\tfunction _isEntry(item){\n\t\treturn item && (item.isFile || item.isDirectory);\n\t}\n\n\n\tfunction _getAsEntry(item){\n\t\tvar entry;\n\t\tif( item.getAsEntry ){ entry = item.getAsEntry(); }\n\t\telse if( item.webkitGetAsEntry ){ entry = item.webkitGetAsEntry(); }\n\t\treturn\tentry;\n\t}\n\n\n\tfunction _readEntryAsFiles(entry, callback){\n\t\tif( !entry ){\n\t\t\t// error\n\t\t\tvar err = new Error('invalid entry');\n\t\t\tentry = new Object(entry);\n\t\t\tentry.error = err;\n\t\t\tcallback(err.message, [], [entry]);\n\t\t}\n\t\telse if( entry.isFile ){\n\t\t\t// Read as file\n\t\t\tentry.file(function (file){\n\t\t\t\t// success\n\t\t\t\tfile.fullPath = entry.fullPath;\n\t\t\t\tcallback(false, [file], [file]);\n\t\t\t}, function (err){\n\t\t\t\t// error\n\t\t\t\tentry.error = err;\n\t\t\t\tcallback('FileError.code: ' + err.code, [], [entry]);\n\t\t\t});\n\t\t}\n\t\telse if( entry.isDirectory ){\n\t\t\tvar\n\t\t\t\treader = entry.createReader()\n\t\t\t\t, firstAttempt = true\n\t\t\t\t, files = []\n\t\t\t\t, all = [entry]\n\t\t\t;\n\n\t\t\tvar onerror = function (err){\n\t\t\t\t// error\n\t\t\t\tentry.error = err;\n\t\t\t\tcallback('DirectoryError.code: ' + err.code, files, all);\n\t\t\t};\n\t\t\tvar ondone = function ondone(entries){\n\t\t\t\tif( firstAttempt ){\n\t\t\t\t\tfirstAttempt = false;\n\t\t\t\t\tif( !entries.length ){\n\t\t\t\t\t\tentry.error = new Error('directory is empty');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// success\n\t\t\t\tif( entries.length ){\n\t\t\t\t\tapi.afor(entries, function (next, entry){\n\t\t\t\t\t\t_readEntryAsFiles(entry, function (err, entryFiles, allEntries){\n\t\t\t\t\t\t\tif( !err ){\n\t\t\t\t\t\t\t\tfiles = files.concat(entryFiles);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tall = all.concat(allEntries);\n\n\t\t\t\t\t\t\tif( next ){\n\t\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\treader.readEntries(ondone, onerror);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcallback(false, files, all);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treader.readEntries(ondone, onerror);\n\t\t}\n\t\telse {\n\t\t\t_readEntryAsFiles(_getAsEntry(entry), callback);\n\t\t}\n\t}\n\n\n\tfunction _simpleClone(obj){\n\t\tvar copy = {};\n\t\t_each(obj, function (val, key){\n\t\t\tif( val && (typeof val === 'object') && (val.nodeType === void 0) ){\n\t\t\t\tval = _extend({}, val);\n\t\t\t}\n\t\t\tcopy[key] = val;\n\t\t});\n\t\treturn\tcopy;\n\t}\n\n\n\tfunction isInputFile(el){\n\t\treturn\t_rinput.test(el && el.tagName);\n\t}\n\n\n\tfunction _getDataTransfer(evt){\n\t\treturn\t(evt.originalEvent || evt || '').dataTransfer || {};\n\t}\n\n\n\tfunction _isOriginTransform(trans){\n\t\tvar key;\n\t\tfor( key in trans ){\n\t\t\tif( trans.hasOwnProperty(key) ){\n\t\t\t\tif( !(trans[key] instanceof Object || key === 'overlay' || key === 'filter') ){\n\t\t\t\t\treturn\ttrue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn\tfalse;\n\t}\n\n\n\t// Add default image info reader\n\tapi.addInfoReader(/^image/, function (file/**File*/, callback/**Function*/){\n\t\tif( !file.__dimensions ){\n\t\t\tvar defer = file.__dimensions = api.defer();\n\n\t\t\tapi.readAsImage(file, function (evt){\n\t\t\t\tvar img = evt.target;\n\t\t\t\tdefer.resolve(evt.type == 'load' ? false : 'error', {\n\t\t\t\t\t  width:  img.width\n\t\t\t\t\t, height: img.height\n\t\t\t\t});\n                img.src = api.EMPTY_PNG;\n\t\t\t\timg = null;\n\t\t\t});\n\t\t}\n\n\t\tfile.__dimensions.then(callback);\n\t});\n\n\n\t/**\n\t * Drag'n'Drop special event\n\t *\n\t * @param\t{HTMLElement}\tel\n\t * @param\t{Function}\t\tonHover\n\t * @param\t{Function}\t\tonDrop\n\t */\n\tapi.event.dnd = function (el, onHover, onDrop){\n\t\tvar _id, _type;\n\n\t\tif( !onDrop ){\n\t\t\tonDrop = onHover;\n\t\t\tonHover = api.F;\n\t\t}\n\n\t\tif( FileReader ){\n\t\t\t// Hover\n\t\t\t_on(el, 'dragenter dragleave dragover', onHover.ff = onHover.ff || function (evt){\n\t\t\t\tvar\n\t\t\t\t\t  types = _getDataTransfer(evt).types\n\t\t\t\t\t, i = types && types.length\n\t\t\t\t\t, debounceTrigger = false\n\t\t\t\t;\n\n\t\t\t\twhile( i-- ){\n\t\t\t\t\tif( ~types[i].indexOf('File') ){\n\t\t\t\t\t\tevt[preventDefault]();\n\n\t\t\t\t\t\tif( _type !== evt.type ){\n\t\t\t\t\t\t\t_type = evt.type; // Store current type of event\n\n\t\t\t\t\t\t\tif( _type != 'dragleave' ){\n\t\t\t\t\t\t\t\tonHover.call(evt[currentTarget], true, evt);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdebounceTrigger = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak; // exit from \"while\"\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif( debounceTrigger ){\n\t\t\t\t\tclearTimeout(_id);\n\t\t\t\t\t_id = setTimeout(function (){\n\t\t\t\t\t\tonHover.call(evt[currentTarget], _type != 'dragleave', evt);\n\t\t\t\t\t}, 50);\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\t// Drop\n\t\t\t_on(el, 'drop', onDrop.ff = onDrop.ff || function (evt){\n\t\t\t\tevt[preventDefault]();\n\n\t\t\t\t_type = 0;\n\n\t\t\t\tapi.getDropFiles(evt, function (files, all){\n\t\t\t\t\tonDrop.call(evt[currentTarget], files, all, evt);\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tonHover.call(evt[currentTarget], false, evt);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tapi.log(\"Drag'n'Drop -- not supported\");\n\t\t}\n\t};\n\n\n\t/**\n\t * Remove drag'n'drop\n\t * @param\t{HTMLElement}\tel\n\t * @param\t{Function}\t\tonHover\n\t * @param\t{Function}\t\tonDrop\n\t */\n\tapi.event.dnd.off = function (el, onHover, onDrop){\n\t\t_off(el, 'dragenter dragleave dragover', onHover.ff);\n\t\t_off(el, 'drop', onDrop.ff);\n\t};\n\n\n\t// Support jQuery\n\tif( jQuery && !jQuery.fn.dnd ){\n\t\tjQuery.fn.dnd = function (onHover, onDrop){\n\t\t\treturn this.each(function (){\n\t\t\t\tapi.event.dnd(this, onHover, onDrop);\n\t\t\t});\n\t\t};\n\n\t\tjQuery.fn.offdnd = function (onHover, onDrop){\n\t\t\treturn this.each(function (){\n\t\t\t\tapi.event.dnd.off(this, onHover, onDrop);\n\t\t\t});\n\t\t};\n\t}\n\n\t// @export\n\twindow.FileAPI  = _extend(api, window.FileAPI);\n\n\n\t// Debug info\n\tapi.log('FileAPI: ' + api.version);\n\tapi.log('protocol: ' + window.location.protocol);\n\tapi.log('doctype: [' + doctype.name + '] ' + doctype.publicId + ' ' + doctype.systemId);\n\n\n\t// @detect 'x-ua-compatible'\n\t_each(document.getElementsByTagName('meta'), function (meta){\n\t\tif( /x-ua-compatible/i.test(meta.getAttribute('http-equiv')) ){\n\t\t\tapi.log('meta.http-equiv: ' + meta.getAttribute('content'));\n\t\t}\n\t});\n\n\n\t// Configuration\n\ttry {\n\t\t_supportConsoleLog = !!console.log;\n\t\t_supportConsoleLogApply = !!console.log.apply;\n\t}\n\tcatch (err) {}\n\n\tif( !api.flashUrl ){ api.flashUrl = api.staticPath + 'FileAPI.flash.swf'; }\n\tif( !api.flashImageUrl ){ api.flashImageUrl = api.staticPath + 'FileAPI.flash.image.swf'; }\n\tif( !api.flashWebcamUrl ){ api.flashWebcamUrl = api.staticPath + 'FileAPI.flash.camera.swf'; }\n})(window, void 0);\n\n/*global window, FileAPI, document */\n\n(function (api, document, undef) {\n\t'use strict';\n\n\tvar\n\t\tmin = Math.min,\n\t\tround = Math.round,\n\t\tgetCanvas = function () { return document.createElement('canvas'); },\n\t\tsupport = false,\n\t\texifOrientation = {\n\t\t\t  8:\t270\n\t\t\t, 3:\t180\n\t\t\t, 6:\t90\n\t\t\t, 7:\t270\n\t\t\t, 4:\t180\n\t\t\t, 5:\t90\n\t\t}\n\t;\n\n\ttry {\n\t\tsupport = getCanvas().toDataURL('image/png').indexOf('data:image/png') > -1;\n\t}\n\tcatch (e){}\n\n\n\tfunction Image(file){\n\t\tif( file instanceof Image ){\n\t\t\tvar img = new Image(file.file);\n\t\t\tapi.extend(img.matrix, file.matrix);\n\t\t\treturn\timg;\n\t\t}\n\t\telse if( !(this instanceof Image) ){\n\t\t\treturn\tnew Image(file);\n\t\t}\n\n\t\tthis.file   = file;\n\t\tthis.size   = file.size || 100;\n\n\t\tthis.matrix\t= {\n\t\t\tsx: 0,\n\t\t\tsy: 0,\n\t\t\tsw: 0,\n\t\t\tsh: 0,\n\t\t\tdx: 0,\n\t\t\tdy: 0,\n\t\t\tdw: 0,\n\t\t\tdh: 0,\n\t\t\tresize: 0, // min, max OR preview\n\t\t\tdeg: 0,\n\t\t\tquality: 1, // jpeg quality\n\t\t\tfilter: 0\n\t\t};\n\t}\n\n\n\tImage.prototype = {\n\t\timage: true,\n\t\tconstructor: Image,\n\n\t\tset: function (attrs){\n\t\t\tapi.extend(this.matrix, attrs);\n\t\t\treturn\tthis;\n\t\t},\n\n\t\tcrop: function (x, y, w, h){\n\t\t\tif( w === undef ){\n\t\t\t\tw\t= x;\n\t\t\t\th\t= y;\n\t\t\t\tx = y = 0;\n\t\t\t}\n\t\t\treturn\tthis.set({ sx: x, sy: y, sw: w, sh: h || w });\n\t\t},\n\n\t\tresize: function (w, h, strategy){\n\t\t\tif( /min|max|height|width/.test(h) ){\n\t\t\t\tstrategy = h;\n\t\t\t\th = w;\n\t\t\t}\n\n\t\t\treturn\tthis.set({ dw: w, dh: h || w, resize: strategy });\n\t\t},\n\n\t\tpreview: function (w, h){\n\t\t\treturn\tthis.resize(w, h || w, 'preview');\n\t\t},\n\n\t\trotate: function (deg){\n\t\t\treturn\tthis.set({ deg: deg });\n\t\t},\n\n\t\tfilter: function (filter){\n\t\t\treturn\tthis.set({ filter: filter });\n\t\t},\n\n\t\toverlay: function (images){\n\t\t\treturn\tthis.set({ overlay: images });\n\t\t},\n\n\t\tclone: function (){\n\t\t\treturn\tnew Image(this);\n\t\t},\n\n\t\t_load: function (image, fn){\n\t\t\tvar self = this;\n\n\t\t\tif( /img|video/i.test(image.nodeName) ){\n\t\t\t\tfn.call(self, null, image);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tapi.readAsImage(image, function (evt){\n\t\t\t\t\tfn.call(self, evt.type != 'load', evt.result);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t_apply: function (image, fn){\n\t\t\tvar\n\t\t\t\t  canvas = getCanvas()\n\t\t\t\t, m = this.getMatrix(image)\n\t\t\t\t, ctx = canvas.getContext('2d')\n\t\t\t\t, width = image.videoWidth || image.width\n\t\t\t\t, height = image.videoHeight || image.height\n\t\t\t\t, deg = m.deg\n\t\t\t\t, dw = m.dw\n\t\t\t\t, dh = m.dh\n\t\t\t\t, w = width\n\t\t\t\t, h = height\n\t\t\t\t, filter = m.filter\n\t\t\t\t, copy // canvas copy\n\t\t\t\t, buffer = image\n\t\t\t\t, overlay = m.overlay\n\t\t\t\t, queue = api.queue(function (){ image.src = api.EMPTY_PNG; fn(false, canvas); })\n\t\t\t\t, renderImageToCanvas = api.renderImageToCanvas\n\t\t\t;\n\n\t\t\t// Normalize angle\n\t\t\tdeg = deg - Math.floor(deg/360)*360;\n\n\t\t\t// For `renderImageToCanvas`\n\t\t\timage._type = this.file.type;\n\n\t\t\twhile(m.multipass && min(w/dw, h/dh) > 2 ){\n\t\t\t\tw = (w/2 + 0.5)|0;\n\t\t\t\th = (h/2 + 0.5)|0;\n\n\t\t\t\tcopy = getCanvas();\n\t\t\t\tcopy.width  = w;\n\t\t\t\tcopy.height = h;\n\n\t\t\t\tif( buffer !== image ){\n\t\t\t\t\trenderImageToCanvas(copy, buffer, 0, 0, buffer.width, buffer.height, 0, 0, w, h);\n\t\t\t\t\tbuffer = copy;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tbuffer = copy;\n\t\t\t\t\trenderImageToCanvas(buffer, image, m.sx, m.sy, m.sw, m.sh, 0, 0, w, h);\n\t\t\t\t\tm.sx = m.sy = m.sw = m.sh = 0;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tcanvas.width  = (deg % 180) ? dh : dw;\n\t\t\tcanvas.height = (deg % 180) ? dw : dh;\n\n\t\t\tcanvas.type = m.type;\n\t\t\tcanvas.quality = m.quality;\n\n\t\t\tctx.rotate(deg * Math.PI / 180);\n\t\t\trenderImageToCanvas(ctx.canvas, buffer\n\t\t\t\t, m.sx, m.sy\n\t\t\t\t, m.sw || buffer.width\n\t\t\t\t, m.sh || buffer.height\n\t\t\t\t, (deg == 180 || deg == 270 ? -dw : 0)\n\t\t\t\t, (deg == 90 || deg == 180 ? -dh : 0)\n\t\t\t\t, dw, dh\n\t\t\t);\n\t\t\tdw = canvas.width;\n\t\t\tdh = canvas.height;\n\n\t\t\t// Apply overlay\n\t\t\toverlay && api.each([].concat(overlay), function (over){\n\t\t\t\tqueue.inc();\n\t\t\t\t// preload\n\t\t\t\tvar img = new window.Image, fn = function (){\n\t\t\t\t\tvar\n\t\t\t\t\t\t  x = over.x|0\n\t\t\t\t\t\t, y = over.y|0\n\t\t\t\t\t\t, w = over.w || img.width\n\t\t\t\t\t\t, h = over.h || img.height\n\t\t\t\t\t\t, rel = over.rel\n\t\t\t\t\t;\n\n\t\t\t\t\t// center  |  right  |  left\n\t\t\t\t\tx = (rel == 1 || rel == 4 || rel == 7) ? (dw - w + x)/2 : (rel == 2 || rel == 5 || rel == 8 ? dw - (w + x) : x);\n\n\t\t\t\t\t// center  |  bottom  |  top\n\t\t\t\t\ty = (rel == 3 || rel == 4 || rel == 5) ? (dh - h + y)/2 : (rel >= 6 ? dh - (h + y) : y);\n\n\t\t\t\t\tapi.event.off(img, 'error load abort', fn);\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tctx.globalAlpha = over.opacity || 1;\n\t\t\t\t\t\tctx.drawImage(img, x, y, w, h);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (er){}\n\n\t\t\t\t\tqueue.next();\n\t\t\t\t};\n\n\t\t\t\tapi.event.on(img, 'error load abort', fn);\n\t\t\t\timg.src = over.src;\n\n\t\t\t\tif( img.complete ){\n\t\t\t\t\tfn();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif( filter ){\n\t\t\t\tqueue.inc();\n\t\t\t\tImage.applyFilter(canvas, filter, queue.next);\n\t\t\t}\n\n\t\t\tqueue.check();\n\t\t},\n\n\t\tgetMatrix: function (image){\n\t\t\tvar\n\t\t\t\t  m  = api.extend({}, this.matrix)\n\t\t\t\t, sw = m.sw = m.sw || image.videoWidth || image.naturalWidth ||  image.width\n\t\t\t\t, sh = m.sh = m.sh || image.videoHeight || image.naturalHeight || image.height\n\t\t\t\t, dw = m.dw = m.dw || sw\n\t\t\t\t, dh = m.dh = m.dh || sh\n\t\t\t\t, sf = sw/sh, df = dw/dh\n\t\t\t\t, strategy = m.resize\n\t\t\t;\n\n\t\t\tif( strategy == 'preview' ){\n\t\t\t\tif( dw != sw || dh != sh ){\n\t\t\t\t\t// Make preview\n\t\t\t\t\tvar w, h;\n\n\t\t\t\t\tif( df >= sf ){\n\t\t\t\t\t\tw\t= sw;\n\t\t\t\t\t\th\t= w / df;\n\t\t\t\t\t} else {\n\t\t\t\t\t\th\t= sh;\n\t\t\t\t\t\tw\t= h * df;\n\t\t\t\t\t}\n\n\t\t\t\t\tif( w != sw || h != sh ){\n\t\t\t\t\t\tm.sx\t= ~~((sw - w)/2);\n\t\t\t\t\t\tm.sy\t= ~~((sh - h)/2);\n\t\t\t\t\t\tsw\t\t= w;\n\t\t\t\t\t\tsh\t\t= h;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if( strategy == 'height' ){\n\t\t\t\tdw = dh * sf;\n\t\t\t}\n\t\t\telse if( strategy == 'width' ){\n\t\t\t\tdh = dw / sf;\n\t\t\t}\n\t\t\telse if( strategy ){\n\t\t\t\tif( !(sw > dw || sh > dh) ){\n\t\t\t\t\tdw = sw;\n\t\t\t\t\tdh = sh;\n\t\t\t\t}\n\t\t\t\telse if( strategy == 'min' ){\n\t\t\t\t\tdw = round(sf < df ? min(sw, dw) : dh*sf);\n\t\t\t\t\tdh = round(sf < df ? dw/sf : min(sh, dh));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdw = round(sf >= df ? min(sw, dw) : dh*sf);\n\t\t\t\t\tdh = round(sf >= df ? dw/sf : min(sh, dh));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tm.sw = sw;\n\t\t\tm.sh = sh;\n\t\t\tm.dw = dw;\n\t\t\tm.dh = dh;\n\t\t\tm.multipass = api.multiPassResize;\n\t\t\treturn\tm;\n\t\t},\n\n\t\t_trans: function (fn){\n\t\t\tthis._load(this.file, function (err, image){\n\t\t\t\tif( err ){\n\t\t\t\t\tfn(err);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis._apply(image, fn);\n\t\t\t\t\t} catch (err){\n\t\t\t\t\t\tapi.log('[err] FileAPI.Image.fn._apply:', err);\n\t\t\t\t\t\tfn(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\tget: function (fn){\n\t\t\tif( api.support.transform ){\n\t\t\t\tvar _this = this, matrix = _this.matrix;\n\n\t\t\t\tif( matrix.deg == 'auto' ){\n\t\t\t\t\tapi.getInfo(_this.file, function (err, info){\n\t\t\t\t\t\t// rotate by exif orientation\n\t\t\t\t\t\tmatrix.deg = exifOrientation[info && info.exif && info.exif.Orientation] || 0;\n\t\t\t\t\t\t_this._trans(fn);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t_this._trans(fn);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfn('not_support_transform');\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\n\t\ttoData: function (fn){\n\t\t\treturn this.get(fn);\n\t\t}\n\n\t};\n\n\n\tImage.exifOrientation = exifOrientation;\n\n\n\tImage.transform = function (file, transform, autoOrientation, fn){\n\t\tfunction _transform(err, img){\n\t\t\t// img -- info object\n\t\t\tvar\n\t\t\t\t  images = {}\n\t\t\t\t, queue = api.queue(function (err){\n\t\t\t\t\tfn(err, images);\n\t\t\t\t})\n\t\t\t;\n\n\t\t\tif( !err ){\n\t\t\t\tapi.each(transform, function (params, name){\n\t\t\t\t\tif( !queue.isFail() ){\n\t\t\t\t\t\tvar ImgTrans = new Image(img.nodeType ? img : file), isFn = typeof params == 'function';\n\n\t\t\t\t\t\tif( isFn ){\n\t\t\t\t\t\t\tparams(img, ImgTrans);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if( params.width ){\n\t\t\t\t\t\t\tImgTrans[params.preview ? 'preview' : 'resize'](params.width, params.height, params.strategy);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tif( params.maxWidth && (img.width > params.maxWidth || img.height > params.maxHeight) ){\n\t\t\t\t\t\t\t\tImgTrans.resize(params.maxWidth, params.maxHeight, 'max');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( params.crop ){\n\t\t\t\t\t\t\tvar crop = params.crop;\n\t\t\t\t\t\t\tImgTrans.crop(crop.x|0, crop.y|0, crop.w || crop.width, crop.h || crop.height);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( params.rotate === undef && autoOrientation ){\n\t\t\t\t\t\t\tparams.rotate = 'auto';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tImgTrans.set({ type: ImgTrans.matrix.type || params.type || file.type || 'image/png' });\n\n\t\t\t\t\t\tif( !isFn ){\n\t\t\t\t\t\t\tImgTrans.set({\n\t\t\t\t\t\t\t\t  deg: params.rotate\n\t\t\t\t\t\t\t\t, overlay: params.overlay\n\t\t\t\t\t\t\t\t, filter: params.filter\n\t\t\t\t\t\t\t\t, quality: params.quality || 1\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tqueue.inc();\n\t\t\t\t\t\tImgTrans.toData(function (err, image){\n\t\t\t\t\t\t\tif( err ){\n\t\t\t\t\t\t\t\tqueue.fail();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\timages[name] = image;\n\t\t\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tqueue.fail();\n\t\t\t}\n\t\t}\n\n\n\t\t// @todo: Оло-ло, нужно рефакторить это место\n\t\tif( file.width ){\n\t\t\t_transform(false, file);\n\t\t} else {\n\t\t\tapi.getInfo(file, _transform);\n\t\t}\n\t};\n\n\n\t// @const\n\tapi.each(['TOP', 'CENTER', 'BOTTOM'], function (x, i){\n\t\tapi.each(['LEFT', 'CENTER', 'RIGHT'], function (y, j){\n\t\t\tImage[x+'_'+y] = i*3 + j;\n\t\t\tImage[y+'_'+x] = i*3 + j;\n\t\t});\n\t});\n\n\n\t/**\n\t * Trabsform element to canvas\n\t *\n\t * @param    {Image|HTMLVideoElement}   el\n\t * @returns  {Canvas}\n\t */\n\tImage.toCanvas = function(el){\n\t\tvar canvas\t\t= document.createElement('canvas');\n\t\tcanvas.width\t= el.videoWidth || el.width;\n\t\tcanvas.height\t= el.videoHeight || el.height;\n\t\tcanvas.getContext('2d').drawImage(el, 0, 0);\n\t\treturn\tcanvas;\n\t};\n\n\n\t/**\n\t * Create image from DataURL\n\t * @param  {String}  dataURL\n\t * @param  {Object}  size\n\t * @param  {Function}  callback\n\t */\n\tImage.fromDataURL = function (dataURL, size, callback){\n\t\tvar img = api.newImage(dataURL);\n\t\tapi.extend(img, size);\n\t\tcallback(img);\n\t};\n\n\n\t/**\n\t * Apply filter (caman.js)\n\t *\n\t * @param  {Canvas|Image}   canvas\n\t * @param  {String|Function}  filter\n\t * @param  {Function}  doneFn\n\t */\n\tImage.applyFilter = function (canvas, filter, doneFn){\n\t\tif( typeof filter == 'function' ){\n\t\t\tfilter(canvas, doneFn);\n\t\t}\n\t\telse if( window.Caman ){\n\t\t\t// http://camanjs.com/guides/\n\t\t\twindow.Caman(canvas.tagName == 'IMG' ? Image.toCanvas(canvas) : canvas, function (){\n\t\t\t\tif( typeof filter == 'string' ){\n\t\t\t\t\tthis[filter]();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tapi.each(filter, function (val, method){\n\t\t\t\t\t\tthis[method](val);\n\t\t\t\t\t}, this);\n\t\t\t\t}\n\t\t\t\tthis.render(doneFn);\n\t\t\t});\n\t\t}\n\t};\n\n\n\t/**\n\t * For load-image-ios.js\n\t */\n\tapi.renderImageToCanvas = function (canvas, img, sx, sy, sw, sh, dx, dy, dw, dh){\n\t\ttry {\n\t\t\treturn canvas.getContext('2d').drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh);\n\t\t} catch (ex) {\n\t\t\tapi.log('renderImageToCanvas failed');\n\t\t\tthrow ex;\n\t\t}\n\t};\n\n\n\t// @export\n\tapi.support.canvas = api.support.transform = support;\n\tapi.Image = Image;\n})(FileAPI, document);\n\n/*\n * JavaScript Load Image iOS scaling fixes 1.0.3\n * https://github.com/blueimp/JavaScript-Load-Image\n *\n * Copyright 2013, Sebastian Tschan\n * https://blueimp.net\n *\n * iOS image scaling fixes based on\n * https://github.com/stomita/ios-imagefile-megapixel\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n */\n\n/*jslint nomen: true, bitwise: true */\n/*global FileAPI, window, document */\n\n(function (factory) {\n\t'use strict';\n\tfactory(FileAPI);\n}(function (loadImage) {\n    'use strict';\n\n    // Only apply fixes on the iOS platform:\n    if (!window.navigator || !window.navigator.platform ||\n             !(/iP(hone|od|ad)/).test(window.navigator.platform)) {\n        return;\n    }\n\n    var originalRenderMethod = loadImage.renderImageToCanvas;\n\n    // Detects subsampling in JPEG images:\n    loadImage.detectSubsampling = function (img) {\n        var canvas,\n            context;\n        if (img.width * img.height > 1024 * 1024) { // only consider mexapixel images\n            canvas = document.createElement('canvas');\n            canvas.width = canvas.height = 1;\n            context = canvas.getContext('2d');\n            context.drawImage(img, -img.width + 1, 0);\n            // subsampled image becomes half smaller in rendering size.\n            // check alpha channel value to confirm image is covering edge pixel or not.\n            // if alpha value is 0 image is not covering, hence subsampled.\n            return context.getImageData(0, 0, 1, 1).data[3] === 0;\n        }\n        return false;\n    };\n\n    // Detects vertical squash in JPEG images:\n    loadImage.detectVerticalSquash = function (img, subsampled) {\n        var naturalHeight = img.naturalHeight || img.height,\n            canvas = document.createElement('canvas'),\n            context = canvas.getContext('2d'),\n            data,\n            sy,\n            ey,\n            py,\n            alpha;\n        if (subsampled) {\n            naturalHeight /= 2;\n        }\n        canvas.width = 1;\n        canvas.height = naturalHeight;\n        context.drawImage(img, 0, 0);\n        data = context.getImageData(0, 0, 1, naturalHeight).data;\n        // search image edge pixel position in case it is squashed vertically:\n        sy = 0;\n        ey = naturalHeight;\n        py = naturalHeight;\n        while (py > sy) {\n            alpha = data[(py - 1) * 4 + 3];\n            if (alpha === 0) {\n                ey = py;\n            } else {\n                sy = py;\n            }\n            py = (ey + sy) >> 1;\n        }\n        return (py / naturalHeight) || 1;\n    };\n\n    // Renders image to canvas while working around iOS image scaling bugs:\n    // https://github.com/blueimp/JavaScript-Load-Image/issues/13\n    loadImage.renderImageToCanvas = function (\n        canvas,\n        img,\n        sourceX,\n        sourceY,\n        sourceWidth,\n        sourceHeight,\n        destX,\n        destY,\n        destWidth,\n        destHeight\n    ) {\n        if (img._type === 'image/jpeg') {\n            var context = canvas.getContext('2d'),\n                tmpCanvas = document.createElement('canvas'),\n                tileSize = 1024,\n                tmpContext = tmpCanvas.getContext('2d'),\n                subsampled,\n                vertSquashRatio,\n                tileX,\n                tileY;\n            tmpCanvas.width = tileSize;\n            tmpCanvas.height = tileSize;\n            context.save();\n            subsampled = loadImage.detectSubsampling(img);\n            if (subsampled) {\n                sourceX /= 2;\n                sourceY /= 2;\n                sourceWidth /= 2;\n                sourceHeight /= 2;\n            }\n            vertSquashRatio = loadImage.detectVerticalSquash(img, subsampled);\n            if (subsampled || vertSquashRatio !== 1) {\n                sourceY *= vertSquashRatio;\n                destWidth = Math.ceil(tileSize * destWidth / sourceWidth);\n                destHeight = Math.ceil(\n                    tileSize * destHeight / sourceHeight / vertSquashRatio\n                );\n                destY = 0;\n                tileY = 0;\n                while (tileY < sourceHeight) {\n                    destX = 0;\n                    tileX = 0;\n                    while (tileX < sourceWidth) {\n                        tmpContext.clearRect(0, 0, tileSize, tileSize);\n                        tmpContext.drawImage(\n                            img,\n                            sourceX,\n                            sourceY,\n                            sourceWidth,\n                            sourceHeight,\n                            -tileX,\n                            -tileY,\n                            sourceWidth,\n                            sourceHeight\n                        );\n                        context.drawImage(\n                            tmpCanvas,\n                            0,\n                            0,\n                            tileSize,\n                            tileSize,\n                            destX,\n                            destY,\n                            destWidth,\n                            destHeight\n                        );\n                        tileX += tileSize;\n                        destX += destWidth;\n                    }\n                    tileY += tileSize;\n                    destY += destHeight;\n                }\n                context.restore();\n                return canvas;\n            }\n        }\n        return originalRenderMethod(\n            canvas,\n            img,\n            sourceX,\n            sourceY,\n            sourceWidth,\n            sourceHeight,\n            destX,\n            destY,\n            destWidth,\n            destHeight\n        );\n    };\n\n}));\n\n/*global window, FileAPI */\n\n(function (api, window){\n\t\"use strict\";\n\n\tvar\n\t\t  document = window.document\n\t\t, FormData = window.FormData\n\t\t, Form = function (){ this.items = []; }\n\t\t, encodeURIComponent = window.encodeURIComponent\n\t;\n\n\n\tForm.prototype = {\n\n\t\tappend: function (name, blob, file, type){\n\t\t\tthis.items.push({\n\t\t\t\t  name: name\n\t\t\t\t, blob: blob && blob.blob || (blob == void 0 ? '' : blob)\n\t\t\t\t, file: blob && (file || blob.name)\n\t\t\t\t, type:\tblob && (type || blob.type)\n\t\t\t});\n\t\t},\n\n\t\teach: function (fn){\n\t\t\tvar i = 0, n = this.items.length;\n\t\t\tfor( ; i < n; i++ ){\n\t\t\t\tfn.call(this, this.items[i]);\n\t\t\t}\n\t\t},\n\n\t\ttoData: function (fn, options){\n\t\t    // allow chunked transfer if we have only one file to send\n\t\t    // flag is used below and in XHR._send\n\t\t    options._chunked = api.support.chunked && options.chunkSize > 0 && api.filter(this.items, function (item){ return item.file; }).length == 1;\n\n\t\t\tif( !api.support.html5 ){\n\t\t\t\tapi.log('FileAPI.Form.toHtmlData');\n\t\t\t\tthis.toHtmlData(fn);\n\t\t\t}\n\t\t\telse if( !api.formData || this.multipart || !FormData ){\n\t\t\t\tapi.log('FileAPI.Form.toMultipartData');\n\t\t\t\tthis.toMultipartData(fn);\n\t\t\t}\n\t\t\telse if( options._chunked ){\n\t\t\t\tapi.log('FileAPI.Form.toPlainData');\n\t\t\t\tthis.toPlainData(fn);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tapi.log('FileAPI.Form.toFormData');\n\t\t\t\tthis.toFormData(fn);\n\t\t\t}\n\t\t},\n\n\t\t_to: function (data, complete, next, arg){\n\t\t\tvar queue = api.queue(function (){\n\t\t\t\tcomplete(data);\n\t\t\t});\n\n\t\t\tthis.each(function (file){\n\t\t\t\ttry{\n\t\t\t\t\tnext(file, data, queue, arg);\n\t\t\t\t}\n\t\t\t\tcatch( err ){\n\t\t\t\t\tapi.log('FileAPI.Form._to: ' + err.message);\n\t\t\t\t\tcomplete(err);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tqueue.check();\n\t\t},\n\n\n\t\ttoHtmlData: function (fn){\n\t\t\tthis._to(document.createDocumentFragment(), fn, function (file, data/**DocumentFragment*/){\n\t\t\t\tvar blob = file.blob, hidden;\n\n\t\t\t\tif( file.file ){\n\t\t\t\t\tapi.reset(blob, true);\n\t\t\t\t\t// set new name\n\t\t\t\t\tblob.name = file.name;\n\t\t\t\t\tblob.disabled = false;\n\t\t\t\t\tdata.appendChild(blob);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\thidden = document.createElement('input');\n\t\t\t\t\thidden.name  = file.name;\n\t\t\t\t\thidden.type  = 'hidden';\n\t\t\t\t\thidden.value = blob;\n\t\t\t\t\tdata.appendChild(hidden);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\ttoPlainData: function (fn){\n\t\t\tthis._to({}, fn, function (file, data, queue){\n\t\t\t\tif( file.file ){\n\t\t\t\t\tdata.type = file.file;\n\t\t\t\t}\n\n\t\t\t\tif( file.blob.toBlob ){\n\t\t\t\t    // canvas\n\t\t\t\t\tqueue.inc();\n\t\t\t\t\t_convertFile(file, function (file, blob){\n\t\t\t\t\t\tdata.name = file.name;\n\t\t\t\t\t\tdata.file = blob;\n\t\t\t\t\t\tdata.size = blob.length;\n\t\t\t\t\t\tdata.type = file.type;\n\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if( file.file ){\n\t\t\t\t    // file\n\t\t\t\t\tdata.name = file.blob.name;\n\t\t\t\t\tdata.file = file.blob;\n\t\t\t\t\tdata.size = file.blob.size;\n\t\t\t\t\tdata.type = file.type;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t    // additional data\n\t\t\t\t    if( !data.params ){\n\t\t\t\t        data.params = [];\n\t\t\t\t    }\n\t\t\t\t    data.params.push(encodeURIComponent(file.name) +\"=\"+ encodeURIComponent(file.blob));\n\t\t\t\t}\n\n\t\t\t\tdata.start = -1;\n\t\t\t\tdata.end = data.file && data.file.FileAPIReadPosition || -1;\n\t\t\t\tdata.retry = 0;\n\t\t\t});\n\t\t},\n\n\t\ttoFormData: function (fn){\n\t\t\tthis._to(new FormData, fn, function (file, data, queue){\n\t\t\t\tif( file.blob && file.blob.toBlob ){\n\t\t\t\t\tqueue.inc();\n\t\t\t\t\t_convertFile(file, function (file, blob){\n\t\t\t\t\t\tdata.append(file.name, blob, file.file);\n\t\t\t\t\t\tqueue.next();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if( file.file ){\n\t\t\t\t\tdata.append(file.name, file.blob, file.file);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdata.append(file.name, file.blob);\n\t\t\t\t}\n\n\t\t\t\tif( file.file ){\n\t\t\t\t\tdata.append('_'+file.name, file.file);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\ttoMultipartData: function (fn){\n\t\t\tthis._to([], fn, function (file, data, queue, boundary){\n\t\t\t\tqueue.inc();\n\t\t\t\t_convertFile(file, function (file, blob){\n\t\t\t\t\tdata.push(\n\t\t\t\t\t\t  '--_' + boundary + ('\\r\\nContent-Disposition: form-data; name=\"'+ file.name +'\"'+ (file.file ? '; filename=\"'+ encodeURIComponent(file.file) +'\"' : '')\n\t\t\t\t\t\t+ (file.file ? '\\r\\nContent-Type: '+ (file.type || 'application/octet-stream') : '')\n\t\t\t\t\t\t+ '\\r\\n'\n\t\t\t\t\t\t+ '\\r\\n'+ (file.file ? blob : encodeURIComponent(blob))\n\t\t\t\t\t\t+ '\\r\\n')\n\t\t\t\t\t);\n\t\t\t\t\tqueue.next();\n\t\t\t\t}, true);\n\t\t\t}, api.expando);\n\t\t}\n\t};\n\n\n\tfunction _convertFile(file, fn, useBinaryString){\n\t\tvar blob = file.blob, filename = file.file;\n\n\t\tif( filename ){\n\t\t\tif( !blob.toDataURL ){\n\t\t\t\t// The Blob is not an image.\n\t\t\t\tapi.readAsBinaryString(blob, function (evt){\n\t\t\t\t\tif( evt.type == 'load' ){\n\t\t\t\t\t\tfn(file, evt.result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar\n\t\t\t\t  mime = { 'image/jpeg': '.jpe?g', 'image/png': '.png' }\n\t\t\t\t, type = mime[file.type] ? file.type : 'image/png'\n\t\t\t\t, ext  = mime[type] || '.png'\n\t\t\t\t, quality = blob.quality || 1\n\t\t\t;\n\n\t\t\tif( !filename.match(new RegExp(ext+'$', 'i')) ){\n\t\t\t\t// Does not change the current extension, but add a new one.\n\t\t\t\tfilename += ext.replace('?', '');\n\t\t\t}\n\n\t\t\tfile.file = filename;\n\t\t\tfile.type = type;\n\n\t\t\tif( !useBinaryString && blob.toBlob ){\n\t\t\t\tblob.toBlob(function (blob){\n\t\t\t\t\tfn(file, blob);\n\t\t\t\t}, type, quality);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfn(file, api.toBinaryString(blob.toDataURL(type, quality)));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfn(file, blob);\n\t\t}\n\t}\n\n\n\t// @export\n\tapi.Form = Form;\n})(FileAPI, window);\n\n/*global window, FileAPI, Uint8Array */\n\n(function (window, api){\n\t\"use strict\";\n\n\tvar\n\t\t  noop = function (){}\n\t\t, document = window.document\n\n\t\t, XHR = function (options){\n\t\t\tthis.uid = api.uid();\n\t\t\tthis.xhr = {\n\t\t\t\t  abort: noop\n\t\t\t\t, getResponseHeader: noop\n\t\t\t\t, getAllResponseHeaders: noop\n\t\t\t};\n\t\t\tthis.options = options;\n\t\t},\n\n\t\t_xhrResponsePostfix = { '': 1, XML: 1, Text: 1, Body: 1 }\n\t;\n\n\n\tXHR.prototype = {\n\t\tstatus: 0,\n\t\tstatusText: '',\n\t\tconstructor: XHR,\n\n\t\tgetResponseHeader: function (name){\n\t\t\treturn this.xhr.getResponseHeader(name);\n\t\t},\n\n\t\tgetAllResponseHeaders: function (){\n\t\t\treturn this.xhr.getAllResponseHeaders() || {};\n\t\t},\n\n\t\tend: function (status, statusText){\n\t\t\tvar _this = this, options = _this.options;\n\n\t\t\t_this.end\t\t=\n\t\t\t_this.abort\t\t= noop;\n\t\t\t_this.status\t= status;\n\n\t\t\tif( statusText ){\n\t\t\t\t_this.statusText = statusText;\n\t\t\t}\n\n\t\t\tapi.log('xhr.end:', status, statusText);\n\t\t\toptions.complete(status == 200 || status == 201 ? false : _this.statusText || 'unknown', _this);\n\n\t\t\tif( _this.xhr && _this.xhr.node ){\n\t\t\t\tsetTimeout(function (){\n\t\t\t\t\tvar node = _this.xhr.node;\n\t\t\t\t\ttry { node.parentNode.removeChild(node); } catch (e){}\n\t\t\t\t\ttry { delete window[_this.uid]; } catch (e){}\n\t\t\t\t\twindow[_this.uid] = _this.xhr.node = null;\n\t\t\t\t}, 9);\n\t\t\t}\n\t\t},\n\n\t\tabort: function (){\n\t\t\tthis.end(0, 'abort');\n\n\t\t\tif( this.xhr ){\n\t\t\t\tthis.xhr.aborted = true;\n\t\t\t\tthis.xhr.abort();\n\t\t\t}\n\t\t},\n\n\t\tsend: function (FormData){\n\t\t\tvar _this = this, options = this.options;\n\n\t\t\tFormData.toData(function (data){\n\t\t\t\tif( data instanceof Error ){\n\t\t\t\t\t_this.end(0, data.message);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t// Start uploading\n\t\t\t\t\toptions.upload(options, _this);\n\t\t\t\t\t_this._send.call(_this, options, data);\n\t\t\t\t}\n\t\t\t}, options);\n\t\t},\n\n\t\t_send: function (options, data){\n\t\t\tvar _this = this, xhr, uid = _this.uid, onLoadFnName = _this.uid + \"Load\", url = options.url;\n\n\t\t\tapi.log('XHR._send:', data);\n\n\t\t\tif( !options.cache ){\n\t\t\t\t// No cache\n\t\t\t\turl += (~url.indexOf('?') ? '&' : '?') + api.uid();\n\t\t\t}\n\n\t\t\tif( data.nodeName ){\n\t\t\t\tvar jsonp = options.jsonp;\n\n\t\t\t\t// prepare callback in GET\n\t\t\t\turl = url.replace(/([a-z]+)=(\\?)/i, '$1='+uid);\n\n\t\t\t\t// legacy\n\t\t\t\toptions.upload(options, _this);\n\n\t\t\t\tvar\n\t\t\t\t\tonPostMessage = function (evt){\n\t\t\t\t\t\tif( ~url.indexOf(evt.origin) ){\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tvar result = api.parseJSON(evt.data);\n\t\t\t\t\t\t\t\tif( result.id == uid ){\n\t\t\t\t\t\t\t\t\tcomplete(result.status, result.statusText, result.response);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch( err ){\n\t\t\t\t\t\t\t\tcomplete(0, err.message);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\n\t\t\t\t\t// jsonp-callack\n\t\t\t\t\tcomplete = window[uid] = function (status, statusText, response){\n\t\t\t\t\t\t_this.readyState\t= 4;\n\t\t\t\t\t\t_this.responseText\t= response;\n\t\t\t\t\t\t_this.end(status, statusText);\n\n\t\t\t\t\t\tapi.event.off(window, 'message', onPostMessage);\n\t\t\t\t\t\twindow[uid] = xhr = transport = window[onLoadFnName] = null;\n\t\t\t\t\t}\n\t\t\t\t;\n\n\t\t\t\t_this.xhr.abort = function (){\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif( transport.stop ){ transport.stop(); }\n\t\t\t\t\t\telse if( transport.contentWindow.stop ){ transport.contentWindow.stop(); }\n\t\t\t\t\t\telse { transport.contentWindow.document.execCommand('Stop'); }\n\t\t\t\t\t}\n\t\t\t\t\tcatch (er) {}\n\t\t\t\t\tcomplete(0, \"abort\");\n\t\t\t\t};\n\n\t\t\t\tapi.event.on(window, 'message', onPostMessage);\n\n\t\t\t\twindow[onLoadFnName] = function (){\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar\n\t\t\t\t\t\t\t  win = transport.contentWindow\n\t\t\t\t\t\t\t, doc = win.document\n\t\t\t\t\t\t\t, result = win.result || api.parseJSON(doc.body.innerHTML)\n\t\t\t\t\t\t;\n\t\t\t\t\t\tcomplete(result.status, result.statusText, result.response);\n\t\t\t\t\t} catch (e){\n\t\t\t\t\t\tapi.log('[transport.onload]', e);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\txhr = document.createElement('div');\n\t\t\t\txhr.innerHTML = '<form target=\"'+ uid +'\" action=\"'+ url +'\" method=\"POST\" enctype=\"multipart/form-data\" style=\"position: absolute; top: -1000px; overflow: hidden; width: 1px; height: 1px;\">'\n\t\t\t\t\t\t\t+ '<iframe name=\"'+ uid +'\" src=\"javascript:false;\" onload=\"window.' + onLoadFnName + ' && ' + onLoadFnName + '();\"></iframe>'\n\t\t\t\t\t\t\t+ (jsonp && (options.url.indexOf('=?') < 0) ? '<input value=\"'+ uid +'\" name=\"'+jsonp+'\" type=\"hidden\"/>' : '')\n\t\t\t\t\t\t\t+ '</form>'\n\t\t\t\t;\n\n\t\t\t\t// get form-data & transport\n\t\t\t\tvar\n\t\t\t\t\t  form = xhr.getElementsByTagName('form')[0]\n\t\t\t\t\t, transport = xhr.getElementsByTagName('iframe')[0]\n\t\t\t\t;\n\n\t\t\t\tform.appendChild(data);\n\n\t\t\t\tapi.log(form.parentNode.innerHTML);\n\n\t\t\t\t// append to DOM\n\t\t\t\tdocument.body.appendChild(xhr);\n\n\t\t\t\t// keep a reference to node-transport\n\t\t\t\t_this.xhr.node = xhr;\n\n\t\t\t\t// send\n\t\t\t\t_this.readyState = 2; // loaded\n\t\t\t\ttry {\n\t\t\t\t\tform.submit();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tapi.log('iframe.error: ' + err);\n\t\t\t\t}\n\t\t\t\tform = null;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Clean url\n\t\t\t\turl = url.replace(/([a-z]+)=(\\?)&?/i, '');\n\n\t\t\t\t// html5\n\t\t\t\tif (this.xhr && this.xhr.aborted) {\n\t\t\t\t\tapi.log(\"Error: already aborted\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\txhr = _this.xhr = api.getXHR();\n\n\t\t\t\tif (data.params) {\n\t\t\t\t\turl += (url.indexOf('?') < 0 ? \"?\" : \"&\") + data.params.join(\"&\");\n\t\t\t\t}\n\n\t\t\t\txhr.open('POST', url, true);\n\n\t\t\t\tif( api.withCredentials ){\n\t\t\t\t\txhr.withCredentials = \"true\";\n\t\t\t\t}\n\n\t\t\t\tif( !options.headers || !options.headers['X-Requested-With'] ){\n\t\t\t\t\txhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\t\t\t\t}\n\n\t\t\t\tapi.each(options.headers, function (val, key){\n\t\t\t\t\txhr.setRequestHeader(key, val);\n\t\t\t\t});\n\n\n\t\t\t\tif ( options._chunked ) {\n\t\t\t\t\t// chunked upload\n\t\t\t\t\tif( xhr.upload ){\n\t\t\t\t\t\txhr.upload.addEventListener('progress', api.throttle(function (/**Event*/evt){\n\t\t\t\t\t\t\tif (!data.retry) {\n\t\t\t\t\t\t\t\t// show progress only for correct chunk uploads\n\t\t\t\t\t\t\t\toptions.progress({\n\t\t\t\t\t\t\t\t\t  type:\t\t\tevt.type\n\t\t\t\t\t\t\t\t\t, total:\t\tdata.size\n\t\t\t\t\t\t\t\t\t, loaded:\t\tdata.start + evt.loaded\n\t\t\t\t\t\t\t\t\t, totalSize:\tdata.size\n\t\t\t\t\t\t\t\t}, _this, options);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 100), false);\n\t\t\t\t\t}\n\n\t\t\t\t\txhr.onreadystatechange = function (){\n\t\t\t\t\t\tvar lkb = parseInt(xhr.getResponseHeader('X-Last-Known-Byte'), 10);\n\n\t\t\t\t\t\t_this.status     = xhr.status;\n\t\t\t\t\t\t_this.statusText = xhr.statusText;\n\t\t\t\t\t\t_this.readyState = xhr.readyState;\n\n\t\t\t\t\t\tif( xhr.readyState == 4 ){\n\t\t\t\t\t\t\tfor( var k in _xhrResponsePostfix ){\n\t\t\t\t\t\t\t\t_this['response'+k]  = xhr['response'+k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\txhr.onreadystatechange = null;\n\n\t\t\t\t\t\t\tif (!xhr.status || xhr.status - 201 > 0) {\n\t\t\t\t\t\t\t\tapi.log(\"Error: \" + xhr.status);\n\t\t\t\t\t\t\t\t// some kind of error\n\t\t\t\t\t\t\t\t// 0 - connection fail or timeout, if xhr.aborted is true, then it's not recoverable user action\n\t\t\t\t\t\t\t\t// up - server error\n\t\t\t\t\t\t\t\tif (((!xhr.status && !xhr.aborted) || 500 == xhr.status || 416 == xhr.status) && ++data.retry <= options.chunkUploadRetry) {\n\t\t\t\t\t\t\t\t\t// let's try again the same chunk\n\t\t\t\t\t\t\t\t\t// only applicable for recoverable error codes 500 && 416\n\t\t\t\t\t\t\t\t\tvar delay = xhr.status ? 0 : api.chunkNetworkDownRetryTimeout;\n\n\t\t\t\t\t\t\t\t\t// inform about recoverable problems\n\t\t\t\t\t\t\t\t\toptions.pause(data.file, options);\n\n\t\t\t\t\t\t\t\t\t// smart restart if server reports about the last known byte\n\t\t\t\t\t\t\t\t\tapi.log(\"X-Last-Known-Byte: \" + lkb);\n\t\t\t\t\t\t\t\t\tif (lkb) {\n\t\t\t\t\t\t\t\t\t\tdata.end = lkb;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdata.end = data.start - 1;\n\t\t\t\t\t\t\t\t\t\tif (416 == xhr.status) {\n\t\t\t\t\t\t\t\t\t\t\tdata.end = data.end - options.chunkSize;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\t\t\t_this._send(options, data);\n\t\t\t\t\t\t\t\t\t}, delay);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// no mo retries\n\t\t\t\t\t\t\t\t\t_this.end(xhr.status);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// success\n\t\t\t\t\t\t\t\tdata.retry = 0;\n\n\t\t\t\t\t\t\t\tif (data.end == data.size - 1) {\n\t\t\t\t\t\t\t\t\t// finished\n\t\t\t\t\t\t\t\t\t_this.end(xhr.status);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// next chunk\n\n\t\t\t\t\t\t\t\t\t// shift position if server reports about the last known byte\n\t\t\t\t\t\t\t\t\tapi.log(\"X-Last-Known-Byte: \" + lkb);\n\t\t\t\t\t\t\t\t\tif (lkb) {\n\t\t\t\t\t\t\t\t\t\tdata.end = lkb;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdata.file.FileAPIReadPosition = data.end;\n\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\t\t\t_this._send(options, data);\n\t\t\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\txhr = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tdata.start = data.end + 1;\n\t\t\t\t\tdata.end = Math.max(Math.min(data.start + options.chunkSize, data.size) - 1, data.start);\n\n\t\t\t\t\t// Retrieve a slice of file\n\t\t\t\t\tvar\n\t\t\t\t\t\t  file = data.file\n\t\t\t\t\t\t, slice = (file.slice || file.mozSlice || file.webkitSlice).call(file, data.start, data.end + 1)\n\t\t\t\t\t;\n\n\t\t\t\t\tif( data.size && !slice.size ){\n\t\t\t\t\t\tsetTimeout(function (){\n\t\t\t\t\t\t\t_this.end(-1);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\txhr.setRequestHeader(\"Content-Range\", \"bytes \" + data.start + \"-\" + data.end + \"/\" + data.size);\n\t\t\t\t\t\txhr.setRequestHeader(\"Content-Disposition\", 'attachment; filename=' + encodeURIComponent(data.name));\n\t\t\t\t\t\txhr.setRequestHeader(\"Content-Type\", data.type || \"application/octet-stream\");\n\n\t\t\t\t\t\txhr.send(slice);\n\t\t\t\t\t}\n\n\t\t\t\t\tfile = slice = null;\n\t\t\t\t} else {\n\t\t\t\t\t// single piece upload\n\t\t\t\t\tif( xhr.upload ){\n\t\t\t\t\t\t// https://github.com/blueimp/jQuery-File-Upload/wiki/Fixing-Safari-hanging-on-very-high-speed-connections-%281Gbps%29\n\t\t\t\t\t\txhr.upload.addEventListener('progress', api.throttle(function (/**Event*/evt){\n\t\t\t\t\t\t\toptions.progress(evt, _this, options);\n\t\t\t\t\t\t}, 100), false);\n\t\t\t\t\t}\n\n\t\t\t\t\txhr.onreadystatechange = function (){\n\t\t\t\t\t\t_this.status     = xhr.status;\n\t\t\t\t\t\t_this.statusText = xhr.statusText;\n\t\t\t\t\t\t_this.readyState = xhr.readyState;\n\n\t\t\t\t\t\tif( xhr.readyState == 4 ){\n\t\t\t\t\t\t\tfor( var k in _xhrResponsePostfix ){\n\t\t\t\t\t\t\t\t_this['response'+k]  = xhr['response'+k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\txhr.onreadystatechange = null;\n\n\t\t\t\t\t\t\tif (!xhr.status || xhr.status > 201) {\n\t\t\t\t\t\t\t\tapi.log(\"Error: \" + xhr.status);\n\t\t\t\t\t\t\t\tif (((!xhr.status && !xhr.aborted) || 500 == xhr.status) && (options.retry || 0) < options.uploadRetry) {\n\t\t\t\t\t\t\t\t\toptions.retry = (options.retry || 0) + 1;\n\t\t\t\t\t\t\t\t\tvar delay = api.networkDownRetryTimeout;\n\n\t\t\t\t\t\t\t\t\t// inform about recoverable problems\n\t\t\t\t\t\t\t\t\toptions.pause(options.file, options);\n\n\t\t\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\t\t\t_this._send(options, data);\n\t\t\t\t\t\t\t\t\t}, delay);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t//success\n\t\t\t\t\t\t\t\t\t_this.end(xhr.status);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//success\n\t\t\t\t\t\t\t\t_this.end(xhr.status);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\txhr = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tif( api.isArray(data) ){\n\t\t\t\t\t\t// multipart\n\t\t\t\t\t\txhr.setRequestHeader('Content-Type', 'multipart/form-data; boundary=_'+api.expando);\n\t\t\t\t\t\tvar rawData = data.join('') +'--_'+ api.expando +'--';\n\n\t\t\t\t\t\t/** @namespace  xhr.sendAsBinary  https://developer.mozilla.org/ru/XMLHttpRequest#Sending_binary_content */\n\t\t\t\t\t\tif( xhr.sendAsBinary ){\n\t\t\t\t\t\t\txhr.sendAsBinary(rawData);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar bytes = Array.prototype.map.call(rawData, function(c){ return c.charCodeAt(0) & 0xff; });\n\t\t\t\t\t\t\txhr.send(new Uint8Array(bytes).buffer);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// FormData\n\t\t\t\t\t\txhr.send(data);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\t// @export\n\tapi.XHR = XHR;\n})(window, FileAPI);\n\n/**\n * @class\tFileAPI.Camera\n * @author\tRubaXa\t<trash@rubaxa.org>\n * @support\tChrome 21+, FF 18+, Opera 12+\n */\n\n/*global window, FileAPI, jQuery */\n/** @namespace LocalMediaStream -- https://developer.mozilla.org/en-US/docs/WebRTC/MediaStream_API#LocalMediaStream */\n(function (window, api){\n\t\"use strict\";\n\n\tvar\n\t\tURL = window.URL || window.webkitURL,\n\n\t\tdocument = window.document,\n\t\tnavigator = window.navigator,\n\n\t\tgetMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia,\n\n\t\thtml5 = !!getMedia\n\t;\n\n\n\t// Support \"media\"\n\tapi.support.media = html5;\n\n\n\tvar Camera = function (video){\n\t\tthis.video = video;\n\t};\n\n\n\tCamera.prototype = {\n\t\tisActive: function (){\n\t\t\treturn\t!!this._active;\n\t\t},\n\n\n\t\t/**\n\t\t * Start camera streaming\n\t\t * @param\t{Function}\tcallback\n\t\t */\n\t\tstart: function (callback){\n\t\t\tvar\n\t\t\t\t  _this = this\n\t\t\t\t, video = _this.video\n\t\t\t\t, _successId\n\t\t\t\t, _failId\n\t\t\t\t, _complete = function (err){\n\t\t\t\t\t_this._active = !err;\n\t\t\t\t\tclearTimeout(_failId);\n\t\t\t\t\tclearTimeout(_successId);\n//\t\t\t\t\tapi.event.off(video, 'loadedmetadata', _complete);\n\t\t\t\t\tcallback && callback(err, _this);\n\t\t\t\t}\n\t\t\t;\n\n\t\t\tgetMedia.call(navigator, { video: true }, function (stream/**LocalMediaStream*/){\n\t\t\t\t// Success\n\t\t\t\t_this.stream = stream;\n\n//\t\t\t\tapi.event.on(video, 'loadedmetadata', function (){\n//\t\t\t\t\t_complete(null);\n//\t\t\t\t});\n\n\t\t\t\t// Set camera stream\n\t\t\t\tvideo.src = URL.createObjectURL(stream);\n\n\t\t\t\t// Note: onloadedmetadata doesn't fire in Chrome when using it with getUserMedia.\n\t\t\t\t// See crbug.com/110938.\n\t\t\t\t_successId = setInterval(function (){\n\t\t\t\t\tif( _detectVideoSignal(video) ){\n\t\t\t\t\t\t_complete(null);\n\t\t\t\t\t}\n\t\t\t\t}, 1000);\n\n\t\t\t\t_failId = setTimeout(function (){\n\t\t\t\t\t_complete('timeout');\n\t\t\t\t}, 5000);\n\n\t\t\t\t// Go-go-go!\n\t\t\t\tvideo.play();\n\t\t\t}, _complete/*error*/);\n\t\t},\n\n\n\t\t/**\n\t\t * Stop camera streaming\n\t\t */\n\t\tstop: function (){\n\t\t\ttry {\n\t\t\t\tthis._active = false;\n\t\t\t\tthis.video.pause();\n\n\t\t\t\ttry {\n\t\t\t\t\tthis.stream.stop();\n\t\t\t\t} catch (err) {\n\t\t\t\t\tapi.each(this.stream.getTracks(), function (track) {\n\t\t\t\t\t\ttrack.stop();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.stream = null;\n\t\t\t} catch( err ){\n\t\t\t\tapi.log('[FileAPI.Camera] stop:', err);\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Create screenshot\n\t\t * @return {FileAPI.Camera.Shot}\n\t\t */\n\t\tshot: function (){\n\t\t\treturn\tnew Shot(this.video);\n\t\t}\n\t};\n\n\n\t/**\n\t * Get camera element from container\n\t *\n\t * @static\n\t * @param\t{HTMLElement}\tel\n\t * @return\t{Camera}\n\t */\n\tCamera.get = function (el){\n\t\treturn\tnew Camera(el.firstChild);\n\t};\n\n\n\t/**\n\t * Publish camera element into container\n\t *\n\t * @static\n\t * @param\t{HTMLElement}\tel\n\t * @param\t{Object}\t\toptions\n\t * @param\t{Function}\t\t[callback]\n\t */\n\tCamera.publish = function (el, options, callback){\n\t\tif( typeof options == 'function' ){\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// Dimensions of \"camera\"\n\t\toptions = api.extend({}, {\n\t\t\t  width:\t'100%'\n\t\t\t, height:\t'100%'\n\t\t\t, start:\ttrue\n\t\t}, options);\n\n\n\t\tif( el.jquery ){\n\t\t\t// Extract first element, from jQuery collection\n\t\t\tel = el[0];\n\t\t}\n\n\n\t\tvar doneFn = function (err){\n\t\t\tif( err ){\n\t\t\t\tcallback(err);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Get camera\n\t\t\t\tvar cam = Camera.get(el);\n\t\t\t\tif( options.start ){\n\t\t\t\t\tcam.start(callback);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcallback(null, cam);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\n\t\tel.style.width\t= _px(options.width);\n\t\tel.style.height\t= _px(options.height);\n\n\n\t\tif( api.html5 && html5 && !api.insecureChrome ){\n\t\t\t// Create video element\n\t\t\tvar video = document.createElement('video');\n\n\t\t\t// Set dimensions\n\t\t\tvideo.style.width\t= _px(options.width);\n\t\t\tvideo.style.height\t= _px(options.height);\n\n\t\t\t// Clean container\n\t\t\tif( window.jQuery ){\n\t\t\t\tjQuery(el).empty();\n\t\t\t} else {\n\t\t\t\tel.innerHTML = '';\n\t\t\t}\n\n\t\t\t// Add \"camera\" to container\n\t\t\tel.appendChild(video);\n\n\t\t\t// end\n\t\t\tdoneFn();\n\t\t}\n\t\telse {\n\t\t\tCamera.fallback(el, options, doneFn);\n\t\t}\n\t};\n\n\n\tCamera.fallback = function (el, options, callback){\n\t\tcallback('not_support_camera');\n\t};\n\n\tCamera.checkAlreadyCaptured = (function () {\n\t\tvar\tmediaDevices = navigator.mediaDevices,\n\t\t\tMediaStreamTrack = window.MediaStreamTrack,\n\t\t\tnavigatorEnumerateDevices = navigator.enumerateDevices,\n\t\t\tenumerateDevices;\n\n\t\tif (mediaDevices && mediaDevices.enumerateDevices) {\n\t\t\tenumerateDevices = function (callback) {\n\t\t\t\tmediaDevices.enumerateDevices().then(callback);\n\t\t\t};\n\t\t} else if (MediaStreamTrack && MediaStreamTrack.getSources) {\n\t\t\tenumerateDevices = MediaStreamTrack.getSources.bind(MediaStreamTrack);\n\t\t} else if (navigatorEnumerateDevices) {\n\t\t\tenumerateDevices = navigatorEnumerateDevices.bind(navigator);\n\t\t} else {\n\t\t\tenumerateDevices = function (fn) {\n\t\t\t\tfn([]);\n\t\t\t};\n\t\t}\n\n\t\treturn function (callback) {\n\t\t\tenumerateDevices(function (devices) {\n\t\t\t\tvar deviceExists = devices.some(function (device) {\n\t\t\t\t\treturn (device.kind === 'videoinput' || device.kind === 'video') && device.label;\n\t\t\t\t});\n\n\t\t\t\tcallback(deviceExists);\n\t\t\t});\n\t\t};\n\n\t})();\n\n\n\t/**\n\t * @class\tFileAPI.Camera.Shot\n\t */\n\tvar Shot = function (video){\n\t\tvar canvas\t= video.nodeName ? api.Image.toCanvas(video) : video;\n\t\tvar shot\t= api.Image(canvas);\n\t\tshot.type\t= 'image/png';\n\t\tshot.width\t= canvas.width;\n\t\tshot.height\t= canvas.height;\n\t\tshot.size\t= canvas.width * canvas.height * 4;\n\t\treturn\tshot;\n\t};\n\n\n\t/**\n\t * Add \"px\" postfix, if value is a number\n\t *\n\t * @private\n\t * @param\t{*}  val\n\t * @return\t{String}\n\t */\n\tfunction _px(val){\n\t\treturn\tval >= 0 ? val + 'px' : val;\n\t}\n\n\n\t/**\n\t * @private\n\t * @param\t{HTMLVideoElement} video\n\t * @return\t{Boolean}\n\t */\n\tfunction _detectVideoSignal(video){\n\t\tvar canvas = document.createElement('canvas'), ctx, res = false;\n\t\ttry {\n\t\t\tctx = canvas.getContext('2d');\n\t\t\tctx.drawImage(video, 0, 0, 1, 1);\n\t\t\tres = ctx.getImageData(0, 0, 1, 1).data[4] != 255;\n\t\t}\n\t\tcatch( err ){\n\t\t\tapi.log('[FileAPI.Camera] detectVideoSignal:', err);\n\t\t}\n\t\treturn\tres;\n\t}\n\n\n\t// @export\n\tCamera.Shot\t= Shot;\n\tapi.Camera\t= Camera;\n})(window, FileAPI);\n\n/**\n * FileAPI fallback to Flash\n *\n * @flash-developer  \"Vladimir Demidov\" <v.demidov@corp.mail.ru>\n */\n\n/*global window, ActiveXObject, FileAPI */\n(function (window, jQuery, api) {\n\t\"use strict\";\n\n\tvar\n\t\t  document = window.document\n\t\t, location = window.location\n\t\t, navigator = window.navigator\n\t\t, _each = api.each\n\t;\n\n\n\tapi.support.flash = (function (){\n\t\tvar mime = navigator.mimeTypes, has = false;\n\n\t\tif( navigator.plugins && typeof navigator.plugins['Shockwave Flash'] == 'object' ){\n\t\t\thas\t= navigator.plugins['Shockwave Flash'].description && !(mime && mime['application/x-shockwave-flash'] && !mime['application/x-shockwave-flash'].enabledPlugin);\n\t\t}\n\t\telse {\n\t\t\ttry {\n\t\t\t\thas\t= !!(window.ActiveXObject && new ActiveXObject('ShockwaveFlash.ShockwaveFlash'));\n\t\t\t}\n\t\t\tcatch(er){\n\t\t\t\tapi.log('Flash -- does not supported.');\n\t\t\t}\n\t\t}\n\n\t\tif( has && /^file:/i.test(location) ){\n\t\t\tapi.log('[warn] Flash does not work on `file:` protocol.');\n\t\t}\n\n\t\treturn\thas;\n\t})();\n\n\n\t   api.support.flash\n\t&& (0\n\t\t|| !api.html5 || !api.support.html5\n\t\t|| (api.cors && !api.support.cors)\n\t\t|| (api.media && !api.support.media)\n\t\t|| api.insecureChrome\n\t)\n\t&& (function (){\n\t\tvar\n\t\t\t  _attr  = api.uid()\n\t\t\t, _retry = 0\n\t\t\t, _files = {}\n\t\t\t, _rhttp = /^https?:/i\n\n\t\t\t, flash = {\n\t\t\t\t_fn: {},\n\n\n\t\t\t\t/**\n\t\t\t\t * Initialization & preload flash object\n\t\t\t\t */\n\t\t\t\tinit: function (){\n\t\t\t\t\tvar child = document.body && document.body.firstChild;\n\n\t\t\t\t\tif( child ){\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif( child.nodeType == 1 ){\n\t\t\t\t\t\t\t\tapi.log('FlashAPI.state: awaiting');\n\n\t\t\t\t\t\t\t\tvar dummy = document.createElement('div');\n\n\t\t\t\t\t\t\t\tdummy.id = '_' + _attr;\n\n\t\t\t\t\t\t\t\t_css(dummy, {\n\t\t\t\t\t\t\t\t\t  top: 1\n\t\t\t\t\t\t\t\t\t, right: 1\n\t\t\t\t\t\t\t\t\t, width: 5\n\t\t\t\t\t\t\t\t\t, height: 5\n\t\t\t\t\t\t\t\t\t, position: 'absolute'\n\t\t\t\t\t\t\t\t\t, zIndex: 2147483647+'' // set max zIndex\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tchild.parentNode.insertBefore(dummy, child);\n\t\t\t\t\t\t\t\tflash.publish(dummy, _attr);\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile( child = child.nextSibling );\n\t\t\t\t\t}\n\n\t\t\t\t\tif( _retry < 10 ){\n\t\t\t\t\t\tsetTimeout(flash.init, ++_retry*50);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\n\t\t\t\t/**\n\t\t\t\t * Publish flash-object\n\t\t\t\t *\n\t\t\t\t * @param {HTMLElement} el\n\t\t\t\t * @param {String} id\n\t\t\t\t * @param {Object} [opts]\n\t\t\t\t */\n\t\t\t\tpublish: function (el, id, opts){\n\t\t\t\t\topts = opts || {};\n\t\t\t\t\tel.innerHTML = _makeFlashHTML({\n\t\t\t\t\t\t  id: id\n\t\t\t\t\t\t, src: _getUrl(api.flashUrl, 'r=' + api.version)\n//\t\t\t\t\t\t, src: _getUrl('http://v.demidov.boom.corp.mail.ru/uploaderfileapi/FlashFileAPI.swf?1')\n\t\t\t\t\t\t, wmode: opts.camera ? '' : 'transparent'\n\t\t\t\t\t\t, flashvars: 'callback=' + (opts.onEvent || 'FileAPI.Flash.onEvent')\n\t\t\t\t\t\t\t+ '&flashId='+ id\n\t\t\t\t\t\t\t+ '&storeKey='+ navigator.userAgent.match(/\\d/ig).join('') +'_'+ api.version\n\t\t\t\t\t\t\t+ (flash.isReady || (api.pingUrl ? '&ping='+api.pingUrl : ''))\n\t\t\t\t\t\t\t+ '&timeout='+api.flashAbortTimeout\n\t\t\t\t\t\t\t+ (opts.camera ? '&useCamera=' + _getUrl(api.flashWebcamUrl) : '')\n\t\t\t\t\t\t\t+ '&debug='+(api.debug?\"1\":\"\")\n\t\t\t\t\t}, opts);\n\t\t\t\t},\n\n\n\t\t\t\tready: function (){\n\t\t\t\t\tapi.log('FlashAPI.state: ready');\n\n\t\t\t\t\tflash.ready = api.F;\n\t\t\t\t\tflash.isReady = true;\n\t\t\t\t\tflash.patch();\n\t\t\t\t\tflash.patchCamera && flash.patchCamera();\n\t\t\t\t\tapi.event.on(document, 'mouseover', flash.mouseover);\n\t\t\t\t\tapi.event.on(document, 'click', function (evt){\n\t\t\t\t\t\tif( flash.mouseover(evt) ){\n\t\t\t\t\t\t\tevt.preventDefault\n\t\t\t\t\t\t\t\t? evt.preventDefault()\n\t\t\t\t\t\t\t\t: (evt.returnValue = true)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\n\n\t\t\t\tgetEl: function (){\n\t\t\t\t\treturn\tdocument.getElementById('_'+_attr);\n\t\t\t\t},\n\n\n\t\t\t\tgetWrapper: function (node){\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif( /js-fileapi-wrapper/.test(node.className) ){\n\t\t\t\t\t\t\treturn\tnode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twhile( (node = node.parentNode) && (node !== document.body) );\n\t\t\t\t},\n\n\n\t\t\t\tmouseover: function (evt){\n\t\t\t\t\tvar target = api.event.fix(evt).target;\n\n\t\t\t\t\tif( /input/i.test(target.nodeName) && target.type == 'file' && !target.disabled ){\n\t\t\t\t\t\tvar\n\t\t\t\t\t\t\t  state = target.getAttribute(_attr)\n\t\t\t\t\t\t\t, wrapper = flash.getWrapper(target)\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tif( api.multiFlash ){\n\t\t\t\t\t\t\t// check state:\n\t\t\t\t\t\t\t//   p — published\n\t\t\t\t\t\t\t//   i — initialization\n\t\t\t\t\t\t\t//   r — ready\n\t\t\t\t\t\t\tif( state == 'i' || state == 'r' ){\n\t\t\t\t\t\t\t\t// publish fail\n\t\t\t\t\t\t\t\treturn\tfalse;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if( state != 'p' ){\n\t\t\t\t\t\t\t\t// set \"init\" state\n\t\t\t\t\t\t\t\ttarget.setAttribute(_attr, 'i');\n\n\t\t\t\t\t\t\t\tvar dummy = document.createElement('div');\n\n\t\t\t\t\t\t\t\tif( !wrapper ){\n\t\t\t\t\t\t\t\t\tapi.log('[err] FlashAPI.mouseover: js-fileapi-wrapper not found');\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t_css(dummy, {\n\t\t\t\t\t\t\t\t\t  top:    0\n\t\t\t\t\t\t\t\t\t, left:   0\n\t\t\t\t\t\t\t\t\t, width:  target.offsetWidth\n\t\t\t\t\t\t\t\t\t, height: target.offsetHeight\n\t\t\t\t\t\t\t\t\t, zIndex: 2147483647+'' // set max zIndex\n\t\t\t\t\t\t\t\t\t, position: 'absolute'\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\twrapper.appendChild(dummy);\n\t\t\t\t\t\t\t\tflash.publish(dummy, api.uid());\n\n\t\t\t\t\t\t\t\t// set \"publish\" state\n\t\t\t\t\t\t\t\ttarget.setAttribute(_attr, 'p');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn\ttrue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if( wrapper ){\n\t\t\t\t\t\t\t// Use one flash element\n\t\t\t\t\t\t\tvar box = _getDimensions(wrapper);\n\n\t\t\t\t\t\t\t_css(flash.getEl(), box);\n\n\t\t\t\t\t\t\t// Set current input\n\t\t\t\t\t\t\tflash.curInp = target;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if( !/object|embed/i.test(target.nodeName) ){\n\t\t\t\t\t\t_css(flash.getEl(), { top: 1, left: 1, width: 5, height: 5 });\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tonEvent: function (evt){\n\t\t\t\t\tvar type = evt.type;\n\n\t\t\t\t\tif( type == 'ready' ){\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// set \"ready\" state\n\t\t\t\t\t\t\tflash.getInput(evt.flashId).setAttribute(_attr, 'r');\n\t\t\t\t\t\t} catch (e){\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tflash.ready();\n\t\t\t\t\t\tsetTimeout(function (){ flash.mouseenter(evt); }, 50);\n\t\t\t\t\t\treturn\ttrue;\n\t\t\t\t\t}\n\t\t\t\t\telse if( type === 'ping' ){\n\t\t\t\t\t\tapi.log('(flash -> js).ping:', [evt.status, evt.savedStatus], evt.error);\n\t\t\t\t\t}\n\t\t\t\t\telse if( type === 'log' ){\n\t\t\t\t\t\tapi.log('(flash -> js).log:', evt.target);\n\t\t\t\t\t}\n\t\t\t\t\telse if( type in flash ){\n\t\t\t\t\t\tsetTimeout(function (){\n\t\t\t\t\t\t\tapi.log('FlashAPI.event.'+evt.type+':', evt);\n\t\t\t\t\t\t\tflash[type](evt);\n\t\t\t\t\t\t}, 1);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\n\t\t\t\tmouseenter: function (evt){\n\t\t\t\t\tvar node = flash.getInput(evt.flashId);\n\n\t\t\t\t\tif( node ){\n\t\t\t\t\t\t// Set multiple mode\n\t\t\t\t\t\tflash.cmd(evt, 'multiple', node.getAttribute('multiple') != null);\n\n\n\t\t\t\t\t\t// Set files filter\n\t\t\t\t\t\tvar accept = [], exts = {};\n\n\t\t\t\t\t\t_each((node.getAttribute('accept') || '').split(/,\\s*/), function (mime){\n\t\t\t\t\t\t\tapi.accept[mime] && _each(api.accept[mime].split(' '), function (ext){\n\t\t\t\t\t\t\t\texts[ext] = 1;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t_each(exts, function (i, ext){\n\t\t\t\t\t\t\taccept.push( ext );\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tflash.cmd(evt, 'accept', accept.length ? accept.join(',')+','+accept.join(',').toUpperCase() : '*');\n\t\t\t\t\t}\n\t\t\t\t},\n\n\n\t\t\t\tget: function (id){\n\t\t\t\t\treturn\tdocument[id] || window[id] || document.embeds[id];\n\t\t\t\t},\n\n\n\t\t\t\tgetInput: function (id){\n\t\t\t\t\tif( api.multiFlash ){\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar node = flash.getWrapper(flash.get(id));\n\t\t\t\t\t\t\tif( node ){\n\t\t\t\t\t\t\t\treturn node.getElementsByTagName('input')[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e){\n\t\t\t\t\t\t\tapi.log('[err] Can not find \"input\" by flashId:', id, e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn\tflash.curInp;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\n\t\t\t\tselect: function (evt){\n\t\t\t\t\tvar\n\t\t\t\t\t\t  inp = flash.getInput(evt.flashId)\n\t\t\t\t\t\t, uid = api.uid(inp)\n\t\t\t\t\t\t, files = evt.target.files\n\t\t\t\t\t\t, event\n\t\t\t\t\t;\n\n\t\t\t\t\t_each(files, function (file){\n\t\t\t\t\t\tapi.checkFileObj(file);\n\t\t\t\t\t});\n\n\t\t\t\t\t_files[uid] = files;\n\n\t\t\t\t\tif( document.createEvent ){\n\t\t\t\t\t\tevent = document.createEvent('Event');\n\t\t\t\t\t\tevent.files = files;\n\t\t\t\t\t\tevent.initEvent('change', true, true);\n\t\t\t\t\t\tinp.dispatchEvent(event);\n\t\t\t\t\t}\n\t\t\t\t\telse if( jQuery ){\n\t\t\t\t\t\tjQuery(inp).trigger({ type: 'change', files: files });\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tevent = document.createEventObject();\n\t\t\t\t\t\tevent.files = files;\n\t\t\t\t\t\tinp.fireEvent('onchange', event);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\n\t\t\t\tcmd: function (id, name, data, last){\n\t\t\t\t\ttry {\n\t\t\t\t\t\tapi.log('(js -> flash).'+name+':', data);\n\t\t\t\t\t\treturn flash.get(id.flashId || id).cmd(name, data);\n\t\t\t\t\t} catch (err){\n\t\t\t\t\t\tapi.log('(js -> flash).onError:', err.toString());\n\t\t\t\t\t\tif( !last ){\n\t\t\t\t\t\t\t// try again\n\t\t\t\t\t\t\tsetTimeout(function (){ flash.cmd(id, name, data, true); }, 50);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\n\t\t\t\tpatch: function (){\n\t\t\t\t\tapi.flashEngine = true;\n\n\t\t\t\t\t// FileAPI\n\t\t\t\t\t_inherit(api, {\n\t\t\t\t\t\tgetFiles: function (input, filter, callback){\n\t\t\t\t\t\t\tif( callback ){\n\t\t\t\t\t\t\t\tapi.filterFiles(api.getFiles(input), filter, callback);\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar files = api.isArray(input) ? input : _files[api.uid(input.target || input.srcElement || input)];\n\n\n\t\t\t\t\t\t\tif( !files ){\n\t\t\t\t\t\t\t\t// Файлов нету, вызываем родительский метод\n\t\t\t\t\t\t\t\treturn\tthis.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tif( filter ){\n\t\t\t\t\t\t\t\tfilter\t= api.getFilesFilter(filter);\n\t\t\t\t\t\t\t\tfiles\t= api.filter(files, function (file){ return filter.test(file.name); });\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn\tfiles;\n\t\t\t\t\t\t},\n\n\n\t\t\t\t\t\tgetInfo: function (file, fn){\n\t\t\t\t\t\t\tif( _isHtmlFile(file) ){\n\t\t\t\t\t\t\t\tthis.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if( file.isShot ){\n\t\t\t\t\t\t\t\tfn(null, file.info = {\n\t\t\t\t\t\t\t\t\twidth: file.width,\n\t\t\t\t\t\t\t\t\theight: file.height\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tif( !file.__info ){\n\t\t\t\t\t\t\t\t\tvar defer = file.__info = api.defer();\n\n\t\t\t\t\t\t\t\t\tflash.cmd(file, 'getFileInfo', {\n\t\t\t\t\t\t\t\t\t\t  id: file.id\n\t\t\t\t\t\t\t\t\t\t, callback: _wrap(function _(err, info){\n\t\t\t\t\t\t\t\t\t\t\t_unwrap(_);\n\t\t\t\t\t\t\t\t\t\t\tdefer.resolve(err, file.info = info);\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfile.__info.then(fn);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// FileAPI.Image\n\t\t\t\t\tapi.support.transform = true;\n\t\t\t\t\tapi.Image && _inherit(api.Image.prototype, {\n\t\t\t\t\t\tget: function (fn, scaleMode){\n\t\t\t\t\t\t\tthis.set({ scaleMode: scaleMode || 'noScale' }); // noScale, exactFit\n\t\t\t\t\t\t\treturn this.parent(fn);\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t_load: function (file, fn){\n\t\t\t\t\t\t\tapi.log('FlashAPI.Image._load:', file);\n\n\t\t\t\t\t\t\tif( _isHtmlFile(file) ){\n\t\t\t\t\t\t\t\tthis.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar _this = this;\n\t\t\t\t\t\t\t\tapi.getInfo(file, function (err){\n\t\t\t\t\t\t\t\t\tfn.call(_this, err, file);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t_apply: function (file, fn){\n\t\t\t\t\t\t\tapi.log('FlashAPI.Image._apply:', file);\n\n\t\t\t\t\t\t\tif( _isHtmlFile(file) ){\n\t\t\t\t\t\t\t\tthis.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar m = this.getMatrix(file.info), doneFn = fn;\n\n\t\t\t\t\t\t\t\tflash.cmd(file, 'imageTransform', {\n\t\t\t\t\t\t\t\t\t  id: file.id\n\t\t\t\t\t\t\t\t\t, matrix: m\n\t\t\t\t\t\t\t\t\t, callback: _wrap(function _(err, base64){\n\t\t\t\t\t\t\t\t\t\tapi.log('FlashAPI.Image._apply.callback:', err);\n\t\t\t\t\t\t\t\t\t\t_unwrap(_);\n\n\t\t\t\t\t\t\t\t\t\tif( err ){\n\t\t\t\t\t\t\t\t\t\t\tdoneFn(err);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if( !api.support.html5 && (!api.support.dataURI || base64.length > 3e4) ){\n\t\t\t\t\t\t\t\t\t\t\t_makeFlashImage({\n\t\t\t\t\t\t\t\t\t\t\t\t  width:\t(m.deg % 180) ? m.dh : m.dw\n\t\t\t\t\t\t\t\t\t\t\t\t, height:\t(m.deg % 180) ? m.dw : m.dh\n\t\t\t\t\t\t\t\t\t\t\t\t, scale:\tm.scaleMode\n\t\t\t\t\t\t\t\t\t\t\t}, base64, doneFn);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\tif( m.filter ){\n\t\t\t\t\t\t\t\t\t\t\t\tdoneFn = function (err, img){\n\t\t\t\t\t\t\t\t\t\t\t\t\tif( err ){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfn(err);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tapi.Image.applyFilter(img, m.filter, function (){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfn(err, this.canvas);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tapi.newImage('data:'+ file.type +';base64,'+ base64, doneFn);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\ttoData: function (fn){\n\t\t\t\t\t\t\tvar\n\t\t\t\t\t\t\t\t  file = this.file\n\t\t\t\t\t\t\t\t, info = file.info\n\t\t\t\t\t\t\t\t, matrix = this.getMatrix(info)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\tapi.log('FlashAPI.Image.toData');\n\n\t\t\t\t\t\t\tif( _isHtmlFile(file) ){\n\t\t\t\t\t\t\t\tthis.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tif( matrix.deg == 'auto' ){\n\t\t\t\t\t\t\t\t\tmatrix.deg = api.Image.exifOrientation[info && info.exif && info.exif.Orientation] || 0;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfn.call(this, !file.info, {\n\t\t\t\t\t\t\t\t\t  id:\t\tfile.id\n\t\t\t\t\t\t\t\t\t, flashId:\tfile.flashId\n\t\t\t\t\t\t\t\t\t, name:\t\tfile.name\n\t\t\t\t\t\t\t\t\t, type:\t\tfile.type\n\t\t\t\t\t\t\t\t\t, matrix:\tmatrix\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\tapi.Image && _inherit(api.Image, {\n\t\t\t\t\t\tfromDataURL: function (dataURL, size, callback){\n\t\t\t\t\t\t\tif( !api.support.dataURI || dataURL.length > 3e4 ){\n\t\t\t\t\t\t\t\t_makeFlashImage(\n\t\t\t\t\t\t\t\t\t  api.extend({ scale: 'exactFit' }, size)\n\t\t\t\t\t\t\t\t\t, dataURL.replace(/^data:[^,]+,/, '')\n\t\t\t\t\t\t\t\t\t, function (err, el){ callback(el); }\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthis.parent(dataURL, size, callback);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// FileAPI.Form\n\t\t\t\t\t_inherit(api.Form.prototype, {\n\t\t\t\t\t\ttoData: function (fn){\n\t\t\t\t\t\t\tvar items = this.items, i = items.length;\n\n\t\t\t\t\t\t\tfor( ; i--; ){\n\t\t\t\t\t\t\t\tif( items[i].file && _isHtmlFile(items[i].blob) ){\n\t\t\t\t\t\t\t\t\treturn this.parent.apply(this, arguments);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapi.log('FlashAPI.Form.toData');\n\t\t\t\t\t\t\tfn(items);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// FileAPI.XHR\n\t\t\t\t\t_inherit(api.XHR.prototype, {\n\t\t\t\t\t\t_send: function (options, formData){\n\t\t\t\t\t\t\tif(\n\t\t\t\t\t\t\t\t   formData.nodeName\n\t\t\t\t\t\t\t\t|| formData.append && api.support.html5\n\t\t\t\t\t\t\t\t|| api.isArray(formData) && (typeof formData[0] === 'string')\n\t\t\t\t\t\t\t){\n\t\t\t\t\t\t\t\t// HTML5, Multipart or IFrame\n\t\t\t\t\t\t\t\treturn\tthis.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\tvar\n\t\t\t\t\t\t\t\t  data = {}\n\t\t\t\t\t\t\t\t, files = {}\n\t\t\t\t\t\t\t\t, _this = this\n\t\t\t\t\t\t\t\t, flashId\n\t\t\t\t\t\t\t\t, fileId\n\t\t\t\t\t\t\t;\n\n\t\t\t\t\t\t\t_each(formData, function (item){\n\t\t\t\t\t\t\t\tif( item.file ){\n\t\t\t\t\t\t\t\t\tfiles[item.name] = item = _getFileDescr(item.blob);\n\t\t\t\t\t\t\t\t\tfileId  = item.id;\n\t\t\t\t\t\t\t\t\tflashId = item.flashId;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tdata[item.name] = item.blob;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif( !fileId ){\n\t\t\t\t\t\t\t\tflashId = _attr;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif( !flashId ){\n\t\t\t\t\t\t\t\tapi.log('[err] FlashAPI._send: flashId -- undefined');\n\t\t\t\t\t\t\t\treturn this.parent.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tapi.log('FlashAPI.XHR._send: '+ flashId +' -> '+ fileId);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t_this.xhr = {\n\t\t\t\t\t\t\t\theaders: {},\n\t\t\t\t\t\t\t\tabort: function (){ flash.cmd(flashId, 'abort', { id: fileId }); },\n\t\t\t\t\t\t\t\tgetResponseHeader: function (name){ return this.headers[name]; },\n\t\t\t\t\t\t\t\tgetAllResponseHeaders: function (){ return this.headers; }\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tvar queue = api.queue(function (){\n\t\t\t\t\t\t\t\tflash.cmd(flashId, 'upload', {\n\t\t\t\t\t\t\t\t\t  url: _getUrl(options.url.replace(/([a-z]+)=(\\?)&?/i, ''))\n\t\t\t\t\t\t\t\t\t, data: data\n\t\t\t\t\t\t\t\t\t, files: fileId ? files : null\n\t\t\t\t\t\t\t\t\t, headers: options.headers || {}\n\t\t\t\t\t\t\t\t\t, callback: _wrap(function upload(evt){\n\t\t\t\t\t\t\t\t\t\tvar type = evt.type, result = evt.result;\n\n\t\t\t\t\t\t\t\t\t\tapi.log('FlashAPI.upload.'+type);\n\n\t\t\t\t\t\t\t\t\t\tif( type == 'progress' ){\n\t\t\t\t\t\t\t\t\t\t\tevt.loaded = Math.min(evt.loaded, evt.total); // @todo fixme\n\t\t\t\t\t\t\t\t\t\t\tevt.lengthComputable = true;\n\t\t\t\t\t\t\t\t\t\t\toptions.progress(evt);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if( type == 'complete' ){\n\t\t\t\t\t\t\t\t\t\t\t_unwrap(upload);\n\n\t\t\t\t\t\t\t\t\t\t\tif( typeof result == 'string' ){\n\t\t\t\t\t\t\t\t\t\t\t\t_this.responseText\t= result.replace(/%22/g, \"\\\"\").replace(/%5c/g, \"\\\\\").replace(/%26/g, \"&\").replace(/%25/g, \"%\");\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t_this.end(evt.status || 200);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse if( type == 'abort' || type == 'error' ){\n\t\t\t\t\t\t\t\t\t\t\t_this.end(evt.status || 0, evt.message);\n\t\t\t\t\t\t\t\t\t\t\t_unwrap(upload);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\n\n\t\t\t\t\t\t\t// #2174: FileReference.load() call while FileReference.upload() or vice versa\n\t\t\t\t\t\t\t_each(files, function (file){\n\t\t\t\t\t\t\t\tqueue.inc();\n\t\t\t\t\t\t\t\tapi.getInfo(file, queue.next);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tqueue.check();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t;\n\n\n\t\tfunction _makeFlashHTML(opts){\n\t\t\treturn ('<object id=\"#id#\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"'+(opts.width || '100%')+'\" height=\"'+(opts.height || '100%')+'\">'\n\t\t\t\t+ '<param name=\"movie\" value=\"#src#\" />'\n\t\t\t\t+ '<param name=\"flashvars\" value=\"#flashvars#\" />'\n\t\t\t\t+ '<param name=\"swliveconnect\" value=\"true\" />'\n\t\t\t\t+ '<param name=\"allowscriptaccess\" value=\"always\" />'\n\t\t\t\t+ '<param name=\"allownetworking\" value=\"all\" />'\n\t\t\t\t+ '<param name=\"menu\" value=\"false\" />'\n\t\t\t\t+ '<param name=\"wmode\" value=\"#wmode#\" />'\n\t\t\t\t+ '<embed flashvars=\"#flashvars#\" swliveconnect=\"true\" allownetworking=\"all\" allowscriptaccess=\"always\" name=\"#id#\" src=\"#src#\" width=\"'+(opts.width || '100%')+'\" height=\"'+(opts.height || '100%')+'\" menu=\"false\" wmode=\"transparent\" type=\"application/x-shockwave-flash\"></embed>'\n\t\t\t\t+ '</object>').replace(/#(\\w+)#/ig, function (a, name){ return opts[name]; })\n\t\t\t;\n\t\t}\n\n\n\t\tfunction _css(el, css){\n\t\t\tif( el && el.style ){\n\t\t\t\tvar key, val;\n\t\t\t\tfor( key in css ){\n\t\t\t\t\tval = css[key];\n\t\t\t\t\tif( typeof val == 'number' ){\n\t\t\t\t\t\tval += 'px';\n\t\t\t\t\t}\n\t\t\t\t\ttry { el.style[key] = val; } catch (e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tfunction _inherit(obj, methods){\n\t\t\t_each(methods, function (fn, name){\n\t\t\t\tvar prev = obj[name];\n\t\t\t\tobj[name] = function (){\n\t\t\t\t\tthis.parent = prev;\n\t\t\t\t\treturn fn.apply(this, arguments);\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tfunction _isHtmlFile(file){\n\t\t\treturn\tfile && !file.flashId;\n\t\t}\n\n\t\tfunction _wrap(fn){\n\t\t\tvar id = fn.wid = api.uid();\n\t\t\tflash._fn[id] = fn;\n\t\t\treturn\t'FileAPI.Flash._fn.'+id;\n\t\t}\n\n\n\t\tfunction _unwrap(fn){\n\t\t\ttry {\n\t\t\t\tflash._fn[fn.wid] = null;\n\t\t\t\tdelete\tflash._fn[fn.wid];\n\t\t\t}\n\t\t\tcatch(e){}\n\t\t}\n\n\n\t\tfunction _getUrl(url, params){\n\t\t\tif( !_rhttp.test(url) ){\n\t\t\t\tif( /^\\.\\//.test(url) || '/' != url.charAt(0) ){\n\t\t\t\t\tvar path = location.pathname;\n\t\t\t\t\tpath = path.substr(0, path.lastIndexOf('/'));\n\t\t\t\t\turl = (path +'/'+ url).replace('/./', '/');\n\t\t\t\t}\n\n\t\t\t\tif( '//' != url.substr(0, 2) ){\n\t\t\t\t\turl = '//' + location.host + url;\n\t\t\t\t}\n\n\t\t\t\tif( !_rhttp.test(url) ){\n\t\t\t\t\turl = location.protocol + url;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( params ){\n\t\t\t\turl += (/\\?/.test(url) ? '&' : '?') + params;\n\t\t\t}\n\n\t\t\treturn\turl;\n\t\t}\n\n\n\t\tfunction _makeFlashImage(opts, base64, fn){\n\t\t\tvar\n\t\t\t\t  key\n\t\t\t\t, flashId = api.uid()\n\t\t\t\t, el = document.createElement('div')\n\t\t\t\t, attempts = 10\n\t\t\t;\n\n\t\t\tfor( key in opts ){\n\t\t\t\tel.setAttribute(key, opts[key]);\n\t\t\t\tel[key] = opts[key];\n\t\t\t}\n\n\t\t\t_css(el, opts);\n\n\t\t\topts.width\t= '100%';\n\t\t\topts.height\t= '100%';\n\n\t\t\tel.innerHTML = _makeFlashHTML(api.extend({\n\t\t\t\t  id: flashId\n\t\t\t\t, src: _getUrl(api.flashImageUrl, 'r='+ api.uid())\n\t\t\t\t, wmode: 'opaque'\n\t\t\t\t, flashvars: 'scale='+ opts.scale +'&callback='+_wrap(function _(){\n\t\t\t\t\t_unwrap(_);\n\t\t\t\t\tif( --attempts > 0 ){\n\t\t\t\t\t\t_setImage();\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t})\n\t\t\t}, opts));\n\n\t\t\tfunction _setImage(){\n\t\t\t\ttry {\n\t\t\t\t\t// Get flash-object by id\n\t\t\t\t\tvar img = flash.get(flashId);\n\t\t\t\t\timg.setImage(base64);\n\t\t\t\t} catch (e){\n\t\t\t\t\tapi.log('[err] FlashAPI.Preview.setImage -- can not set \"base64\":', e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfn(false, el);\n\t\t\tel = null;\n\t\t}\n\n\n\t\tfunction _getFileDescr(file){\n\t\t\treturn\t{\n\t\t\t\t  id: file.id\n\t\t\t\t, name: file.name\n\t\t\t\t, matrix: file.matrix\n\t\t\t\t, flashId: file.flashId\n\t\t\t};\n\t\t}\n\n\n\t\tfunction _getDimensions(el){\n\t\t\tvar\n\t\t\t\t  box = el.getBoundingClientRect()\n\t\t\t\t, body = document.body\n\t\t\t\t, docEl = (el && el.ownerDocument).documentElement\n\t\t\t;\n\n\t\t\treturn {\n\t\t\t\t  top:\t\tbox.top + (window.pageYOffset || docEl.scrollTop)  - (docEl.clientTop || body.clientTop || 0)\n\t\t\t\t, left:\t\tbox.left + (window.pageXOffset || docEl.scrollLeft) - (docEl.clientLeft || body.clientLeft || 0)\n\t\t\t\t, width:\tbox.right - box.left\n\t\t\t\t, height:\tbox.bottom - box.top\n\t\t\t};\n\t\t}\n\n\t\t// @export\n\t\tapi.Flash = flash;\n\n\n\t\t// Check dataURI support\n\t\tapi.newImage('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==', function (err, img){\n\t\t\tapi.support.dataURI = !(img.width != 1 || img.height != 1);\n\t\t\tflash.init();\n\t\t});\n\t})();\n})(window, window.jQuery, FileAPI);\n\n/**\n * FileAPI fallback to Flash\n *\n * @flash-developer  \"Vladimir Demidov\" <v.demidov@corp.mail.ru>\n */\n\n/*global window, FileAPI */\n(function (window, jQuery, api) {\n    \"use strict\";\n\n    var _each = api.each,\n        _cameraQueue = [];\n\n    if (api.support.flash && (api.media && (!api.support.media || !api.html5 || api.insecureChrome))) {\n        (function () {\n            function _wrap(fn) {\n                var id = fn.wid = api.uid();\n                api.Flash._fn[id] = fn;\n                return 'FileAPI.Flash._fn.' + id;\n            }\n\n\n            function _unwrap(fn) {\n                try {\n                    api.Flash._fn[fn.wid] = null;\n                    delete api.Flash._fn[fn.wid];\n                } catch (e) {\n                }\n            }\n\n            var flash = api.Flash;\n            api.extend(api.Flash, {\n\n                patchCamera: function () {\n                    api.Camera.fallback = function (el, options, callback) {\n                        var camId = api.uid();\n                        api.log('FlashAPI.Camera.publish: ' + camId);\n                        flash.publish(el, camId, api.extend(options, {\n                            camera: true,\n                            onEvent: _wrap(function _(evt) {\n                                if (evt.type === 'camera') {\n                                    _unwrap(_);\n\n                                    if (evt.error) {\n                                        api.log('FlashAPI.Camera.publish.error: ' + evt.error);\n                                        callback(evt.error);\n                                    } else {\n                                        api.log('FlashAPI.Camera.publish.success: ' + camId);\n                                        callback(null);\n                                    }\n                                }\n                            })\n                        }));\n                    };\n                    // Run\n                    _each(_cameraQueue, function (args) {\n                        api.Camera.fallback.apply(api.Camera, args);\n                    });\n                    _cameraQueue = [];\n\n\n                    // FileAPI.Camera:proto\n                    api.extend(api.Camera.prototype, {\n                        _id: function () {\n                            return this.video.id;\n                        },\n\n                        start: function (callback) {\n                            var _this = this;\n                            flash.cmd(this._id(), 'camera.on', {\n                                callback: _wrap(function _(evt) {\n                                    _unwrap(_);\n\n                                    if (evt.error) {\n                                        api.log('FlashAPI.camera.on.error: ' + evt.error);\n                                        callback(evt.error, _this);\n                                    } else {\n                                        api.log('FlashAPI.camera.on.success: ' + _this._id());\n                                        _this._active = true;\n                                        callback(null, _this);\n                                    }\n                                })\n                            });\n                        },\n\n                        stop: function () {\n                            this._active = false;\n                            flash.cmd(this._id(), 'camera.off');\n                        },\n\n                        shot: function () {\n                            api.log('FlashAPI.Camera.shot:', this._id());\n\n                            var shot = api.Flash.cmd(this._id(), 'shot', {});\n                            shot.type = 'image/png';\n                            shot.flashId = this._id();\n                            shot.isShot = true;\n\n                            return new api.Camera.Shot(shot);\n                        }\n                    });\n                }\n            });\n\n            api.Camera.fallback = function () {\n                _cameraQueue.push(arguments);\n            };\n\n        }());\n    }\n}(window, window.jQuery, FileAPI));\nif( typeof define === \"function\" && define.amd ){ define(\"FileAPI\", [], function (){ return FileAPI; }); }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/fileapi/dist/FileAPI.js\n// module id = ../node_modules/fileapi/dist/FileAPI.js\n// module chunks = 0","import {Component, ElementRef, HostBinding, HostListener} from '@angular/core';\n\n@Component({\n  selector: 'fs-file-drag-base'\n})\nexport class FsFileDragBaseComponent {\n\n  constructor(public el: ElementRef) {\n  }\n\n  @HostBinding('class.dragover') public fileOverTarget = false;\n\n  @HostListener('dragenter', ['$event'])\n  public onDragOverElement(event) {\n    if (this.el.nativeElement.contains(event.target)) {\n      this.fileOverTarget = true;\n    }\n  }\n\n  @HostListener('window:drop', ['$event'])\n  public onDrop(event) {\n    if (this.fileOverTarget) {\n      event.preventDefault();\n      event.stopPropagation();\n      this.fileOverTarget = false;\n    }\n  }\n\n  @HostListener('window:dragover', ['$event'])\n  public onDragOver(event) {\n    if (this.fileOverTarget) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      if (!this.el.nativeElement.contains(event.target)) {\n        this.fileOverTarget = false;\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-drag-base/fs-file-drag-base.ts","export * from './fs-file-drag-base';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-drag-base/index.ts","module.exports = \"<div class=\\\"label\\\"\\n     [ngStyle]=\\\"{'width.px': previewWidth || 150}\\\">\\n  <ng-content select=\\\"[fs-file-label]\\\"></ng-content>\\n</div>\\n<fs-file-preview class=\\\"preview\\\"\\n                 *ngIf=\\\"file; else preview\\\"\\n                 (remove)=\\\"removeFile($event)\\\"\\n                 [file]=\\\"file\\\"\\n                 [previewWidth]=\\\"previewWidth\\\"\\n                 [previewHeight]=\\\"previewHeight\\\">\\n  <ng-template fs-file-preview-action placement=\\\"bottom-left\\\" action=\\\"remove\\\" tooltip=\\\"Remove\\\">\\n    <mat-icon>close</mat-icon>\\n  </ng-template>\\n  <ng-template fs-file-preview-action placement=\\\"bottom-right\\\" tooltip=\\\"Reupload\\\" (click)=\\\"fileInput.click()\\\">\\n    <mat-icon>cloud_upload</mat-icon>\\n  </ng-template>\\n</fs-file-preview>\\n\\n<ng-template #preview>\\n  <div class=\\\"select\\\" (click)=\\\"fileInput.click()\\\">\\n    <mat-icon>cloud_upload</mat-icon>\\n    <div class=\\\"instruction\\\">{{instruction}}</div>\\n    <button mat-raised-button color=\\\"primary\\\">Upload</button>\\n  </div>\\n</ng-template>\\n\\n<input type=\\\"file\\\"\\n       [hidden]=\\\"true\\\"\\n       [disabled]=\\\"fsFile.disabled\\\"\\n       [multiple]=\\\"fsFile.multiple\\\"\\n       [attr.accept]=\\\"fsFile.accept\\\"\\n       #fileInput\\n>\\n\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file-picker/fs-file-picker.component.html\n// module id = ./components/fs-file-picker/fs-file-picker.component.html\n// module chunks = 0","\n        var result = require(\"!!../../../node_modules/css-loader/index.js??ref--3-1!../../../node_modules/postcss-loader/lib/index.js??ref--3-2!../../../node_modules/resolve-url-loader/index.js??ref--3-3!../../../node_modules/sass-loader/lib/loader.js??ref--3-4!./fs-file-picker.component.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    \n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file-picker/fs-file-picker.component.scss\n// module id = ./components/fs-file-picker/fs-file-picker.component.scss\n// module chunks = 0","import {\n  ElementRef,\n  EventEmitter,\n  Component,\n  Input,\n  OnInit,\n  Output,\n  ViewChild\n} from '@angular/core';\nimport {FsFileService} from '../../services';\nimport {FsFileDragBaseComponent} from '../fs-file-drag-base';\n\n@Component({\n  selector: 'fs-file-picker',\n  template: require('./fs-file-picker.component.html'),\n  styles: [ require('./fs-file-picker.component.scss') ],\n  providers: [FsFileService]\n})\nexport class FsFilePickerComponent extends FsFileDragBaseComponent implements OnInit {\n\n  @Input()\n  set multiple(value) {\n    this.fsFile.multiple = value;\n  }\n\n  @Input()\n  set accept(value) {\n    this.fsFile.accept = value;\n  }\n\n  @Input()\n  set minSize(value) {\n    this.fsFile.minSize = value;\n  };\n\n  @Input()\n  set maxSize(value) {\n    this.fsFile.maxSize = value\n  }\n\n  @Input()\n  set imageMaxWidth(value) {\n    this.fsFile.imageMaxWidth = value\n  }\n\n  @Input()\n  set imageMaxHeight(value) {\n    this.fsFile.imageMaxHeight = value\n  }\n\n  @Input()\n  set imageQuality(value) {\n    this.fsFile.imageQuality = value;\n  }\n\n  @Input()\n  set imageFormat(value) {\n    this.fsFile.imageFormat = value;\n  }\n\n  @Input()\n  set disabled(value) {\n    this.fsFile.disabled = value;\n  }\n\n  @Input() public previewWidth = 150;\n  @Input() public previewHeight = 150;\n\n  @Output('select') public select = new EventEmitter<any>();\n\n  @ViewChild('fileInput') public fileInput: any;\n\n  public instruction = 'Drag & Drop your file or use the button below';\n  public file;\n\n  constructor(public fsFile: FsFileService, public el: ElementRef) {\n    super(el);\n  }\n\n  public ngOnInit() {\n    this.fsFile.initForElement(this.fileInput);\n    this.fsFile.initDragNDropForElement(this.el);\n\n    this.fsFile.select.subscribe((file) => {\n      this.file = file;\n      this.select.emit(file);\n    });\n  }\n\n  public removeFile(file) {\n    this.file = void 0;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-picker/fs-file-picker.component.ts","export * from './fs-file-picker.component';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-picker/index.ts","import {\n  Component,\n  ContentChildren,\n  QueryList,\n  TemplateRef,\n} from '@angular/core';\nimport { FsFilePreviewActionDirective } from '../../directives';\n\n@Component({\n  selector: 'fs-file-previews-base'\n})\nexport class FsFilePreviewsBaseComponent {\n\n  public actions = [];\n  public actionsTemplate = [];\n\n  @ContentChildren(FsFilePreviewActionDirective)\n  private set actionsParams(val: QueryList<FsFilePreviewActionDirective>) {\n    const actions = val.toArray().map((action, index) => {\n      const newAction = Object.assign({}, action);\n      newAction.index = index;\n      if (newAction.forTypes && !Array.isArray(newAction.forTypes)) {\n        newAction.forTypes = newAction.forTypes.split(',').map((type) => type.trim());\n      }\n\n      return newAction;\n    });\n\n    this.actions.push(...actions);\n  }\n\n  @ContentChildren(FsFilePreviewActionDirective, {read: TemplateRef})\n  private set actionsTemplateRefs(val: QueryList<FsFilePreviewActionDirective>) {\n    this.actionsTemplate.push(...val.toArray());\n  }\n\n  constructor() {\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-preview-base/fs-file-preview-base.ts","export * from './fs-file-preview-base';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-preview-base/index.ts","module.exports = \"<div [style.width.px]=\\\"previewWidth\\\" [style.height.px]=\\\"previewHeight\\\" class=\\\"preview-container\\\">\\n\\n  <!-- Progress container -->\\n  <ng-container *ngIf=\\\"file.progress; else elsePreview\\\">\\n    <mat-spinner class=\\\"spinner\\\" [diameter]=\\\"previewWidth/2\\\"></mat-spinner>\\n  </ng-container>\\n\\n  <!-- Image container -->\\n  <ng-template #elsePreview>\\n    <ng-container *ngIf=\\\"file.typeImage; else nonImage\\\">\\n      <img [src]=\\\"preview\\\">\\n    </ng-container>\\n\\n    <!-- Non image container -->\\n    <ng-template #nonImage>\\n        <div class=\\\"file-ext\\\">{{file.extension}}</div>\\n        <div class=\\\"file-name\\\" [matTooltip]=\\\"file.name\\\">{{file.name}}</div>\\n    </ng-template>\\n  </ng-template>\\n</div>\\n\\n<!-- Actions -->\\n<div class=\\\"actions\\\">\\n  <button class=\\\"action\\\" mat-mini-fab color=\\\"primary\\\"\\n          *ngFor=\\\"let action of filteredActions\\\"\\n          [ngClass]=\\\"getActionClasses(action)\\\"\\n          [matTooltip]=\\\"action.tooltip\\\"\\n          (click)=\\\"callAction(action)\\\">\\n    <ng-template [ngTemplateOutlet]=\\\"actionsTemplate[action.index]\\\"></ng-template>\\n  </button>\\n</div>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file-preview/fs-file-preview.component.html\n// module id = ./components/fs-file-preview/fs-file-preview.component.html\n// module chunks = 0","\n        var result = require(\"!!../../../node_modules/css-loader/index.js??ref--3-1!../../../node_modules/postcss-loader/lib/index.js??ref--3-2!../../../node_modules/resolve-url-loader/index.js??ref--3-3!../../../node_modules/sass-loader/lib/loader.js??ref--3-4!./fs-file-preview.component.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    \n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file-preview/fs-file-preview.component.scss\n// module id = ./components/fs-file-preview/fs-file-preview.component.scss\n// module chunks = 0","import {\n  EventEmitter,\n  Component,\n  Input,\n  Output,\n  AfterViewInit,\n} from '@angular/core';\nimport * as FileAPI from 'fileapi';\nimport { FsFile } from '../../models/fs-file';\nimport { FsFilePreviewsBaseComponent } from '../fs-file-preview-base';\n\n@Component({\n  selector: 'fs-file-preview',\n  template: require('./fs-file-preview.component.html'),\n  styles: [ require('./fs-file-preview.component.scss') ]\n})\nexport class FsFilePreviewComponent extends FsFilePreviewsBaseComponent implements AfterViewInit {\n\n  public file: FsFile;\n  public preview: string;\n\n  @Input() set _actions(value) {\n    this.actions.push(...value);\n  }\n  @Input() set _actionsTemplate(value) {\n    this.actionsTemplate.push(...value);\n  }\n  @Input() public previewWidth = 150;\n  @Input() public previewHeight = 150;\n  @Input('file') set _file(file: FsFile) {\n    this.file = file;\n    this.generateFilePreview(file);\n  }\n\n  @Output() public remove = new EventEmitter();\n\n  public filteredActions = [];\n\n  constructor() {\n    super();\n  }\n\n  public ngAfterViewInit() {\n    this.cleanActions();\n  }\n\n  public getActionClasses(action) {\n    if (action.placement) {\n      return [action.placement];\n    } else {\n      return [];\n    }\n  }\n\n  public callAction(action) {\n    switch (action.action) {\n      case 'remove': {\n        this.remove.emit(this.file);\n      } break;\n      default: {\n        if (action.click) {\n          action.click.emit(this.file);\n        }\n      }\n    }\n  }\n\n  /**\n   * Generate preview images for file\n   * @param {FsFile} file\n   */\n  private generateFilePreview(file: FsFile) {\n    if (!this.file.typeImage) {\n      return;\n    }\n    file.progress = true;\n    FileAPI.Image(file.file)\n      .preview(this.previewWidth, this.previewHeight)\n      .get((err, img) => {\n        FileAPI.readAsDataURL(img, (event) => {\n          switch (event.type) {\n            case 'load': {\n              this.preview = event.result;\n              file.progress = false;\n            } break;\n\n            case 'error': {\n              alert(`Image preview error for file ${file.name}`);\n              file.progress = false;\n            } break;\n          }\n        });\n      });\n  }\n\n  private cleanActions() {\n    for (const action in this.actions) {\n      if (this.actions.hasOwnProperty(action) && this.actions[action].forTypes) {\n        // save original type\n        const [originalFileType, originalContentType] = this.file.type.split('/');\n        const types = this.actions[action].forTypes;\n\n        // Looking for allowed type\n        for (let i = 0; i < types.length; i++) {\n          const [fileType, contentType] = types[i].split('/');\n          const allowed = fileType === originalFileType && (contentType === originalContentType || contentType === '*');\n\n          if (allowed) {\n            this.filteredActions.push(this.actions[action]);\n            break;\n          }\n        }\n      } else {\n        this.filteredActions.push(this.actions[action]);\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-preview/fs-file-preview.component.ts","export * from './fs-file-preview.component';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-preview/index.ts","module.exports = \"<fs-file-preview\\n  *ngFor=\\\"let file of files\\\"\\n  [file]=\\\"file\\\"\\n  [_actions]=\\\"actions\\\"\\n  [_actionsTemplate]=\\\"actionsTemplate\\\"\\n  [previewWidth]=\\\"previewWidth\\\"\\n  [previewHeight]=\\\"previewHeight\\\"\\n  (remove)=\\\"removeFile($event)\\\"\\n  class=\\\"preview\\\">\\n</fs-file-preview>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file-previews/fs-file-previews.component.html\n// module id = ./components/fs-file-previews/fs-file-previews.component.html\n// module chunks = 0","\n        var result = require(\"!!../../../node_modules/css-loader/index.js??ref--3-1!../../../node_modules/postcss-loader/lib/index.js??ref--3-2!../../../node_modules/resolve-url-loader/index.js??ref--3-3!../../../node_modules/sass-loader/lib/loader.js??ref--3-4!./fs-file-previews.component.scss\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    \n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file-previews/fs-file-previews.component.scss\n// module id = ./components/fs-file-previews/fs-file-previews.component.scss\n// module chunks = 0","import {\n  Component,\n  ContentChildren,\n  HostBinding,\n  Input,\n  OnInit,\n  QueryList,\n  TemplateRef,\n  ViewEncapsulation,\n} from '@angular/core';\nimport { FsFilePreviewActionDirective } from '../../directives';\nimport {FsFilePreviewsBaseComponent} from \"../fs-file-preview-base\";\n\n@Component({\n  selector: 'fs-file-previews',\n  template: require('./fs-file-previews.component.html'),\n  styles: [ require('./fs-file-previews.component.scss') ],\n  encapsulation: ViewEncapsulation.None\n})\nexport class FsFilePreviewsComponent extends FsFilePreviewsBaseComponent implements OnInit {\n\n  @Input() public files;\n  @Input() public previewWidth = 150;\n  @Input() public previewHeight = 150;\n\n  @HostBinding('class.queue') queue = true;\n\n  constructor() {\n    super();\n  }\n\n  public ngOnInit() {\n  }\n\n  public removeFile(file) {\n    const index = this.files.indexOf(file);\n    if (index > -1) {\n      this.files.splice(index, 1);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-previews/fs-file-previews.component.ts","export * from './fs-file-previews.component';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file-previews/index.ts","module.exports = \"<label (click)=\\\"fileInput.click()\\\">\\n  <ng-content></ng-content>\\n</label>\\n<input type=\\\"file\\\"\\n       [hidden]=\\\"true\\\"\\n       [disabled]=\\\"fsFile.disabled\\\"\\n       [multiple]=\\\"fsFile.multiple\\\"\\n       [attr.accept]=\\\"fsFile.accept\\\"\\n       #fileInput\\n>\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/fs-file/fs-file.component.html\n// module id = ./components/fs-file/fs-file.component.html\n// module chunks = 0","import {\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  ViewChild\n} from '@angular/core';\nimport { FsFileService } from '../../services';\nimport { FsFileDragBaseComponent } from '../fs-file-drag-base';\n\n@Component({\n  selector: 'fs-file',\n  providers: [FsFileService],\n  template: require('./fs-file.component.html')\n})\nexport class FsFileComponent extends FsFileDragBaseComponent implements OnInit {\n\n  @Input()\n  set multiple(value) {\n    this.fsFile.multiple = value;\n  }\n\n  @Input()\n  set accept(value) {\n    this.fsFile.accept = value;\n  }\n\n  @Input()\n  set minSize(value) {\n    this.fsFile.minSize = value;\n  };\n\n  @Input()\n  set maxSize(value) {\n    this.fsFile.maxSize = value\n  }\n\n  @Input()\n  set imageMaxWidth(value) {\n    this.fsFile.imageMaxWidth = value\n  }\n\n  @Input()\n  set imageMaxHeight(value) {\n    this.fsFile.imageMaxHeight = value\n  }\n\n  @Input()\n  set imageQuality(value) {\n    this.fsFile.imageQuality = value;\n  }\n\n  @Input()\n  set imageFormat(value) {\n    this.fsFile.imageFormat = value;\n  }\n\n  @Input()\n  set disabled(value) {\n    this.fsFile.disabled = value;\n  }\n\n  @Input() imageFixOrientation = true;\n\n  @Output('select') public select: EventEmitter<any>;\n\n  @ViewChild('fileInput') public fileInput: any;\n\n  constructor(public fsFile: FsFileService, public el: ElementRef) {\n    super(el);\n    this.select = this.fsFile.select;\n  }\n\n  public ngOnInit() {\n    this.fsFile.initForElement(this.fileInput);\n    this.fsFile.initDragNDropForElement(this.el);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file/fs-file.component.ts","export * from './fs-file.component';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/fs-file/index.ts","export * from './fs-file';\nexport * from './fs-file-previews';\nexport * from './fs-file-preview';\nexport * from './fs-file-picker';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./components/index.ts","import {Directive, EventEmitter, Input, Output} from '@angular/core';\n\n@Directive({\n  selector: '[fs-file-preview-action]'\n})\nexport class FsFilePreviewActionDirective {\n  @Input() public placement: string;\n  @Input() public tooltip: string;\n  @Input() public action: string;\n  @Input('for-types') public forTypes: string | string[];\n\n  public index = null;\n\n  @Output() public click = new EventEmitter();\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./directives/fs-file-preview-action.directive.ts","export * from './fs-file-preview-action.directive';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./directives/index.ts","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {MatButtonModule, MatIconModule, MatProgressSpinnerModule, MatTooltipModule} from '@angular/material';\n\nimport { FsCommonModule } from '@firestitch/common';\n\nimport {\n  FsFileComponent,\n  FsFilePreviewsComponent,\n  FsFilePreviewComponent,\n  FsFilePickerComponent\n} from './components';\nimport { FsFilePreviewActionDirective } from './directives';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FsCommonModule,\n    MatIconModule,\n    MatTooltipModule,\n    MatProgressSpinnerModule,\n    MatButtonModule,\n  ],\n  exports: [\n    FsFileComponent,\n    FsFilePreviewsComponent,\n    FsFilePreviewComponent,\n    FsFilePreviewActionDirective,\n    FsFilePickerComponent\n  ],\n  entryComponents: [\n  ],\n  declarations: [\n    FsFileComponent,\n    FsFilePreviewsComponent,\n    FsFilePreviewComponent,\n    FsFilePreviewActionDirective,\n    FsFilePickerComponent\n  ],\n  providers: [\n  ],\n})\nexport class FsFileModule {\n  static forRoot(): ModuleWithProviders {\n    return {\n      ngModule: FsFileModule,\n      providers: []\n    };\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./fs-component.module.ts","export * from './fs-component.module';\nexport * from './components';\nexport * from './services';\nexport * from './directives';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./index.ts","export class FsFile {\n\n  public progress = false;\n  public imageWidth: number;\n  public imageHeight: number;\n  public file: File;\n  public extension: string;\n  public name: string;\n  public type: string;\n  public size: number;\n\n  constructor(file: File) {\n    this.file = file;\n    this.name = file.name;\n    this.size = file.size;\n    this.type = file.type;\n    const parts = this.file.name.split('.');\n    if (parts.length > 1) {\n      this.extension = parts[parts.length - 1];\n    }\n  }\n\n  get typeImage(): any {\n    return !!this.type\n      .match(/^image\\/(gif|jpeg|pjpeg|png|svg\\+xml|tiff|vnd\\.microsoft\\.icon|vnd\\.wap\\.wbmp|webp)/i);\n  }\n\n  public parseInfo(info) {\n    this.imageWidth = info.width;\n    this.imageHeight = info.height;\n  }\n\n  public toObject() {\n    return {\n      name: this.name,\n      type: this.type,\n      size: this.size,\n      progress: this.progress,\n      extension: this.extension,\n      typeImage: this.typeImage,\n      imageWidth: this.imageWidth,\n      imageHeight: this.imageHeight\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./models/fs-file.ts","import {ElementRef, EventEmitter, Injectable} from '@angular/core';\nimport * as FileAPI from 'fileapi';\nimport { Subject } from 'rxjs/Subject';\nimport {FsFile} from '../models/fs-file';\n\nconst PROCESSORS = {\n  0: 'imageInfo',\n  1: 'imageType',\n  2: 'imageQuality',\n};\n\nfunction* processors(list) {\n  for (const item of list) {\n    yield item;\n  }\n}\n\n@Injectable()\nexport class FsFileService {\n\n  public containerEl: any;\n  public el: any;\n  public select  = new EventEmitter();\n\n  private _options = {\n    disabled: false,\n    multiple: false,\n    preview: false,\n    accept: [],\n    minSize: void 0,\n    maxSize: void 0,\n    imageMaxWidth: void 0,\n    imageMaxHeight: void 0,\n    imageQuality: void 0,\n    imageFormat: void 0,\n  };\n\n  constructor() {\n  }\n\n  set multiple(value) {\n    if (typeof(value) === 'boolean') {\n      this._options.multiple = value;\n    } else {\n      this._options.multiple = value === 'true';\n    }\n  }\n\n  get multiple() {\n    return this._options.multiple;\n  }\n\n  set accept(value) {\n    this._options.accept = this._options.accept.concat(value.split(','));\n  }\n\n  get accept() {\n    return this._options.accept.join(', ') || '*';\n  }\n\n  set minSize(value) {\n    if (value !== void 0) {\n      this._options.minSize = value;\n    }\n  }\n\n  set maxSize(value) {\n    if (value !== void 0) {\n      this._options.maxSize = value;\n    }\n  }\n\n  set imageMaxWidth(value) {\n    if (value !== void 0) {\n      this._options.imageMaxWidth = +value;\n    }\n  }\n\n  set imageMaxHeight(value) {\n    if (value !== void 0) {\n      this._options.imageMaxHeight = +value;\n    }\n  }\n\n  set imageQuality(value) {\n    const val = parseFloat(value);\n    if (!isNaN(val)) {\n      this._options.imageQuality = val;\n    }\n  }\n\n  set imageFormat(value) {\n    if (['jpg', 'png'].indexOf(value) > -1) {\n      this._options.imageFormat = value\n    }\n  }\n\n  set disabled(value) {\n    this._options.disabled = value;\n  }\n\n  get disabled() {\n    return this._options.disabled;\n  }\n\n  /**\n   * Initialize service for target element\n   * @param el\n   */\n  public initForElement(el: ElementRef) {\n    this.el = el.nativeElement;\n    this.onChanges();\n  }\n\n  public initDragNDropForElement(el: ElementRef) {\n    this.containerEl = el.nativeElement;\n    this.onDrop();\n  }\n\n  /**\n   * Fire when input was changed\n   */\n  public onChanges() {\n    FileAPI.event.on(this.el, 'change', (event) => {\n      const files = FileAPI.getFiles(event);\n\n      // Clear input value\n      this.el.value = null;\n\n      this.filterFiles(files).then((result: any) => {\n        if (result.files && result.files.length > 0) {\n          this.processFiles(result.files);\n        }\n      })\n    });\n  }\n\n  /**\n   * Fire when on root element was dropped file\n   */\n  public onDrop() {\n    FileAPI.event.on(this.containerEl, 'drop', (event) => {\n      const files = FileAPI.getFiles(event);\n\n      // Clear input value\n      this.el.value = null;\n\n      this.filterFiles(files).then((result: any) => {\n        if (result.files && result.files.length > 0) {\n          this.processFiles(result.files);\n        }\n      })\n    });\n  }\n\n  /**\n   * Process uploaded files\n   * @param files\n   */\n  private processFiles(files) {\n\n    files = files.map((f) => {\n      return new FsFile(f);\n    });\n\n    this.select.next(this._options.multiple ? files : files[0]);\n\n    const processedFiles = [];\n\n    files.forEach((file: FsFile) => {\n\n      if (file.typeImage) {\n        const processorsIter = processors(Object.keys(PROCESSORS));\n        const resFilePromise = new Promise((resolve, reject) => {\n          this.applyProcessors(file, processorsIter, resolve, reject);\n        });\n        resFilePromise.then(\n          () => {},\n          (error) => {\n            this.alertImageProcessingError(error.file);\n          }\n        );\n      }\n    });\n  }\n\n  /**\n   * Filter files\n   * @param rawFiles\n   * @returns {Subject<any>}\n   */\n  private filterFiles(rawFiles) {\n    return new Promise((resolve) => {\n      FileAPI.filterFiles(rawFiles, (file, info) => {\n        let sizeRule = void 0;\n        if (file.typeImage) {\n          sizeRule = this.checkResolutionRule(info);\n        } else {\n          sizeRule = true;\n        }\n\n        const fileSize = this.checkSize(file);\n\n        return (sizeRule !== void 0 ? sizeRule : true) && fileSize;\n      }, (files, rejected) => {\n        resolve({ files: files, rejected: rejected });\n      });\n    });\n  }\n\n  /**\n   * Check file resolution restrictions\n   * @param info\n   * @returns {boolean}\n   */\n  private checkResolutionRule(info) {\n    if (this._options.imageMaxWidth && this._options.imageMaxHeight) {\n      return info.width <= this._options.imageMaxWidth && info.height <= this._options.imageMaxHeight;\n    } else if (this._options.imageMaxWidth) {\n      return info.width <= this._options.imageMaxWidth;\n    } else if (this._options.imageMaxHeight) {\n      return info.height <= this._options.imageMaxHeight;\n    } else {\n      return true;\n    }\n  }\n\n  /**\n   * Check filesize restrictions\n   * @param file\n   * @returns {boolean}\n   */\n  private checkSize(file) {\n    return (this._options.minSize !== void 0 ? file.size as number >= (this._options.minSize * FileAPI.KB) : true)\n      && (this._options.maxSize !== void 0 ? file.size <= (this._options.maxSize * FileAPI.KB) : true);\n  }\n\n  /**\n   * Change image format\n   * @param originFile\n   * @returns {Promise<any>}\n   */\n  private changeImageFormat(originFile: FsFile) {\n    return new Promise((resolve, reject) => {\n      const image = FileAPI.Image(originFile.file);\n      const fileType = (this._options.imageFormat) ? 'image/' + this._options.imageFormat : originFile.type;\n      image.get((err, img) => {\n        if (!err) {\n          img.toDataUrl((blob) => {\n            originFile.file = new File([blob], originFile.name, { type: fileType });\n            resolve(originFile);\n          }, fileType, this._options.imageQuality || 1)\n        } else {\n          reject(err);\n        }\n      });\n    });\n  }\n\n  /**\n   * Retrun information about image (width/height)\n   * @param {FsFile} originFile\n   * @returns {Promise<any>}\n   */\n  private getImageInfo(originFile: FsFile) {\n    return new Promise((resolve, reject) => {\n      FileAPI.getInfo(originFile.file, (err, info) => {\n        if (!err) {\n          resolve(info);\n        } else {\n          reject(err);\n        }\n      });\n    });\n  }\n\n  /**\n   * Change image quality\n   * @param originFile\n   * @returns {Promise<any>}\n   */\n  private changeQuality(originFile: FsFile) {\n    return new Promise((resolve, reject) => {\n      const image = FileAPI.Image(originFile.file);\n      image.get((err, img) => {\n        if (!err) {\n          img.toBlob((blob) => {\n            originFile.file = new File([blob], originFile.name, { type: originFile.type });\n            resolve(originFile);\n          }, originFile.type, this._options.imageQuality || 1)\n        } else {\n          reject(err);\n        }\n      });\n    });\n  }\n\n  /**\n   * Process image file by sequence of available processors\n   * @param file\n   * @param processorsIter\n   * @param resolve\n   * @param reject\n   */\n  private applyProcessors(file: FsFile, processorsIter, resolve, reject) {\n    const nextValue = processorsIter.next();\n    if (!nextValue.done) {\n      file.progress = true;\n      switch (+nextValue.value) {\n        case 0: {\n          this.getImageInfo(file).then((result) => {\n            file.parseInfo(result);\n            this.applyProcessors(file, processorsIter, resolve, reject);\n          }).catch((error) => {\n            reject({ error, file });\n          })\n        } break;\n\n        case 1: {\n          if (this._options.imageQuality !== void 0) {\n            this.changeQuality(file).then((resultFile: FsFile) => {\n              this.applyProcessors(resultFile, processorsIter, resolve, reject);\n            }).catch((error) => {\n              reject({ error, file });\n            })\n          } else {\n            this.applyProcessors(file, processorsIter, resolve, reject);\n          }\n        } break;\n\n        case 2: {\n          if (this._options.imageFormat !== void 0) {\n            this.changeImageFormat(file).then((resultFile: FsFile) => {\n              this.applyProcessors(resultFile, processorsIter, resolve, reject);\n            }).catch((error) => {\n              reject({ error, file });\n            })\n          } else {\n            this.applyProcessors(file, processorsIter, resolve, reject);\n          }\n        } break;\n      }\n    } else {\n      file.progress = this._options.preview;\n      resolve(file);\n    }\n  }\n\n  private alertImageProcessingError(file) {\n    alert(`File ${file.name} can't be processed as image. File was rejected`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./services/fs-file.service.ts","export * from './fs-file.service';\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/angular2-template-loader!./services/index.ts","module.exports = __WEBPACK_EXTERNAL_MODULE__angular_common__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/common\"\n// module id = @angular/common\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE__angular_core__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/core\"\n// module id = @angular/core\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE__angular_material__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@angular/material\"\n// module id = @angular/material\n// module chunks = 0"],"sourceRoot":""}