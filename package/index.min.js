!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@angular/core"),require("fileapi"),require("@firestitch/common"),require("@angular/common"),require("@angular/material")):"function"==typeof define&&define.amd?define("@firestitch/file",["@angular/core","fileapi","@firestitch/common","@angular/common","@angular/material"],t):"object"==typeof exports?exports["@firestitch/file"]=t(require("@angular/core"),require("fileapi"),require("@firestitch/common"),require("@angular/common"),require("@angular/material")):e["@firestitch/file"]=t(e["@angular/core"],e.fileapi,e["@firestitch/common"],e["@angular/common"],e["@angular/material"])}("undefined"!=typeof self?self:this,function(e,t,n,i,o){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./index.ts")}({'../node_modules/css-loader/index.js?{"sourceMap":true}!../node_modules/postcss-loader/lib/index.js?{"sourceMap":true}!../node_modules/resolve-url-loader/index.js?{"sourceMap":true,"absolute":false,"fail":false,"silent":false,"keepQuery":false,"attempts":0,"debug":false,"root":null,"includeRoot":false}!../node_modules/sass-loader/lib/loader.js?{"sourceMap":true}!./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!0),t.push([e.i,".file-info-container .file-ext {\n  font-weight: bold;\n  text-align: center;\n  text-transform: uppercase;\n  padding-top: 10px;\n}\n\n.file-info-container .file-name {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: 5px;\n}\n\n.actions {\n  position: absolute;\n  display: none;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: rgba(119, 119, 119, .5);\n}\n\n.actions .action {\n  position: absolute;\n  cursor: pointer;\n}\n\n.actions .action.top-left {\n  top: 5px;\n  left: 5px;\n}\n\n.actions .action.top-right {\n  top: 5px;\n  right: 5px;\n}\n\n.actions .action.bottom-left {\n  bottom: 5px;\n  left: 5px;\n}\n\n.actions .action.bottom-right {\n  bottom: 5px;\n  right: 5px;\n}\n\n.actions .action.mat-mini-fab {\n  width: 30px;\n  height: 30px;\n  line-height: 15px !important;\n}\n\n.actions .action.mat-mini-fab .mat-button-wrapper {\n  padding: 4px 0;\n  line-height: 15px !important;\n}\n\n:host ::ng-deep .mat-button-wrapper {\n  padding: 0;\n  line-height: 15px !important;\n}\n\n:host ::ng-deep .spinner {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-left: -25%;\n  margin-top: -25%;\n}\n\n","",{version:3,sources:["/Users/Basters/dev/firestitch/fs-file/src/components/fs-file-queue/fs-file-queue-preview/src/components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.scss","/Users/Basters/dev/firestitch/fs-file/fs-file-queue-preview.component.scss"],names:[],mappings:"AAAA;EAGI,kBAAA;EACA,mBAAA;EACA,0BAAA;EACA,kBAAA;CCDH;;ADIC;EACE,oBAAA;EACA,iBAAA;EACA,wBAAA;EACA,aAAA;CCDH;;ADKD;EACE,mBAAA;EACA,cAAA;EACA,YAAA;EACA,aAAA;EACA,OAAA;EACA,QAAA;EACA,oCAAA;CCFD;;ADIC;EACE,mBAAA;EACA,gBAAA;CCDH;;ADDC;EAKI,SAAA;EACA,UAAA;CCAL;;ADfD;EAmBM,SAAA;EACA,WAAA;CCAL;;ADpBD;EAwBM,YAAA;EACA,UAAA;CCAL;;ADhBC;EAoBI,YAAA;EACA,WAAA;CCAL;;ADrBC;EAyBI,YAAA;EACA,aAAA;EACA,6BAAA;CCAL;;ADpCD;EAuCQ,eAAA;EACA,6BAAA;CCCP;;ADKD;EAEI,WAAA;EACA,6BAAA;CCHH;;ADMC;EACE,mBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,iBAAA;CCHH",file:"fs-file-queue-preview.component.scss",sourcesContent:[".file-info-container {\n\n  .file-ext {\n    font-weight: bold;\n    text-align: center;\n    text-transform: uppercase;\n    padding-top: 10px;\n  }\n\n  .file-name {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    padding: 5px;\n  }\n}\n\n.actions {\n  position: absolute;\n  display: none;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: rgba(119, 119, 119, 0.5);\n\n  .action {\n    position: absolute;\n    cursor: pointer;\n\n    &.top-left {\n      top: 5px;\n      left: 5px;\n    }\n\n    &.top-right {\n      top: 5px;\n      right: 5px;\n    }\n\n    &.bottom-left {\n      bottom: 5px;\n      left: 5px;\n    }\n\n    &.bottom-right {\n      bottom: 5px;\n      right: 5px;\n    }\n\n    &.mat-mini-fab {\n      width: 30px;\n      height: 30px;\n      line-height: 15px !important;\n\n      .mat-button-wrapper {\n        padding: 4px 0;\n        line-height: 15px !important;\n      }\n    }\n  }\n}\n\n:host ::ng-deep {\n  .mat-button-wrapper {\n    padding: 0;\n    line-height: 15px !important;\n  }\n\n  .spinner {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    margin-left: -25%;\n    margin-top: -25%;\n  }\n}\n",".file-info-container .file-ext {\n  font-weight: bold;\n  text-align: center;\n  text-transform: uppercase;\n  padding-top: 10px;\n}\n\n.file-info-container .file-name {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: 5px;\n}\n\n.actions {\n  position: absolute;\n  display: none;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: rgba(119, 119, 119, 0.5);\n}\n\n.actions .action {\n  position: absolute;\n  cursor: pointer;\n}\n\n.actions .action.top-left {\n  top: 5px;\n  left: 5px;\n}\n\n.actions .action.top-right {\n  top: 5px;\n  right: 5px;\n}\n\n.actions .action.bottom-left {\n  bottom: 5px;\n  left: 5px;\n}\n\n.actions .action.bottom-right {\n  bottom: 5px;\n  right: 5px;\n}\n\n.actions .action.mat-mini-fab {\n  width: 30px;\n  height: 30px;\n  line-height: 15px !important;\n}\n\n.actions .action.mat-mini-fab .mat-button-wrapper {\n  padding: 4px 0;\n  line-height: 15px !important;\n}\n\n:host ::ng-deep .mat-button-wrapper {\n  padding: 0;\n  line-height: 15px !important;\n}\n\n:host ::ng-deep .spinner {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-left: -25%;\n  margin-top: -25%;\n}\n\n"],sourceRoot:""}])},'../node_modules/css-loader/index.js?{"sourceMap":true}!../node_modules/postcss-loader/lib/index.js?{"sourceMap":true}!../node_modules/resolve-url-loader/index.js?{"sourceMap":true}!../node_modules/sass-loader/lib/loader.js?{"sourceMap":true}!./components/fs-file-queue/fs-file-queue.component.scss':function(e,t,n){t=e.exports=n("../node_modules/css-loader/lib/css-base.js")(!0),t.push([e.i,".queue {\n  position: relative;\n  display: block;\n}\n\n.preview {\n  display: inline-block;\n  position: relative;\n  margin-right: 10px;\n  border: 2px #a0a0a0 solid;\n  vertical-align: top;\n}\n\n.preview:hover .actions {\n  display: block;\n}\n\n.preview img {\n  display: block;\n}\n\n","",{version:3,sources:["/Users/Basters/dev/firestitch/fs-file/src/components/fs-file-queue/src/components/fs-file-queue/fs-file-queue.component.scss","/Users/Basters/dev/firestitch/fs-file/fs-file-queue.component.scss"],names:[],mappings:"AAAA;EACE,mBAAA;EACA,eAAA;CCCD;;ADED;EACE,sBAAA;EACA,mBAAA;EACA,mBAAA;EACA,0BAAA;EACA,oBAAA;CCCD;;ADND;EASM,eAAA;CCCL;;ADGC;EACE,eAAA;CCAH",file:"fs-file-queue.component.scss",sourcesContent:[".queue {\n  position: relative;\n  display: block;\n}\n\n.preview {\n  display: inline-block;\n  position: relative;\n  margin-right: 10px;\n  border: 2px #a0a0a0 solid;\n  vertical-align: top;\n\n  &:hover {\n    .actions {\n      display: block;\n    }\n  }\n\n  img {\n    display: block;\n  }\n}\n",".queue {\n  position: relative;\n  display: block;\n}\n\n.preview {\n  display: inline-block;\n  position: relative;\n  margin-right: 10px;\n  border: 2px #a0a0a0 solid;\n  vertical-align: top;\n}\n\n.preview:hover .actions {\n  display: block;\n}\n\n.preview img {\n  display: block;\n}\n\n"],sourceRoot:""}])},"../node_modules/css-loader/lib/css-base.js":function(e,t){function n(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var s=i(o);return[n].concat(o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"})).concat([s]).join("\n")}return[n].join("\n")}function i(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=n(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var s=this[o][0];"number"==typeof s&&(i[s]=!0)}for(o=0;o<e.length;o++){var r=e[o];"number"==typeof r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),t.push(r))}},t}},"./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.html":function(e,t){e.exports='\x3c!-- Image container --\x3e\n<ng-container *ngIf="file.typeImage; else nonImage">\n  <img [src]="file.preview" *ngIf="file.preview && !file.progress && file.typeImage; else dummyImage">\n  <ng-template #dummyImage>\n    <img src="/assets/image.png" [width]="previewWidth" [height]="previewHeight">\n    <mat-spinner class="spinner" *ngIf="file.progress" [diameter]="previewWidth/2"></mat-spinner>\n  </ng-template>\n</ng-container>\n\n\x3c!-- Non image container --\x3e\n<ng-template #nonImage>\n  <div class="file-info-container" [style.width.px]="previewWidth" [style.height.px]="previewHeight">\n    <div class="file-ext">{{file.extension}}</div>\n    <div class="file-name" [matTooltip]="file.name">{{file.name}}</div>\n  </div>\n  <mat-spinner class="spinner" *ngIf="file.progress" [diameter]="previewWidth/2"></mat-spinner>\n</ng-template>\n\n\x3c!-- Actions --\x3e\n<div class="actions">\n  <button class="action" mat-mini-fab color="primary"\n          *ngFor="let action of filteredActions"\n          [ngClass]="getActionClasses(action)"\n          [matTooltip]="action.tooltip"\n          (click)="callAction(action)">\n    <ng-template [ngTemplateOutlet]="actionsTemplate[action.index]"></ng-template>\n  </button>\n</div>\n'},"./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.scss":function(e,t,n){var i=n('../node_modules/css-loader/index.js?{"sourceMap":true}!../node_modules/postcss-loader/lib/index.js?{"sourceMap":true}!../node_modules/resolve-url-loader/index.js?{"sourceMap":true,"absolute":false,"fail":false,"silent":false,"keepQuery":false,"attempts":0,"debug":false,"root":null,"includeRoot":false}!../node_modules/sass-loader/lib/loader.js?{"sourceMap":true}!./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.scss');e.exports="string"==typeof i?i:i.toString()},"./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.ts":function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var p=e.length-1;p>=0;p--)(o=e[p])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("@angular/core"),r=n("./models/fs-file.ts"),p=function(){function e(){this.deleted=new s.EventEmitter,this.filteredActions=[]}return e.prototype.ngOnInit=function(){this.cleanActions(),this.previewWidth||(this.previewWidth=this.file.previewWidth||100),this.previewHeight||(this.previewHeight=this.file.previewHeight||100)},e.prototype.getActionClasses=function(e){return e.placement?[e.placement]:[]},e.prototype.callAction=function(e){switch(e.action){case"remove":this.deleted.emit(this.file);break;default:e.click&&e.click.emit(this.file)}},e.prototype.cleanActions=function(){for(var e in this.actions)if(this.actions.hasOwnProperty(e)&&this.actions[e].forTypes)for(var t=this.file.type.split("/"),n=t[0],i=t[1],o=this.actions[e].forTypes,s=0;s<o.length;s++){var r=o[s].split("/"),p=r[0],a=r[1],l=p===n&&(a===i||"*"===a);if(l){this.filteredActions.push(this.actions[e]);break}}else this.filteredActions.push(this.actions[e])},i([s.Input(),o("design:type",Object)],e.prototype,"actions",void 0),i([s.Input(),o("design:type",Object)],e.prototype,"actionsTemplate",void 0),i([s.Input(),o("design:type",r.FsFile)],e.prototype,"file",void 0),i([s.Input(),o("design:type",Object)],e.prototype,"previewWidth",void 0),i([s.Input(),o("design:type",Object)],e.prototype,"previewHeight",void 0),i([s.Output(),o("design:type",Object)],e.prototype,"deleted",void 0),e=i([s.Component({selector:"fs-file-queue-preview",template:n("./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.html"),styles:[n("./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.scss")]}),o("design:paramtypes",[])],e)}();t.FsFileQueuePreviewComponent=p},"./components/fs-file-queue/fs-file-queue-preview/index.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./components/fs-file-queue/fs-file-queue-preview/fs-file-queue-preview.component.ts"))},"./components/fs-file-queue/fs-file-queue.component.html":function(e,t){e.exports='<fs-file-queue-preview\n  *ngFor="let file of files"\n  [file]="file"\n  [actions]="actions"\n  [actionsTemplate]="actionsTemplate"\n  [previewWidth]="previewWidth"\n  [previewHeight]="previewHeight"\n  (deleted)="removeFile($event)"\n  class="preview">\n</fs-file-queue-preview>\n'},"./components/fs-file-queue/fs-file-queue.component.scss":function(e,t,n){var i=n('../node_modules/css-loader/index.js?{"sourceMap":true}!../node_modules/postcss-loader/lib/index.js?{"sourceMap":true}!../node_modules/resolve-url-loader/index.js?{"sourceMap":true}!../node_modules/sass-loader/lib/loader.js?{"sourceMap":true}!./components/fs-file-queue/fs-file-queue.component.scss');e.exports="string"==typeof i?i:i.toString()},"./components/fs-file-queue/fs-file-queue.component.ts":function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var p=e.length-1;p>=0;p--)(o=e[p])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("@angular/core"),r=n("./directives/index.ts"),p=function(){function e(){this.queue=!0}return Object.defineProperty(e.prototype,"actionsParams",{set:function(e){this.actions=e.toArray().map(function(e,t){var n=Object.assign({},e);return n.index=t,n.forTypes&&!Array.isArray(n.forTypes)&&(n.forTypes=n.forTypes.split(",").map(function(e){return e.trim()})),n})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionsTemplateRefs",{set:function(e){this.actionsTemplate=e.toArray()},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.removeFile=function(e){var t=this.files.indexOf(e);t>-1&&this.files.splice(t,1)},i([s.Input(),o("design:type",Object)],e.prototype,"files",void 0),i([s.Input(),o("design:type",Object)],e.prototype,"previewWidth",void 0),i([s.Input(),o("design:type",Object)],e.prototype,"previewHeight",void 0),i([s.HostBinding("class.queue"),o("design:type",Object)],e.prototype,"queue",void 0),i([s.ContentChildren(r.FsFileQueueActionDirective),o("design:type",s.QueryList),o("design:paramtypes",[s.QueryList])],e.prototype,"actionsParams",null),i([s.ContentChildren(r.FsFileQueueActionDirective,{read:s.TemplateRef}),o("design:type",s.QueryList),o("design:paramtypes",[s.QueryList])],e.prototype,"actionsTemplateRefs",null),e=i([s.Component({selector:"fs-file-queue",template:n("./components/fs-file-queue/fs-file-queue.component.html"),styles:[n("./components/fs-file-queue/fs-file-queue.component.scss")],encapsulation:s.ViewEncapsulation.None}),o("design:paramtypes",[])],e)}();t.FsFileQueueComponent=p},"./components/fs-file-queue/index.ts":function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n("./components/fs-file-queue/fs-file-queue.component.ts")),i(n("./components/fs-file-queue/fs-file-queue-preview/index.ts"))},"./components/fs-file/fs-file.component.html":function(e,t){e.exports='<label [for]="uniqId" (click)="fileInput.click()">\n  <ng-content></ng-content>\n</label>\n<input type="file" style="display: none"\n       [id]="uniqId"\n       [disabled]="fsFile.disabled"\n       [multiple]="fsFile.multiple"\n       [attr.accept]="fsFile.accept"\n       #fileInput\n>\n'},"./components/fs-file/fs-file.component.ts":function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var p=e.length-1;p>=0;p--)(o=e[p])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("@angular/core"),r=n("./services/index.ts"),p=n("@firestitch/common"),a=function(){function e(e,t){this.fsFile=e,this.fsUtil=t,this.imageFixOrientation=!0,this.uniqId=this.fsUtil.guid(),this.selected=this.fsFile.selected}return Object.defineProperty(e.prototype,"multiple",{set:function(e){this.fsFile.multiple=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accept",{set:function(e){this.fsFile.accept=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minSize",{set:function(e){this.fsFile.minSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxSize",{set:function(e){this.fsFile.maxSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageMaxWidth",{set:function(e){this.fsFile.imageMaxWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageMaxHeight",{set:function(e){this.fsFile.imageMaxHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageQuality",{set:function(e){this.fsFile.imageQuality=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageFormat",{set:function(e){this.fsFile.imageFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{set:function(e){this.fsFile.disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preview",{set:function(e){this.fsFile.preview=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.fsFile.initForElement(this.fileInput)},i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"multiple",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"accept",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"minSize",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"maxSize",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"imageMaxWidth",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"imageMaxHeight",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"imageQuality",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"imageFormat",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"disabled",null),i([s.Input(),o("design:type",Object),o("design:paramtypes",[Object])],e.prototype,"preview",null),i([s.Input(),o("design:type",Object)],e.prototype,"imageFixOrientation",void 0),i([s.Output("selected"),o("design:type",s.EventEmitter)],e.prototype,"selected",void 0),i([s.ViewChild("fileInput"),o("design:type",Object)],e.prototype,"fileInput",void 0),e=i([s.Component({selector:"fs-file",providers:[r.FsFileService],template:n("./components/fs-file/fs-file.component.html")}),o("design:paramtypes",[r.FsFileService,p.FsUtil])],e)}();t.FsFileComponent=a},"./components/fs-file/index.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./components/fs-file/fs-file.component.ts"))},"./components/index.ts":function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n("./components/fs-file/index.ts")),i(n("./components/fs-file-queue/index.ts"))},"./directives/fs-file-queue-action.directive.ts":function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var p=e.length-1;p>=0;p--)(o=e[p])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=n("@angular/core"),r=function(){function e(){this.index=null,this.click=new s.EventEmitter}return i([s.Input(),o("design:type",String)],e.prototype,"placement",void 0),i([s.Input(),o("design:type",String)],e.prototype,"tooltip",void 0),i([s.Input(),o("design:type",String)],e.prototype,"action",void 0),i([s.Input("for-types"),o("design:type",Object)],e.prototype,"forTypes",void 0),i([s.Output(),o("design:type",Object)],e.prototype,"click",void 0),e=i([s.Directive({selector:"[fs-file-queue-action]"})],e)}();t.FsFileQueueActionDirective=r},"./directives/index.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./directives/fs-file-queue-action.directive.ts"))},"./fs-component.module.ts":function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var p=e.length-1;p>=0;p--)(o=e[p])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(t,"__esModule",{value:!0});var o=n("@angular/core"),s=n("@angular/common"),r=n("@angular/material"),p=n("@firestitch/common"),a=n("./components/index.ts"),l=n("./directives/index.ts"),c=function(){function e(){}return t=e,e.forRoot=function(){return{ngModule:t,providers:[]}},e=t=i([o.NgModule({imports:[s.CommonModule,p.FsCommonModule,r.MatIconModule,r.MatTooltipModule,r.MatProgressSpinnerModule,r.MatButtonModule],exports:[a.FsFileComponent,a.FsFileQueueComponent,l.FsFileQueueActionDirective],entryComponents:[],declarations:[a.FsFileComponent,a.FsFileQueueComponent,a.FsFileQueuePreviewComponent,l.FsFileQueueActionDirective],providers:[]})],e);var t}();t.FsFileModule=c},"./index.ts":function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n("./fs-component.module.ts")),i(n("./components/index.ts")),i(n("./services/index.ts")),i(n("./directives/index.ts"))},"./models/fs-file.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.progress=!1,this.file=e}return Object.defineProperty(e.prototype,"file",{get:function(){return this._file},set:function(e){this._file=e;var t=this._file.name.split(".");t.length>1&&(this._ext=t[t.length-1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.file.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.file.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.file.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preview",{get:function(){return this._preview},set:function(e){this._preview=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extension",{get:function(){return this._ext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeImage",{get:function(){return this.type.match(/^image/i)},enumerable:!0,configurable:!0}),e.prototype.parseInfo=function(e){this.imageWidth=e.width,this.imageHeight=e.height},e.prototype.toJson=function(){return{file:this.file,name:this.name,type:this.type,size:this.size,progress:this.progress,preview:this.preview,extrension:this.extension,typeImage:this.typeImage,imageWidth:this.imageWidth,imageHeight:this.imageHeight,previewWidth:this.previewWidth,previewHeight:this.previewHeight}},e}();t.FsFile=i},"./services/fs-component.service.ts":function(e,t,n){"use strict";function i(e){var t,n,i;return r(this,function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(i=n[t],[4,i]):[3,4];case 2:o.sent(),o.label=3;case 3:return t++,[3,1];case 4:return[2]}})}var o=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var p=e.length-1;p>=0;p--)(o=e[p])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,s&&(r=s[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(s,n[1])).done)return r;switch(s=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,s=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){a.label=n[1];break}if(6===n[0]&&a.label<r[1]){a.label=r[1],r=n;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(n);break}r[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],s=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,s,r,p,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return p={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(p[Symbol.iterator]=function(){return this}),p};Object.defineProperty(t,"__esModule",{value:!0});var p=n("@angular/core"),a=n("fileapi"),l=n("./models/fs-file.ts"),c={0:"imageInfo",1:"imageType",2:"imageQuality"},u=function(){function e(){this.selected=new p.EventEmitter,this._options={disabled:!1,multiple:!1,preview:!1,previewSizes:{width:null,height:null},accept:[],minSize:void 0,maxSize:void 0,imageMaxWidth:void 0,imageMaxHeight:void 0,imageQuality:void 0,imageFormat:void 0}}return Object.defineProperty(e.prototype,"multiple",{get:function(){return this._options.multiple},set:function(e){this._options.multiple="boolean"==typeof e?e:"true"===e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accept",{get:function(){return this._options.accept.join(", ")||"*"},set:function(e){this._options.accept=this._options.accept.concat(e.split(","))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minSize",{set:function(e){void 0!==e&&(this._options.minSize=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxSize",{set:function(e){void 0!==e&&(this._options.maxSize=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageMaxWidth",{set:function(e){void 0!==e&&(this._options.imageMaxWidth=+e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageMaxHeight",{set:function(e){void 0!==e&&(this._options.imageMaxHeight=+e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageQuality",{set:function(e){var t=parseFloat(e);isNaN(t)||(this._options.imageQuality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageFormat",{set:function(e){["jpg","png"].indexOf(e)>-1&&(this._options.imageFormat=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._options.disabled},set:function(e){this._options.disabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preview",{set:function(e){if("boolean"==typeof e||"true"===e)this._options.preview=e,this._options.previewSizes.width=100,this._options.previewSizes.height=100;else if("string"==typeof e||e instanceof String){var t=e.split("x").map(function(e){return+e}),n=t[0],i=t[1];this._options.preview=!0,n&&i?(this._options.previewSizes.width=n,this._options.previewSizes.height=i):n&&!i?(this._options.previewSizes.width=n,this._options.previewSizes.height=n):i&&!n?(this._options.previewSizes.width=i,this._options.previewSizes.height=i):this._options.preview=!1}},enumerable:!0,configurable:!0}),e.prototype.initForElement=function(e){this.el=e.nativeElement,this.onChanges()},e.prototype.onChanges=function(){var e=this;a.event.on(this.el,"change",function(t){var n=a.getFiles(t);e.el.value=null,e.filterFiles(n).then(function(t){t.files&&t.files.length>0&&e.processFiles(t.files)})})},e.prototype.processFiles=function(e){var t=this;e=e.map(function(e){var n=new l.FsFile(e);return n.previewWidth=t._options.previewSizes.width,n.previewHeight=t._options.previewSizes.height,n}),this.selected.next(e);var n=[];e.forEach(function(e){if(/^image/.test(e.type)){var o=i(Object.keys(c)),s=new Promise(function(n,i){t.applyProcessors(e,o,n,i)});n.push(s)}else n.push(e)}),Promise.all(n).then(function(e){t._options.preview&&e.filter(function(e){return e.typeImage}).forEach(function(e){t.generateFilePreview(e)})})},e.prototype.generateFilePreview=function(e){a.Image(e.file).preview(this._options.previewSizes.width,this._options.previewSizes.height).get(function(t,n){a.readAsDataURL(n,function(t){"load"===t.type&&(e.preview=t.result,e.progress=!1)})})},e.prototype.filterFiles=function(e){var t=this;return new Promise(function(n){a.filterFiles(e,function(e,n){var i=void 0;i=!/^image/.test(e.type)||t.checkResolutionRule(n);var o=t.checkSize(e);return(void 0===i||i)&&o},function(e,t){n({files:e,rejected:t})})})},e.prototype.checkResolutionRule=function(e){return this._options.imageMaxWidth&&this._options.imageMaxHeight?e.width<=this._options.imageMaxWidth&&e.height<=this._options.imageMaxHeight:this._options.imageMaxWidth?e.width<=this._options.imageMaxWidth:!this._options.imageMaxHeight||e.height<=this._options.imageMaxHeight},e.prototype.checkSize=function(e){return(void 0===this._options.minSize||e.size>=this._options.minSize*a.KB)&&(void 0===this._options.maxSize||e.size<=this._options.maxSize*a.KB)},e.prototype.changeImageFormat=function(e){var t=this;return new Promise(function(n,i){var o=a.Image(e.file),s=t._options.imageFormat?"image/"+t._options.imageFormat:e.type;o.get(function(o,r){o?i(o):r.toDataUrl(function(t){e.file=new File([t],e.name,{type:s}),n(e)},s,t._options.imageQuality||1)})})},e.prototype.getImageInfo=function(e){return new Promise(function(t,n){a.getInfo(e.file,function(e,i){e?n(e):t(i)})})},
e.prototype.changeQuality=function(e){var t=this;return new Promise(function(n,i){a.Image(e.file).get(function(o,s){o?i(o):s.toBlob(function(t){e.file=new File([t],e.name,{type:e.type}),n(e)},e.type,t._options.imageQuality||1)})})},e.prototype.applyProcessors=function(e,t,n,i){var o=this,s=t.next();if(s.done)e.progress=this._options.preview,n(e);else switch(e.progress=!0,+s.value){case 0:this.getImageInfo(e).then(function(s){e.parseInfo(s),o.applyProcessors(e,t,n,i)}).catch(function(e){i(e)});break;case 1:void 0!==this._options.imageQuality?this.changeQuality(e).then(function(e){o.applyProcessors(e,t,n,i)}).catch(function(e){i(e)}):this.applyProcessors(e,t,n,i);break;case 2:void 0!==this._options.imageFormat?this.changeImageFormat(e).then(function(e){o.applyProcessors(e,t,n,i)}).catch(function(e){i(e)}):this.applyProcessors(e,t,n,i)}},e=o([p.Injectable(),s("design:paramtypes",[])],e)}();t.FsFileService=u},"./services/index.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./services/fs-component.service.ts"))},"@angular/common":function(e,t){e.exports=i},"@angular/core":function(t,n){t.exports=e},"@angular/material":function(e,t){e.exports=o},"@firestitch/common":function(e,t){e.exports=n},fileapi:function(e,n){e.exports=t}})});